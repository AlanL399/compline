!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("exsurge",[],factory):"object"==typeof exports?exports.exsurge=factory():root.exsurge=factory()}(this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _Exsurge=__webpack_require__(1);Object.keys(_Exsurge).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Exsurge[key]}})});var _Exsurge2=__webpack_require__(2);Object.keys(_Exsurge2).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Exsurge2[key]}})});var _Exsurge3=__webpack_require__(3);Object.keys(_Exsurge3).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Exsurge3[key]}})});var _Exsurge4=__webpack_require__(4);Object.keys(_Exsurge4).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Exsurge4[key]}})});var _Exsurge5=__webpack_require__(6);Object.keys(_Exsurge5).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Exsurge5[key]}})});var _ExsurgeChant=__webpack_require__(9);Object.keys(_ExsurgeChant).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _ExsurgeChant[key]}})});var _ExsurgeChant2=__webpack_require__(8);Object.keys(_ExsurgeChant2).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _ExsurgeChant2[key]}})});var _ExsurgeChant3=__webpack_require__(11);Object.keys(_ExsurgeChant3).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _ExsurgeChant3[key]}})});var _Exsurge6=__webpack_require__(10);if(Object.keys(_Exsurge6).forEach(function(key){"default"!==key&&Object.defineProperty(exports,key,{enumerable:!0,get:function(){return _Exsurge6[key]}})}),"undefined"!=typeof document){var ChantVisualElementPrototype=Object.create(HTMLElement.prototype);ChantVisualElementPrototype.createdCallback=function(){var ctxt=new _Exsurge4.ChantContext;ctxt.lyricTextFont="'Crimson Text', serif",ctxt.lyricTextSize*=1.2,ctxt.dropCapTextFont=ctxt.lyricTextFont,ctxt.annotationTextFont=ctxt.lyricTextFont;var useDropCap=!0,useDropCapAttr=this.getAttribute("use-drop-cap");"false"===useDropCapAttr&&(useDropCap=!1);var score=_Exsurge6.Gabc.loadChantScore(ctxt,this.innerText,useDropCap),annotationAttr=this.getAttribute("annotation");annotationAttr&&(score.annotation=new _Exsurge4.Annotation(ctxt,annotationAttr));var _element=this,width=0,doLayout=function(){var newWidth=_element.parentElement.clientWidth;width!==newWidth&&(width=newWidth,score.performLayout(ctxt,function(){score.layoutChantLines(ctxt,width,function(){_element.innerHTML=score.createSvgFragment(ctxt)})}))};doLayout(),window.addEventListener?window.addEventListener("resize",doLayout,!1):window.attachEvent&&window.attachEvent("onresize",doLayout)},ChantVisualElementPrototype.attachedCallback=function(){},document.registerElement=document.registerElement||function(){};document.registerElement("chant-visual",{prototype:ChantVisualElementPrototype})}},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function DeviceIndependent(n){return n}function Centimeters(n){return Units.ToDeviceIndependent(n,Units.Centimeters)}function Millimeters(n){return Units.ToDeviceIndependent(n,Units.Millimeters)}function Inches(n){return Units.ToDeviceIndependent(n,Units.Inches)}function ToCentimeters(n){return Units.FromDeviceIndependent(n,Units.Centimeters)}function ToMillimeters(n){return Units.FromDeviceIndependent(n,Units.Millimeters)}function ToInches(n){return Units.FromDeviceIndependent(n,Units.Inches)}function generateRandomGuid(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();exports.DeviceIndependent=DeviceIndependent,exports.Centimeters=Centimeters,exports.Millimeters=Millimeters,exports.Inches=Inches,exports.ToCentimeters=ToCentimeters,exports.ToMillimeters=ToMillimeters,exports.ToInches=ToInches,exports.generateRandomGuid=generateRandomGuid;var Units=exports.Units={DeviceIndepenedent:0,Centimeters:1,Millimeters:2,Inches:3,DIU_PER_INCH:96,DIU_PER_CENTIMETER:96/2.54,ToDeviceIndependent:function(n,inputUnits){switch(inputUnits){case Centimeters:return n*DIU_PER_CENTIMETER;case Millimeters:return n*DIU_PER_CENTIMETER/10;case Inches:return n*DIU_PER_INCH;default:return n}},FromDeviceIndependent:function(n,outputUnits){switch(outputUnits){case Centimeters:return n/DIU_PER_CENTIMETER;case Millimeters:return n/DIU_PER_CENTIMETER*10;case Inches:return n/DIU_PER_INCH;default:return n}},StringToUnitsType:function(s){switch(s.ToLower()){case"in":case"inches":return Inches;case"cm":case"centimeters":return Centimeters;case"mm":case"millimeters":return Millimeters;case"di":case"device-independent":return DeviceIndepenedent;default:return DeviceIndepenedent}},UnitsTypeToString:function(units){switch(units){case Inches:return"in";case Centimeters:return"cm";case Millimeters:return"mm";case DeviceIndepenedent:return"device-independent";default:return"device-independent"}}},Point=exports.Point=function(){function Point(x,y){_classCallCheck(this,Point),this.x="undefined"!=typeof x?x:0,this.y="undefined"!=typeof y?y:0}return _createClass(Point,[{key:"clone",value:function(){return new Point(this.x,this.y)}},{key:"equals",value:function(point){return this.x===point.x&&this.y===point.y}}]),Point}(),Step=(exports.Rect=function(){function Rect(x,y,width,height){_classCallCheck(this,Rect),this.x="undefined"!=typeof x?x:1/0,this.y="undefined"!=typeof y?y:1/0,this.width="undefined"!=typeof width?width:-(1/0),this.height="undefined"!=typeof height?height:-(1/0)}return _createClass(Rect,[{key:"clone",value:function(){return new Rect(this.x,this.y,this.width,this.height)}},{key:"isEmpty",value:function(){return this.x===1/0&&this.y===1/0&&this.width===-(1/0)&&this.height===-(1/0)}},{key:"right",value:function(){return this.x+this.width}},{key:"bottom",value:function(){return this.y+this.height}},{key:"equals",value:function(rect){return this.x===rect.x&&this.y===rect.y&&this.width===rect.width&&this.height===rect.height}},{key:"contains",value:function(other){return other instanceof Point?other.x>=this.x&&other.x<=this.x+this.width&&other.y>=this.y&&other.y<=this.y+this.height:this.x<=other.x&&this.x+this.width>=other.x+other.width&&this.y<=other.y&&this.y+this.height>=other.y+other.height}},{key:"union",value:function(rect){var right=Math.max(this.x+this.width,rect.x+rect.width),bottom=Math.max(this.y+this.height,rect.y+rect.height);this.x=Math.min(this.x,rect.x),this.y=Math.min(this.y,rect.y),this.width=right-this.x,this.height=bottom-this.y}}]),Rect}(),exports.Margins=function(){function Margins(left,top,right,bottom){_classCallCheck(this,Margins),this.left="undefined"!=typeof left?left:0,this.top="undefined"!=typeof top?top:0,this.right="undefined"!=typeof right?right:0,this.bottom="undefined"!=typeof bottom?bottom:0}return _createClass(Margins,[{key:"clone",value:function(){return new Margins(this.left,this.top,this.right,this.bottom)}},{key:"equals",value:function(margins){return this.left===margins.left&&this.top===margins.top&&this.right===margins.right&&this.bottom===margins.bottom}}]),Margins}(),exports.Size=function(){function Size(width,height){_classCallCheck(this,Size),this.width="undefined"!=typeof width?width:0,this.height="undefined"!=typeof height?height:0}return _createClass(Size,[{key:"clone",value:function(){return new Size(this.width,this.height)}},{key:"equals",value:function(size){return this.width===size.width&&this.height===size.height}}]),Size}(),exports.Step={Do:0,Du:1,Re:2,Me:3,Mi:4,Fa:5,Fu:6,So:7,La:9,Te:10,Ti:11}),__StepToStaffPosition=[0,0,1,1,2,3,3,4,4,5,6,6],__StaffOffsetToStep=[Step.Do,Step.Re,Step.Mi,Step.Fa,Step.So,Step.La,Step.Ti];exports.Pitch=function(){function Pitch(step,octave){_classCallCheck(this,Pitch),this.step=step,this.octave=octave}return _createClass(Pitch,[{key:"toInt",value:function(){return 12*this.octave+this.step}},{key:"isHigherThan",value:function(pitch){return this.toInt()>pitch.toInt()}},{key:"isLowerThan",value:function(pitch){return this.toInt()<pitch.toInt()}},{key:"equals",value:function(pitch){return this.toInt()===pitch.toInt()}}],[{key:"stepToStaffOffset",value:function(step){return __StepToStaffPosition[step]}},{key:"staffOffsetToStep",value:function(offset){for(;offset<0;)offset=__StaffOffsetToStep.length+offset;return __StaffOffsetToStep[offset%__StaffOffsetToStep.length]}}]),Pitch}()},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Spanish=exports.Latin=exports.Language=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Exsurge=__webpack_require__(1),Language=(_interopRequireWildcard(_Exsurge),exports.Language=function(){function Language(name){_classCallCheck(this,Language),this.name="undefined"!=typeof name?name:"<unknown>"}return _createClass(Language,[{key:"syllabify",value:function(text){var parsedWords=[];if("undefined"==typeof text||""===text)return parsedWords;for(var words=text.split(/[\s]+/),i=0,end=words.length;i<end;i++)parsedWords.push(this.syllabifyWord(words[i]));return parsedWords}}]),Language}());exports.Latin=function(_Language){function Latin(){_classCallCheck(this,Latin);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Latin).call(this,"Latin"));_this.diphthongs=["ae","au","oe","aé","áu","oé"],_this.possibleDiphthongs=_this.diphthongs.concat(["ei","eu","ui","éi","éu","úi"]);var wordExceptions=new Object;return wordExceptions.huius=["hui","us"],wordExceptions.cuius=["cui","us"],wordExceptions.huic=["huic"],wordExceptions.cui=["cui"],wordExceptions.hui=["hui"],wordExceptions.euge=["eu","ge"],wordExceptions.seu=["seu"],_this.vowels=["a","e","i","o","u","á","é","í","ó","ú","æ","œ","ǽ","y"],_this.vowelsThatMightBeConsonants=["i","u"],_this.muteConsonantsAndF=["b","c","d","g","p","t","f"],_this.liquidConsonants=["l","r"],_this}return _inherits(Latin,_Language),_createClass(Latin,[{key:"isVowel",value:function(c){for(var i=0,end=this.vowels.length;i<end;i++)if(this.vowels[i]===c)return!0;return!1}},{key:"isVowelThatMightBeConsonant",value:function(c){for(var i=0,end=this.vowelsThatMightBeConsonants.length;i<end;i++)if(this.vowelsThatMightBeConsonants[i]===c)return!0;return!1}},{key:"isVowelActingAsConsonant",value:function(substring){return this.isVowelThatMightBeConsonant(substring[0])&&this.isVowel(substring[1])}},{key:"isMuteConsonantOrF",value:function(c){for(var i=0,end=this.muteConsonantsAndF.length;i<end;i++)if(this.muteConsonantsAndF[i]===c)return!0;return!1}},{key:"isLiquidConsonant",value:function(c){for(var i=0,end=this.liquidConsonants.length;i<end;i++)if(this.liquidConsonants[i]===c)return!0;return!1}},{key:"isDiphthong",value:function(s){for(var i=0,end=this.diphthongs.length;i<end;i++)if(this.diphthongs[i]===s)return!0;return!1}},{key:"isPossibleDiphthong",value:function(s){for(var i=0,end=this.possibleDiphthongs.length;i<end;i++)if(this.possibleDiphthongs[i]===s)return!0;return!1}},{key:"syllabifyWord",value:function(word){for(var c,lookahead,haveLookahead,syllables=[],haveCompleteSyllable=!1,previousWasVowel=!1,workingString=word.toLowerCase(),startSyllable=0,makeSyllable=function(length){haveCompleteSyllable&&(syllables.push(word.substr(startSyllable,length)),startSyllable+=length),haveCompleteSyllable=!1},i=0,wordLength=workingString.length;i<wordLength;i++){c=workingString[i],lookahead="*",haveLookahead=i+1<wordLength,haveLookahead&&(lookahead=workingString[i+1]);var cIsVowel=this.isVowel(c);"i"===c&&(0===i&&haveLookahead&&this.isVowel(lookahead)?cIsVowel=!1:previousWasVowel&&haveLookahead&&this.isVowel(lookahead)&&(cIsVowel=!1)),"-"===c?(haveCompleteSyllable=!0,previousWasVowel=!1,makeSyllable(i-startSyllable),startSyllable++):cIsVowel?(haveCompleteSyllable=!0,previousWasVowel&&!this.isDiphthong(workingString[i-1]+""+c)&&(makeSyllable(i-startSyllable),haveCompleteSyllable=!0),previousWasVowel=!0):haveLookahead&&("q"===c&&"u"===lookahead||"h"===lookahead&&("c"===c||"p"===c||"t"===c)?(makeSyllable(i-startSyllable),i++):previousWasVowel&&this.isVowel(lookahead)?makeSyllable(i-startSyllable):this.isMuteConsonantOrF(c)&&this.isLiquidConsonant(lookahead)?makeSyllable(i-startSyllable):haveCompleteSyllable&&makeSyllable(i+1-startSyllable),previousWasVowel=!1)}return haveCompleteSyllable?syllables.push(word.substr(startSyllable)):startSyllable>0&&(syllables[syllables.length-1]+=word.substr(startSyllable)),syllables}},{key:"findVowelSegment",value:function(s,startIndex){var i,end,index,workingString=s.toLowerCase();for(i=0,end=this.possibleDiphthongs.length;i<end;i++){var d=this.possibleDiphthongs[i];if(index=workingString.indexOf(d,startIndex),index>=0)return{found:!0,startIndex:index,length:d.length}}for(i=0,end=this.vowels.length;i<end;i++)if(index=workingString.indexOf(this.vowels[i],startIndex),index>=0)return this.isVowelActingAsConsonant(workingString.substr(index,2))&&++index,{found:!0,startIndex:index,length:1};return{found:!1,startIndex:-1,length:-1}}}]),Latin}(Language),exports.Spanish=function(_Language2){function Spanish(){_classCallCheck(this,Spanish);var _this2=_possibleConstructorReturn(this,Object.getPrototypeOf(Spanish).call(this,"Spanish"));return _this2.vowels=["a","e","i","o","u","y","á","é","í","ó","ú","ü"],_this2.weakVowels=["i","u","ü","y"],_this2.strongVowels=["a","e","o","á","é","í","ó","ú"],_this2.diphthongs=["ai","ei","oi","ui","ia","ie","io","iu","au","eu","ou","ua","ue","uo","ái","éi","ói","úi","iá","ié","ió","iú","áu","éu","óu","uá","ué","uó","üe","üi"],_this2.uDiphthongExceptions=["gue","gui","qua","que","qui","quo"],_this2}return _inherits(Spanish,_Language2),_createClass(Spanish,[{key:"isVowel",value:function(c){for(var i=0,end=this.vowels.length;i<end;i++)if(this.vowels[i]===c)return!0;return!1}},{key:"isWeakVowel",value:function(c){for(var i=0,end=this.weakVowels.length;i<end;i++)if(this.weakVowels[i]===c)return!0;return!1}},{key:"isStrongVowel",value:function(c){for(var i=0,end=this.strongVowels.length;i<end;i++)if(this.strongVowels[i]===c)return!0;return!1}},{key:"isDiphthong",value:function(s){for(var i=0,end=this.diphthongs.length;i<end;i++)if(this.diphthongs[i]===s)return!0;return!1}},{key:"createSyllable",value:function(text){return text}},{key:"syllabifyWord",value:function(word){var syllables=[],haveCompleteSyllable=!1,previousIsVowel=!1,previousIsStrongVowel=!1,startSyllable=0;for(i=0;i<word.length;i++){var c=word[i].toLowerCase();if(this.isVowel(c)){haveCompleteSyllable=!0;var cIsStrongVowel=this.isStrongVowel(c);previousIsVowel&&cIsStrongVowel&&previousIsStrongVowel&&(syllables.push(this.createSyllable(word.substr(startSyllable,i-startSyllable))),startSyllable=i),previousIsVowel=!0,previousIsStrongVowel=cIsStrongVowel}else{if(haveCompleteSyllable){if("-"===word[i])syllables.push(this.createSyllable(word.substr(startSyllable,i-startSyllable))),startSyllable=++i;else{var consonant2,numberOfConsonants=1;for(j=i+1;j<word.length&&!this.isVowel(word[j]);j++)numberOfConsonants++;1===numberOfConsonants?(syllables.push(this.createSyllable(word.substr(startSyllable,i-startSyllable))),startSyllable=i):2===numberOfConsonants?(consonant2=word[i+1].toLowerCase(),"l"===consonant2||"r"===consonant2||"c"===c&&"h"===consonant2?(syllables.push(this.createSyllable(word.substr(startSyllable,i-startSyllable))),startSyllable=i++):(syllables.push(this.createSyllable(word.substr(startSyllable,++i-startSyllable))),startSyllable=i)):3===numberOfConsonants?(consonant2=word[i+1].toLowerCase(),"s"===consonant2?(i+=2,syllables.push(this.createSyllable(word.substr(startSyllable,i-startSyllable)))):syllables.push(this.createSyllable(word.substr(startSyllable,++i-startSyllable))),startSyllable=i):4===numberOfConsonants&&(syllables.push(this.createSyllable(word.substr(startSyllable,i-startSyllable+2))),startSyllable=i+2,i+=3)}haveCompleteSyllable=!1}else;previousIsVowel=!1}}return haveCompleteSyllable?syllables.push(word.substr(startSyllable)):startSyllable>0?syllables[syllables.length-1]+=word.substr(startSyllable):0===syllables.length&&syllables.push(this.createSyllable(word)),syllables}},{key:"findVowelSegment",value:function(s,startIndex){var i,end,index,workingString=s.toLowerCase();for(i=0,end=this.diphthongs.length;i<end;i++){var d=this.diphthongs[i];if(index=workingString.indexOf(d,startIndex),index>=0){if("u"===d[0]&&index>0){var tripthong=s.substr(index-1,3).toLowerCase();for(j=0,endj=this.uDiphthongExceptions.length;i<endj;j++)if(tripthong===this.uDiphthongExceptions[j])return this.findVowelSegment(s,index+1)}return{found:!0,startIndex:index,length:d.length}}}for(i=0,end=this.vowels.length;i<end;i++)if(index=workingString.indexOf(this.vowels[i],startIndex),index>=0)return{found:!0,startIndex:index,length:1};return{found:!1,startIndex:-1,length:-1}}}]),Spanish}(Language)},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.Glyphs={None:{svgSrc:"<g></g>",paths:[{type:"positive",data:""}],bounds:{x:0,y:0,width:0,height:0},origin:{x:0,y:0},align:"left"},AcuteAccent:{svgSrc:'<path d="M4 0C-.614.52-.614.52-.803-3.182l60.768-108.422c4.52-7.182 10.543-13.67 18.075-13.67 5.27 0 14.31 1.264 23.346 7.793 7.53 5.223 8.803 11.752 8.803 16.975 0 3.917-.52 11.1-8.05 17.628L4 0z"/>',paths:[{type:"positive",data:"M4 0C-.614.52-.614.52-.803-3.182l60.768-108.422c4.52-7.182 10.543-13.67 18.075-13.67 5.27 0 14.31 1.264 23.346 7.793 7.53 5.223 8.803 11.752 8.803 16.975 0 3.917-.52 11.1-8.05 17.628L4 0z"}],bounds:{x:0,y:0,width:110.99200439453125,height:125.79399108886719},origin:{x:.8030000329017639,y:125.27399444580078},align:"left"},Stropha:{svgSrc:'<path d="M1.22-73.438c4.165 13.02 12.238 27.084 24.217 42.188L49.657 0 34.812 27.344C18.666 55.47-.084 72.396-21.438 78.124c4.687-3.645 7.03-8.593 7.03-14.843 0-8.853-4.947-20.572-14.843-35.155L-48 0 1.22-73.438z"/>',paths:[{type:"positive",data:"M1.22-73.438c4.165 13.02 12.238 27.084 24.217 42.188L49.657 0 34.812 27.344C18.666 55.47-.084 72.396-21.438 78.124c4.687-3.645 7.03-8.593 7.03-14.843 0-8.853-4.947-20.572-14.843-35.155L-48 0 1.22-73.438z"}],bounds:{x:0,y:0,width:97.65699768066406,height:151.56201171875},origin:{x:48,y:73.43800354003906},align:"left"},BeginningAscLiquescent:{svgSrc:'<path d="M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z"/>',paths:[{type:"positive",data:"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z"}],bounds:{x:0,y:0,width:100,height:152.343994140625},origin:{x:50,y:88.34400177001953},align:"left"},BeginningDesLiquescent:{svgSrc:'<path d="M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z"/>',paths:[{type:"positive",data:"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z"}],bounds:{x:0,y:0,width:100,height:151.56199645996094},origin:{x:50,y:75.56199645996094},align:"left"},CustosDescLong:{svgSrc:'<path d="M39.063 273.472c5.73.52 7.29-6.25 4.687-20.312V-65.59c-13.542 2.083-24.22 5.468-32.03 10.156C3.905-50.226 0-43.714 0-35.904V71.91c5.73-5.21 10.677-8.594 14.844-10.157 5.73-1.562 12.24-2.343 19.53-2.343v196.875c0 11.458 1.563 17.187 4.688 17.187z"/>',paths:[{type:"positive",data:"M39.063 273.472c5.73.52 7.29-6.25 4.687-20.312V-65.59c-13.542 2.083-24.22 5.468-32.03 10.156C3.905-50.226 0-43.714 0-35.904V71.91c5.73-5.21 10.677-8.594 14.844-10.157 5.73-1.562 12.24-2.343 19.53-2.343v196.875c0 11.458 1.563 17.187 4.688 17.187"}],bounds:{x:0,y:0,width:46.35300064086914,height:339.58197021484375},origin:{x:0,y:65.58999633789062},align:"left"},CustosDescShort:{svgSrc:'<path d="M34.375 191.923c0 8.333 1.563 12.24 4.688 11.72 3.125-.522 4.687-7.033 4.687-19.533v-250c-13.542 2.084-24.22 5.47-32.03 10.157C3.905-50.525 0-44.015 0-36.203V71.61c5.73-5.208 10.677-8.593 14.844-10.156 5.73-1.562 12.24-2.344 19.53-2.344v132.813z"/>',paths:[{type:"positive",data:"M34.375 191.923c0 8.333 1.563 12.24 4.688 11.72 3.125-.522 4.687-7.033 4.687-19.533v-250c-13.542 2.084-24.22 5.47-32.03 10.157C3.905-50.525 0-44.015 0-36.203V71.61c5.73-5.208 10.677-8.593 14.844-10.156 5.73-1.562 12.24-2.344 19.53-2.344v132.813z"}],bounds:{x:0,y:0,width:43.75,height:270.0530090332031},origin:{x:0,y:65.88999938964844},align:"left"},CustosLong:{svgSrc:'<path d="M39.063-269.562c5.73-.52 7.29 6.25 4.687 20.312V69.5c-13.542-2.083-24.22-5.47-32.03-10.156C3.905 54.134 0 47.624 0 39.812V-68c5.73 5.208 10.677 8.594 14.844 10.156 5.73 1.563 12.24 2.344 19.53 2.344v-196.875c0-11.458 1.563-17.187 4.688-17.187z"/>',paths:[{type:"positive",data:"M39.063-269.562c5.73-.52 7.29 6.25 4.687 20.312V69.5c-13.542-2.083-24.22-5.47-32.03-10.156C3.905 54.134 0 47.624 0 39.812V-68c5.73 5.208 10.677 8.594 14.844 10.156 5.73 1.563 12.24 2.344 19.53 2.344v-196.875c0-11.458 1.563-17.187 4.688-17.187z"}],bounds:{x:0,y:0,width:46.35300064086914,height:339.5820007324219},origin:{x:0,y:270.0820007324219},align:"left"},CustosShort:{svgSrc:'<path d="M34.375-188.125c0-8.333 1.563-12.24 4.688-11.72 3.125.522 4.687 7.033 4.687 19.532v250c-13.542-2.083-24.22-5.468-32.03-10.156C3.905 54.324 0 47.813 0 40V-67.813c5.73 5.21 10.677 8.594 14.844 10.157 5.73 1.562 12.24 2.344 19.53 2.343v-132.812z"/>',paths:[{type:"positive",data:"M34.375-188.125c0-8.333 1.563-12.24 4.688-11.72 3.125.522 4.687 7.033 4.687 19.532v250c-13.542-2.083-24.22-5.468-32.03-10.156C3.905 54.324 0 47.813 0 40V-67.813c5.73 5.21 10.677 8.594 14.844 10.157 5.73 1.562 12.24 2.344 19.53 2.343v-132.812z"}],bounds:{x:0,y:0,width:43.75,height:270.052001953125},origin:{x:0,y:200.36500549316406},align:"left"},DoClef:{svgSrc:'<path d="M0 98.406V-97.688C0-118 5.99-134.275 17.97-146.516c11.978-12.24 27.603-18.36 46.874-18.36 10.937 0 19.53 3.126 25.78 9.376s9.376 14.583 9.376 25v107.813l-6.25-5.47c-4.167-3.645-10.287-7.42-18.36-11.327-8.072-3.907-16.796-5.86-26.17-5.86-11.46 0-21.486 4.427-30.08 13.282-8.593 8.854-12.89 19.53-12.89 32.03s4.297 23.308 12.89 32.423c8.594 9.115 18.62 13.672 30.08 13.672 9.374 0 18.098-1.822 26.17-5.468 8.073-3.646 14.193-7.292 18.36-10.938l6.25-6.25V132c0 9.896-3.125 18.1-9.375 24.61-6.25 6.51-14.844 9.765-25.78 9.765-19.272 0-34.897-6.25-46.876-18.75C5.99 135.125 0 118.72 0 98.405z"/>',paths:[{type:"positive",data:"M0 98.406V-97.688C0-118 5.99-134.275 17.97-146.516c11.978-12.24 27.603-18.36 46.874-18.36 10.937 0 19.53 3.126 25.78 9.376s9.376 14.583 9.376 25v107.813l-6.25-5.47c-4.167-3.645-10.287-7.42-18.36-11.327-8.072-3.907-16.796-5.86-26.17-5.86-11.46 0-21.486 4.427-30.08 13.282-8.593 8.854-12.89 19.53-12.89 32.03s4.297 23.308 12.89 32.423c8.594 9.115 18.62 13.672 30.08 13.672 9.374 0 18.098-1.822 26.17-5.468 8.073-3.646 14.193-7.292 18.36-10.938l6.25-6.25V132c0 9.896-3.125 18.1-9.375 24.61-6.25 6.51-14.844 9.765-25.78 9.765-19.272 0-34.897-6.25-46.876-18.75C5.99 135.125 0 118.72 0 98.405z"}],bounds:{x:0,y:0,width:100,height:331.2510070800781},origin:{x:0,y:164.87600708007812},align:"left"},FaClef:{svgSrc:'<path d="M85.156-32v193.75c0 9.375-1.562 14.323-4.687 14.844-1.564 0-2.605-.52-3.126-1.563-.52-1.04-.782-2.603-.78-4.686V56.28c-8.335-8.332-19.793-12.5-34.376-12.5-17.71 0-31.77 3.907-42.188 11.72V-32c0-18.23 14.193-27.344 42.578-27.344 28.385 0 42.578 9.115 42.578 27.344zM98.438 93V-92.156c0-19.27 5.73-34.896 17.187-46.875 11.458-11.98 26.562-17.97 45.313-17.97 10.937 0 19.14 2.865 24.61 8.594 5.467 5.73 8.202 13.542 8.202 23.437v103.126l-5.47-4.687c-3.645-3.647-9.374-7.293-17.186-10.94-7.813-3.645-15.886-5.467-24.22-5.468-11.978 0-22.004 4.167-30.077 12.5-8.073 8.334-12.11 18.36-12.11 30.08 0 11.717 4.037 22.004 12.11 30.858s18.1 13.28 30.078 13.28c8.333 0 16.406-1.822 24.22-5.468 7.81-3.645 13.54-7.03 17.186-10.156l5.47-5.468V125.81c0 9.896-2.865 17.84-8.594 23.83-5.73 5.988-13.802 8.983-24.22 8.983-18.75 0-33.853-6.12-45.31-18.36-11.46-12.24-17.19-27.994-17.19-47.265z"/>',paths:[{type:"positive",data:"M85.156-32v193.75c0 9.375-1.562 14.323-4.687 14.844-1.564 0-2.605-.52-3.126-1.563-.52-1.04-.782-2.603-.78-4.686V56.28c-8.335-8.332-19.793-12.5-34.376-12.5-17.71 0-31.77 3.907-42.188 11.72V-32c0-18.23 14.193-27.344 42.578-27.344 28.385 0 42.578 9.115 42.578 27.344zM98.438 93V-92.156c0-19.27 5.73-34.896 17.187-46.875 11.458-11.98 26.562-17.97 45.313-17.97 10.937 0 19.14 2.865 24.61 8.594 5.467 5.73 8.202 13.542 8.202 23.437v103.126l-5.47-4.687c-3.645-3.647-9.374-7.293-17.186-10.94-7.813-3.645-15.886-5.467-24.22-5.468-11.978 0-22.004 4.167-30.077 12.5-8.073 8.334-12.11 18.36-12.11 30.08 0 11.717 4.037 22.004 12.11 30.858s18.1 13.28 30.078 13.28c8.333 0 16.406-1.822 24.22-5.468 7.81-3.645 13.54-7.03 17.186-10.156l5.47-5.468V125.81c0 9.896-2.865 17.84-8.594 23.83-5.73 5.988-13.802 8.983-24.22 8.983-18.75 0-33.853-6.12-45.31-18.36-11.46-12.24-17.19-27.994-17.19-47.265z"}],bounds:{x:0,y:0,width:193.75201416015625,height:333.5950012207031},origin:{x:.001003265380859375,y:157.00100708007812},align:"left"},Flat:{svgSrc:'<path d="M7.813-204.406c4.166 0 6.25 5.208 6.25 15.625L12.5-10.657C33.854 13.302 54.167 25.28 73.438 25.28c9.374 0 14.062-4.686 14.062-14.06 0-6.25-1.042-11.72-3.125-16.407-2.083-4.688-7.03-9.766-14.844-15.235-7.81-5.47-13.02-8.984-15.624-10.547L27.344-45.81V-80.97c17.187 0 33.073 4.82 47.656 14.454C89.583-56.88 96.875-47.376 96.875-38c0 67.708-.26 101.562-.78 101.563-38.543 0-69.532-12.24-92.97-36.72C0-52.322-1.042-123.936 0-188c0-10.937 2.604-16.406 7.813-16.406z"/>',paths:[{type:"positive",data:"M7.813-204.406c4.166 0 6.25 5.208 6.25 15.625L12.5-10.657C33.854 13.302 54.167 25.28 73.438 25.28c9.374 0 14.062-4.686 14.062-14.06 0-6.25-1.042-11.72-3.125-16.407-2.083-4.688-7.03-9.766-14.844-15.235-7.81-5.47-13.02-8.984-15.624-10.547L27.344-45.81V-80.97c17.187 0 33.073 4.82 47.656 14.454C89.583-56.88 96.875-47.376 96.875-38c0 67.708-.26 101.562-.78 101.563-38.543 0-69.532-12.24-92.97-36.72C0-52.322-1.042-123.936 0-188c0-10.937 2.604-16.406 7.813-16.406z"}],bounds:{x:0,y:0,width:97.91699981689453,height:267.968994140625},origin:{x:1.0420000553131104,y:204.406005859375},align:"left"},Mora:{svgSrc:'<path d="M47.478-24c6.957 0 12.793 2.288 17.49 6.883C69.662-12.52 72-6.904 72-.267c0 6.64-2.337 12.352-7.033 17.118C60.27 21.618 54.435 24 47.477 24c-6.26 0-11.748-2.383-16.444-7.15C26.337 12.086 24 6.374 24-.265c0-6.638 2.337-12.255 7.033-16.85C35.73-21.713 41.217-24 47.478-24z"/>',paths:[{type:"positive",data:"M47.478-24c6.957 0 12.793 2.288 17.49 6.883C69.662-12.52 72-6.904 72-.267c0 6.64-2.337 12.352-7.033 17.118C60.27 21.618 54.435 24 47.477 24c-6.26 0-11.748-2.383-16.444-7.15C26.337 12.086 24 6.374 24-.265c0-6.638 2.337-12.255 7.033-16.85C35.73-21.713 41.217-24 47.478-24z"}],bounds:{x:0,y:0,width:48,height:48},origin:{x:-24,y:24},align:"left"},Natural:{svgSrc:'<path d="M7.906-166.563c-2.864 0-5.614.52-8.218 1.563v13.28l.78 56.25.782 78.907v85.157c.52 3.646 2.604 5.73 6.25 6.25l23.438-3.906 23.437-3.907v29.69c0 42.186-.26 63.54-.78 64.06l6.25 2.345c1.04.52 2.082.78 3.124.78 2.603 0 4.947-1.3 7.03-3.905L67.656-71.25c-.52-2.604-2.083-3.906-4.687-3.906-7.814 0-17.19 1.04-28.126 3.125l-19.53 3.124.78-38.28V-165c-2.604-1.042-5.323-1.562-8.188-1.563zM55.938-40v71.875l-41.407 7.03c0-48.436.262-72.655.783-72.655L55.938-40z"/>',paths:[{type:"positive",data:"M7.906-166.563c-2.864 0-5.614.52-8.218 1.563v13.28l.78 56.25.782 78.907v85.157c.52 3.646 2.604 5.73 6.25 6.25l23.438-3.906 23.437-3.907v29.69c0 42.186-.26 63.54-.78 64.06l6.25 2.345c1.04.52 2.082.78 3.124.78 2.603 0 4.947-1.3 7.03-3.905L67.656-71.25c-.52-2.604-2.083-3.906-4.687-3.906-7.814 0-17.19 1.04-28.126 3.125l-19.53 3.124.78-38.28V-165c-2.604-1.042-5.323-1.562-8.188-1.563zM55.938-40v71.875l-41.407 7.03c0-48.436.262-72.655.783-72.655L55.938-40z"}],bounds:{x:0,y:0,width:70.31100463867188,height:330.468994140625},origin:{x:.3120002746582031,y:166.56300354003906},align:"left"},OriscusAsc:{svgSrc:'<path d="M50 30.25c0 12.5-3.125 21.354-9.375 26.562-3.125 2.605-7.813 3.907-14.063 3.907-3.125 0-5.99-.522-8.593-1.564-2.605-1.04-5.6-2.474-8.986-4.297C5.6 53.035 2.734 51.603.39 50.56c-2.343-1.04-5.338-2.474-8.984-4.296-3.646-1.823-6.77-3.256-9.375-4.297-2.603-1.043-5.468-1.564-8.593-1.564-6.25 0-10.937 1.563-14.062 4.688C-46.875 50.824-50 59.677-50 71.656v-106.25c0-13.02 3.125-21.875 9.375-26.562 3.125-2.604 7.813-3.906 14.063-3.907 3.125 0 5.99.52 8.593 1.563 2.605 1.042 5.73 2.474 9.376 4.297 3.646 1.823 6.51 2.995 8.594 3.516l10.938 5.468c6.25 3.126 11.458 4.69 15.624 4.69 6.25 0 10.938-1.564 14.063-4.69C46.875-55.426 50-64.02 50-76V30.25z"/>',
paths:[{type:"positive",data:"M50 30.25c0 12.5-3.125 21.354-9.375 26.562-3.125 2.605-7.813 3.907-14.063 3.907-3.125 0-5.99-.522-8.593-1.564-2.605-1.04-5.6-2.474-8.986-4.297C5.6 53.035 2.734 51.603.39 50.56c-2.343-1.04-5.338-2.474-8.984-4.296-3.646-1.823-6.77-3.256-9.375-4.297-2.603-1.043-5.468-1.564-8.593-1.564-6.25 0-10.937 1.563-14.062 4.688C-46.875 50.824-50 59.677-50 71.656v-106.25c0-13.02 3.125-21.875 9.375-26.562 3.125-2.604 7.813-3.906 14.063-3.907 3.125 0 5.99.52 8.593 1.563 2.605 1.042 5.73 2.474 9.376 4.297 3.646 1.823 6.51 2.995 8.594 3.516l10.938 5.468c6.25 3.126 11.458 4.69 15.624 4.69 6.25 0 10.938-1.564 14.063-4.69C46.875-55.426 50-64.02 50-76V30.25z"}],bounds:{x:0,y:0,width:100,height:147.656005859375},origin:{x:50,y:76},align:"left"},OriscusDes:{svgSrc:'<path d="M-50 30.844v-106.25c0 11.458 3.125 20.052 9.375 25.78 3.125 3.126 7.813 4.69 14.063 4.688 4.687 0 13.41-3.255 26.17-9.765 12.762-6.51 21.746-9.766 26.954-9.766 6.25 0 10.938 1.303 14.063 3.907C46.875-55.874 50-47.02 50-34V72.25c0-11.98-3.125-20.833-9.375-26.563C37.5 42.563 32.812 41 26.562 41 21.875 41 13.023 44.385 0 51.156c-4.167 2.604-8.594 4.948-13.28 7.032-4.69 2.083-9.116 3.124-13.283 3.124-6.25 0-10.937-1.302-14.062-3.906C-46.875 52.198-50 43.344-50 30.844z"/>',paths:[{type:"positive",data:"M-50 30.844v-106.25c0 11.458 3.125 20.052 9.375 25.78 3.125 3.126 7.813 4.69 14.063 4.688 4.687 0 13.41-3.255 26.17-9.765 12.762-6.51 21.746-9.766 26.954-9.766 6.25 0 10.938 1.303 14.063 3.907C46.875-55.874 50-47.02 50-34V72.25c0-11.98-3.125-20.833-9.375-26.563C37.5 42.563 32.812 41 26.562 41 21.875 41 13.023 44.385 0 51.156c-4.167 2.604-8.594 4.948-13.28 7.032-4.69 2.083-9.116 3.124-13.283 3.124-6.25 0-10.937-1.302-14.062-3.906C-46.875 52.198-50 43.344-50 30.844z"}],bounds:{x:0,y:0,width:100,height:147.656005859375},origin:{x:50,y:75.40599822998047},align:"left"},OriscusLiquescent:{svgSrc:'<path d="M 19.05539,78.886528 C 20.242277,78.486807 21.532179,77.890297 22.925106,77.09701 24.317891,76.303653 26.700882,74.417241 30.074091,71.437777 33.447144,68.45824 36.523539,64.985185 39.303286,61.018598 42.082855,57.051975 44.562739,51.395765 46.742952,44.049969 48.922975,36.704172 50.01304,28.671032 50.013135,19.950525 L 50.013135,-34.225545 C 50.01304,-54.464261 42.07377,-64.583661 26.195289,-64.583768 20.248326,-64.583661 11.518758,-61.410372 0.00656131,-55.06389 -11.505742,-48.717218 -20.23531,-45.543929 -26.182179,-45.544024 -34.515109,-45.543929 -40.567968,-48.520405 -44.340791,-54.473441 -48.113613,-60.426286 -50.000025,-67.369373 -50.000025,-75.302702 L -50.000025,30.069925 C -50.000025,49.909039 -42.060754,59.828603 -26.182179,59.828615 -21.022584,59.828603 -12.38991,56.455465 -0.28412107,49.709203 11.821549,42.96294 20.648023,39.589803 26.195289,39.589803 29.368506,40.776762 30.361665,44.249817 29.17479,50.00897 27.987759,55.768122 26.00143,62.020829 23.215789,68.767116 z"/>',paths:[{type:"positive",data:"M 19.05539,78.886528 C 20.242277,78.486807 21.532179,77.890297 22.925106,77.09701 24.317891,76.303653 26.700882,74.417241 30.074091,71.437777 33.447144,68.45824 36.523539,64.985185 39.303286,61.018598 42.082855,57.051975 44.562739,51.395765 46.742952,44.049969 48.922975,36.704172 50.01304,28.671032 50.013135,19.950525 L 50.013135,-34.225545 C 50.01304,-54.464261 42.07377,-64.583661 26.195289,-64.583768 20.248326,-64.583661 11.518758,-61.410372 0.00656131,-55.06389 -11.505742,-48.717218 -20.23531,-45.543929 -26.182179,-45.544024 -34.515109,-45.543929 -40.567968,-48.520405 -44.340791,-54.473441 -48.113613,-60.426286 -50.000025,-67.369373 -50.000025,-75.302702 L -50.000025,30.069925 C -50.000025,49.909039 -42.060754,59.828603 -26.182179,59.828615 -21.022584,59.828603 -12.38991,56.455465 -0.28412107,49.709203 11.821549,42.96294 20.648023,39.589803 26.195289,39.589803 29.368506,40.776762 30.361665,44.249817 29.17479,50.00897 27.987759,55.768122 26.00143,62.020829 23.215789,68.767116 z"}],bounds:{x:0,y:0,width:100,height:147.656005859375},origin:{x:50,y:75.40599822998047},align:"left"},PodatusLower:{svgSrc:'<path d="M-4.688-30.28c22.396 0 34.636-.262 36.72-.782 5.728-1.563 8.593-5.21 8.593-10.938H50v97.656c0 2.604-1.302 4.167-3.906 4.688-5.21.52-21.355.78-48.438.78-23.958 0-38.54-.26-43.75-.78-2.604 0-3.906-1.302-3.906-3.906v-82.032c0-3.646 1.302-5.468 3.906-5.468h2.344c2.604.52 15.625.78 39.063.78z"/>',paths:[{type:"positive",data:"M-4.688-30.28c22.396 0 34.636-.262 36.72-.782 5.728-1.563 8.593-5.21 8.593-10.938H50v97.656c0 2.604-1.302 4.167-3.906 4.688-5.21.52-21.355.78-48.438.78-23.958 0-38.54-.26-43.75-.78-2.604 0-3.906-1.302-3.906-3.906v-82.032c0-3.646 1.302-5.468 3.906-5.468h2.344c2.604.52 15.625.78 39.063.78z"}],bounds:{x:0,y:0,width:100,height:103.12399291992188},origin:{x:50,y:42},align:"left"},PodatusUpper:{svgSrc:'<path d="M-46.094-63.78c13.542 0 24.61 2.473 33.203 7.42C-4.298-51.41 0-43.99 0-34.093V62h-9.375c0-10.938-2.604-19.14-7.812-24.61-5.21-5.468-14.844-8.203-28.907-8.202-18.23 0-33.333 4.166-45.312 12.5v-75.782c0-19.79 15.104-29.687 45.312-29.687z"/>',paths:[{type:"positive",data:"M-46.094-63.78c13.542 0 24.61 2.473 33.203 7.42C-4.298-51.41 0-43.99 0-34.093V62h-9.375c0-10.938-2.604-19.14-7.812-24.61-5.21-5.468-14.844-8.203-28.907-8.202-18.23 0-33.333 4.166-45.312 12.5v-75.782c0-19.79 15.104-29.687 45.312-29.687z"}],bounds:{x:0,y:0,width:91.406005859375,height:125.78099822998047},origin:{x:91.406005859375,y:63.78099822998047},align:"right"},Porrectus1:{svgSrc:'<path d="M233.594 162.875c-58.855 0-107.032-6.25-144.53-18.75C34.895 125.895-11.46 99.855-50 66V-52.75C-21.354-24.625 26.302 6.885 92.97 41.78 123.697 57.928 163.54 66 212.5 66c21.354 0 34.635-9.896 39.844-29.688V151.94c0 7.29-6.25 10.937-18.75 10.937z"/>',paths:[{type:"positive",data:"M233.594 162.875c-58.855 0-107.032-6.25-144.53-18.75C34.895 125.895-11.46 99.855-50 66V-52.75C-21.354-24.625 26.302 6.885 92.97 41.78 123.697 57.928 163.54 66 212.5 66c21.354 0 34.635-9.896 39.844-29.688V151.94c0 7.29-6.25 10.937-18.75 10.937z"}],bounds:{x:0,y:0,width:302.343994140625,height:215.6269989013672},origin:{x:50,y:52.75},align:"left"},Porrectus2:{svgSrc:'<path d="M309.375 259.375c-50.52 0-110.938-22.396-181.25-67.188C48.437 141.667-10.938 94.272-50 50V-68.75C0-3.125 60.417 52.083 131.25 96.875c58.333 36.98 110.677 58.854 157.03 65.625h7.033c16.145 0 26.822-9.896 32.03-29.688v114.844c0 7.812-5.99 11.72-17.968 11.72z"/>',paths:[{type:"positive",data:"M309.375 259.375c-50.52 0-110.938-22.396-181.25-67.188C48.437 141.667-10.938 94.272-50 50V-68.75C0-3.125 60.417 52.083 131.25 96.875c58.333 36.98 110.677 58.854 157.03 65.625h7.033c16.145 0 26.822-9.896 32.03-29.688v114.844c0 7.812-5.99 11.72-17.968 11.72z"}],bounds:{x:0,y:0,width:377.3429870605469,height:328.1260070800781},origin:{x:50,y:68.75},align:"left"},Porrectus3:{svgSrc:'<path d="M309.375 355.78c-48.96-16.666-109.115-55.468-180.47-116.405C79.428 198.23 19.793 134.687-50 48.75V-70C20 40 94.104 103.79 135.25 148.063 190 200 230 230 288.28 258.906c4.168 2.083 8.334 3.125 12.5 3.125 12.5 0 21.355-10.937 26.564-32.81v114.06c0 9.376-3.386 14.063-10.156 14.064-2.084 0-4.688-.522-7.813-1.563z"/>',paths:[{type:"positive",data:"M309.375 355.78c-48.96-16.666-109.115-55.468-180.47-116.405C79.428 198.23 19.793 134.687-50 48.75V-70C20 40 94.104 103.79 135.25 148.063 190 200 230 230 288.28 258.906c4.168 2.083 8.334 3.125 12.5 3.125 12.5 0 21.355-10.937 26.564-32.81v114.06c0 9.376-3.386 14.063-10.156 14.064-2.084 0-4.688-.522-7.813-1.563z"}],bounds:{x:0,y:0,width:377.343994140625,height:427.3450012207031},origin:{x:50,y:70},align:"left"},Porrectus4:{svgSrc:'<path d="M350 453.438c-52.754-22.397-120-77.345-201.74-164.844C90.87 227.656 24.784 147.708-50 48.75V-70C-8.84-1.25 58.406 86.51 151.74 193.28c60.868 69.793 119.13 124.22 174.782 163.282 5.797 3.646 11.014 5.47 15.652 5.47 12.173 0 21.45-11.72 27.826-35.157V441.72c0 9.373-3.19 14.06-9.565 14.06-2.9 0-6.377-.78-10.435-2.342z"/>',paths:[{type:"positive",data:"M350 453.438c-52.754-22.397-120-77.345-201.74-164.844C90.87 227.656 24.784 147.708-50 48.75V-70C-8.84-1.25 58.406 86.51 151.74 193.28c60.868 69.793 119.13 124.22 174.782 163.282 5.797 3.646 11.014 5.47 15.652 5.47 12.173 0 21.45-11.72 27.826-35.157V441.72c0 9.373-3.19 14.06-9.565 14.06-2.9 0-6.377-.78-10.435-2.342z"}],bounds:{x:0,y:0,width:420,height:525.780029296875},origin:{x:50,y:70},align:"left"},PunctumCavum:{svgSrc:'<path d="M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z"/><path fill="#fff" d="M.08-42.56c9.585.206 20.126.53 27.954 6.822 4.96 3.9 4.71 10.792 4.574 16.482v51.278C22.09 27.066 7.283 26.072.168 26.01c-7.72.23-21.895.935-32.616 4.674.04-19.197-.083-38.395.064-57.59.567-7.5 7.834-12.33 14.62-13.774 5.818-1.498 11.857-1.86 17.844-1.88z"/>',paths:[{type:"positive",data:"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z"},{type:"negative",data:"M.08-42.56c9.585.206 20.126.53 27.954 6.822 4.96 3.9 4.71 10.792 4.574 16.482v51.278C22.09 27.066 7.283 26.072.168 26.01c-7.72.23-21.895.935-32.616 4.674.04-19.197-.083-38.395.064-57.59.567-7.5 7.834-12.33 14.62-13.774 5.818-1.498 11.857-1.86 17.844-1.88z"}],bounds:{x:0,y:0,width:100,height:123.43799591064453},origin:{x:50,y:60.90599822998047},align:"left"},PunctumQuadratum:{svgSrc:'<path d="M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z"/>',paths:[{type:"positive",data:"M0-60.906c33.333 0 50 9.635 50 28.906v94.53C39.062 51.595 22.396 46.126 0 46.126s-39.063 5.47-50 16.406V-32c0-19.27 16.667-28.906 50-28.906z"}],bounds:{x:0,y:0,width:100,height:123.43799591064453},origin:{x:50,y:60.90599822998047},align:"left"},PunctumQuadratumAscLiquescent:{svgSrc:'<path d="M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z"/>',paths:[{type:"positive",data:"M-50 43.688V-61c4.167 7.292 12.76 10.938 25.78 10.938 9.376 0 20.053-1.563 32.032-4.688C31.773-60.48 45.833-71.677 50-88.344v117.97C43.75 42.645 32.812 51.5 17.187 56.186-.52 61.398-15.886 64-28.906 64-42.97 64-50 57.23-50 43.687z"}],bounds:{x:0,y:0,width:100,height:152.343994140625},origin:{x:50,y:88.34400177001953},align:"left"},PunctumQuadratumDesLiquescent:{svgSrc:'<path d="M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z"/>',paths:[{type:"positive",data:"M-50-56.03c0-13.022 7.03-19.532 21.094-19.532 13.02 0 28.385 2.604 46.093 7.812C32.813-63.583 43.75-54.73 50-41.187V76C45.833 59.854 31.77 48.656 7.812 42.406c-11.98-3.125-22.656-4.687-32.03-4.687-13.022 0-21.615 3.905-25.782 11.718v-105.47z"}],bounds:{x:0,y:0,width:100,height:151.56199645996094},origin:{x:50,y:75.56199645996094},align:"left"},PunctumInclinatum:{svgSrc:'<path d="M0-75.78L50 0 0 75-50 0 0-75.78z"/>',paths:[{type:"positive",data:"M0-75.78L50 0 0 75-50 0 0-75.78z"}],bounds:{x:0,y:0,width:100,height:150.77999877929688},origin:{x:50,y:75.77999877929688},align:"left"},PunctumInclinatumLiquescent:{svgSrc:'<path d="M 0,-53.164062 35,-0.1171875 0,52.382812 -35,-0.1171875 0,-53.164062 z"/>',paths:[{type:"positive",data:"M 0,-53.164062 35,-0.1171875 0,52.382812 -35,-0.1171875 0,-53.164062 z"}],bounds:{x:0,y:0,width:70,height:105.546},origin:{x:35,y:53.164062},align:"left"},Quilisma:{svgSrc:'<path d="M-50 34.938V-51c5.73 20.833 13.02 31.25 21.875 31.25 7.813 0 12.5-15.625 14.063-46.875 3.645 12.5 6.9 21.224 9.765 26.172s6.9 7.422 12.11 7.422c5.208 0 9.374-14.324 12.5-42.97 5.73 22.917 10.677 34.375 14.843 34.375 5.73 0 10.677-15.885 14.844-47.656v100c0 17.707-3.125 26.56-9.375 26.56-4.688 0-9.115-5.988-13.28-17.968-2.085 21.875-8.074 32.813-17.97 32.813-7.813 0-16.146-7.292-25-21.875-4.688 20.312-10.677 30.47-17.97 30.47-5.207 0-9.244-2.605-12.108-7.814C-48.568 47.698-50 41.708-50 34.938z"/>',paths:[{type:"positive",data:"M-50 34.938V-51c5.73 20.833 13.02 31.25 21.875 31.25 7.813 0 12.5-15.625 14.063-46.875 3.645 12.5 6.9 21.224 9.765 26.172s6.9 7.422 12.11 7.422c5.208 0 9.374-14.324 12.5-42.97 5.73 22.917 10.677 34.375 14.843 34.375 5.73 0 10.677-15.885 14.844-47.656v100c0 17.707-3.125 26.56-9.375 26.56-4.688 0-9.115-5.988-13.28-17.968-2.085 21.875-8.074 32.813-17.97 32.813-7.813 0-16.146-7.292-25-21.875-4.688 20.312-10.677 30.47-17.97 30.47-5.207 0-9.244-2.605-12.108-7.814C-48.568 47.698-50 41.708-50 34.938z"}],bounds:{x:0,y:0,width:100,height:150},origin:{x:50,y:89.28199768066406},align:"left"},TerminatingAscLiquescent:{svgSrc:'<path d="M-9.375 40.22c0-11.98-4.948-17.97-14.844-17.97-10.936 0-19.53 3.646-25.78 10.938v-53.126c0-6.77 2.604-12.76 7.813-17.968 5.208-5.21 10.677-8.594 16.406-10.157 2.603-.52 5.207-.78 7.81-.78 3.647 0 7.032.78 10.157 2.343C-2.603-43.896 0-39.73 0-34V73.03h-9.375V40.22z"/>',paths:[{type:"positive",data:"M-9.375 40.22c0-11.98-4.948-17.97-14.844-17.97-10.936 0-19.53 3.646-25.78 10.938v-53.126c0-6.77 2.604-12.76 7.813-17.968 5.208-5.21 10.677-8.594 16.406-10.157 2.603-.52 5.207-.78 7.81-.78 3.647 0 7.032.78 10.157 2.343C-2.603-43.896 0-39.73 0-34V73.03h-9.375V40.22z"}],bounds:{x:0,y:0,width:49.999000549316406,height:121.87299346923828},origin:{x:49.999000549316406,y:48.842994689941406},align:"right"},TerminatingDesLiquescent:{svgSrc:'<path d="M-9.375-48.156V-80.97H0V26.845c0 5.73-2.604 9.896-7.813 12.5-3.125 1.562-6.51 2.343-10.156 2.343-2.603 0-5.207-.26-7.81-.78-5.73-1.563-11.2-4.95-16.407-10.157C-47.398 25.542-50 19.292-50 12v-52.344c6.25 7.292 14.844 10.938 25.78 10.938 9.897 0 14.845-6.25 14.845-18.75z"/>',paths:[{type:"positive",data:"M-9.375-48.156V-80.97H0V26.845c0 5.73-2.604 9.896-7.813 12.5-3.125 1.562-6.51 2.343-10.156 2.343-2.603 0-5.207-.26-7.81-.78-5.73-1.563-11.2-4.95-16.407-10.157C-47.398 25.542-50 19.292-50 12v-52.344c6.25 7.292 14.844 10.938 25.78 10.938 9.897 0 14.845-6.25 14.845-18.75z"}],bounds:{x:0,y:0,width:50,height:122.65800476074219},origin:{x:50,y:80.97000122070312},align:"right"},VerticalEpisemaAbove:{svgSrc:'<path d="M-8-80H8L4 0h-8l-4-80z"/>',paths:[{type:"positive",data:"M-8-80H8L4 0h-8l-4-80z"}],bounds:{x:0,y:0,width:16,height:80},origin:{x:8,y:80},align:"left"},VerticalEpisemaBelow:{svgSrc:'<path d="M-8 80H8L4 0h-8l-4 80z"/>',paths:[{type:"positive",data:"M-8 80H8L4 0h-8l-4 80z"}],bounds:{x:0,y:0,width:16,height:80},origin:{x:8,y:0},align:"left"},VirgaLong:{svgSrc:'<path d="M50-38v285.156c0 6.77-2.344 10.937-7.03 12.5-1.564 0-2.605-.78-3.126-2.344-.52-1.562-.782-10.156-.782-25.78V54.186C29.168 45.334 16.146 40.907 0 40.907c-22.917 0-39.583 5.208-50 15.624V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z"/>',paths:[{type:"positive",data:"M50-38v285.156c0 6.77-2.344 10.937-7.03 12.5-1.564 0-2.605-.78-3.126-2.344-.52-1.562-.782-10.156-.782-25.78V54.186C29.168 45.334 16.146 40.907 0 40.907c-22.917 0-39.583 5.208-50 15.624V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z"}],bounds:{x:0,y:0,width:100,height:326.56201171875},origin:{x:50,y:66.90599822998047},align:"left"},VirgaShort:{svgSrc:'<path d="M50-38v211.72c0 7.29-2.344 11.457-7.03 12.5-1.564 0-2.606-.783-3.126-2.345-.52-1.563-.782-10.156-.782-25.78V54.187C29.167 45.332 16.146 40.906 0 40.906c-22.917 0-39.583 5.21-50 15.625V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z"/>',paths:[{type:"positive",data:"M50-38v211.72c0 7.29-2.344 11.457-7.03 12.5-1.564 0-2.606-.783-3.126-2.345-.52-1.563-.782-10.156-.782-25.78V54.187C29.167 45.332 16.146 40.906 0 40.906c-22.917 0-39.583 5.21-50 15.625V-38c0-19.27 16.667-28.906 50-28.906S50-57.27 50-38z"}],bounds:{x:0,y:0,width:100,height:253.12600708007812},origin:{x:50,y:66.90599822998047},align:"left"},Virgula:{svgSrc:'<path d="M8.178-55.66c0-22.137 12.092-33.2 36.287-33.2 11.835 0 23.53 5.66 35.108 16.98C91.15-60.547 96.94-41.766 96.94-15.534c0 53.515-31.646 87.487-94.937 101.895-2.048-2.06-3.077-5.146-3.077-9.273 0-1.03.247-1.8.76-2.316 42.71-19.027 64.075-41.678 64.075-67.92 0-11.322-2.325-20.326-6.945-27.016-4.62-6.69-9.52-11.052-14.676-13.11-5.147-2.048-11.836-3.85-20.07-5.403C12.81-39.707 8.18-45.37 8.18-55.66z"/>',paths:[{type:"positive",data:"M8.178-55.66c0-22.137 12.092-33.2 36.287-33.2 11.835 0 23.53 5.66 35.108 16.98C91.15-60.547 96.94-41.766 96.94-15.534c0 53.515-31.646 87.487-94.937 101.895-2.048-2.06-3.077-5.146-3.077-9.273 0-1.03.247-1.8.76-2.316 42.71-19.027 64.075-41.678 64.075-67.92 0-11.322-2.325-20.326-6.945-27.016-4.62-6.69-9.52-11.052-14.676-13.11-5.147-2.048-11.836-3.85-20.07-5.403C12.81-39.707 8.18-45.37 8.18-55.66z"}],bounds:{x:0,y:0,width:98.01399993896484,height:175.2209930419922},origin:{x:1.0739939212799072,y:88.86000061035156},align:"left"}}},function(module,exports,__webpack_require__){"use strict";function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function MarkupStackFrame(symbol,startIndex,properties){this.symbol=symbol,this.startIndex=startIndex,this.properties=properties}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChantNotationElement=exports.Annotation=exports.DropCap=exports.Lyric=exports.LyricType=exports.TextElement=exports.CurlyBraceVisualizer=exports.RoundBraceVisualizer=exports.GlyphVisualizer=exports.VirgaLineVisualizer=exports.NeumeLineVisualizer=exports.DividerLineVisualizer=exports.ChantLayoutElement=exports.ChantContext=exports.QuickSvg=exports.GlyphCode=void 0;var _get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Exsurge=__webpack_require__(1),_Exsurge2=__webpack_require__(3),_Exsurge3=__webpack_require__(2),__exsurgeCharactersFont=__webpack_require__(5),GlyphCode=exports.GlyphCode={None:"None",AcuteAccent:"AcuteAccent",Stropha:"Stropha",StrophaLiquescent:"StrophaLiquescent",BeginningAscLiquescent:"BeginningAscLiquescent",BeginningDesLiquescent:"BeginningDesLiquescent",CustosDescLong:"CustosDescLong",CustosDescShort:"CustosDescShort",CustosLong:"CustosLong",CustosShort:"CustosShort",DoClef:"DoClef",FaClef:"FaClef",Flat:"Flat",Mora:"Mora",Natural:"Natural",OriscusAsc:"OriscusAsc",OriscusDes:"OriscusDes",OriscusLiquescent:"OriscusLiquescent",PodatusLower:"PodatusLower",PodatusUpper:"PodatusUpper",Porrectus1:"Porrectus1",Porrectus2:"Porrectus2",Porrectus3:"Porrectus3",Porrectus4:"Porrectus4",PunctumCavum:"PunctumCavum",PunctumQuadratum:"PunctumQuadratum",PunctumQuadratumAscLiquescent:"PunctumQuadratumAscLiquescent",PunctumQuadratumDesLiquescent:"PunctumQuadratumDesLiquescent",PunctumInclinatum:"PunctumInclinatum",PunctumInclinatumLiquescent:"PunctumInclinatumLiquescent",Quilisma:"Quilisma",TerminatingAscLiquescent:"TerminatingAscLiquescent",TerminatingDesLiquescent:"TerminatingDesLiquescent",VerticalEpisemaAbove:"VerticalEpisemaAbove",VerticalEpisemaBelow:"VerticalEpisemaBelow",VirgaLong:"VirgaLong",VirgaShort:"VirgaShort",Virgula:"Virgula",UpperBrace:"UpperBrace"},QuickSvg=exports.QuickSvg={ns:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xlink:"http://www.w3.org/1999/xlink",svg:function(width,height){var node=document.createElementNS(this.ns,"svg");node.setAttribute("xmlns",this.ns),node.setAttribute("version","1.1"),node.setAttributeNS(this.xmlns,"xmlns:xlink",this.xlink),node.setAttribute("width",width),node.setAttribute("height",height);var defs=document.createElementNS(this.ns,"defs");return node.appendChild(defs),node.defs=defs,node.clearNotations=function(){for(node.removeChild(defs);node.hasChildNodes();)node.removeChild(node.lastChild);node.appendChild(defs)},node},rect:function(width,height){var node=document.createElementNS(this.ns,"rect");return node.setAttribute("width",width),node.setAttribute("height",height),node},line:function(x1,y1,x2,y2){var node=document.createElementNS(this.ns,"line");return node.setAttribute("x1",x1),node.setAttribute("y1",y1),node.setAttribute("x2",x2),node.setAttribute("y2",y2),node},g:function(){var node=document.createElementNS(this.ns,"g");return node},text:function(){var node=document.createElementNS(this.ns,"text");return node},tspan:function(str){var node=document.createElementNS(this.ns,"tspan");return node.textContent=str,node},use:function(nodeRef){var node=document.createElementNS(this.ns,"use");return node.setAttributeNS(this.xlink,"xlink:href","#"+nodeRef),node},createFragment:function(name,attributes,child){void 0!==child&&null!==child||(child="");var fragment="<"+name+" ";for(var attr in attributes)attributes.hasOwnProperty(attr)&&(fragment+=attr+'="'+attributes[attr]+'" ');return fragment+=">"+child+"</"+name+">"},parseFragment:function(fragment){var well=document.createElement("svg");if(fragment){var container=this.g();well.innerHTML="<svg>"+fragment.replace(/\n/,"").replace(/<(\w+)([^<]+?)\/>/g,"<$1$2></$1>")+"</svg>";for(var i=0,il=well.firstChild.childNodes.length;i<il;i++)container.appendChild(well.firstChild.firstChild);return container}},translate:function(node,x,y){return node.setAttribute("transform","translate("+x+","+y+")"),node},scale:function(node,sx,sy){return node.setAttribute("transform","scale("+sx+","+sy+")"),node}},ChantLayoutElement=(exports.ChantContext=function(){function ChantContext(){_classCallCheck(this,ChantContext),this.defs={},this.lyricTextSize=16,this.lyricTextFont="'Palatino Linotype', 'Book Antiqua', Palatino, serif",this.lyricTextColor="#000",this.dropCapTextSize=64,this.dropCapTextFont=this.lyricTextFont,this.dropCapTextColor=this.lyricTextColor,this.annotationTextSize=13,this.annotationTextFont=this.lyricTextFont,this.annotationTextColor=this.lyricTextColor,this.glyphPunctumWidth=_Exsurge2.Glyphs.PunctumQuadratum.bounds.width,this.glyphPunctumHeight=_Exsurge2.Glyphs.PunctumQuadratum.bounds.height,this.glyphScaling=1/16,this.staffInterval=this.glyphPunctumWidth*this.glyphScaling,this.staffLineWeight=Math.round(this.glyphPunctumWidth*this.glyphScaling/8),this.neumeLineWeight=this.staffLineWeight,this.dividerLineWeight=this.neumeLineWeight,this.episemaLineWeight=this.neumeLineWeight,this.activeClef=null,this.neumeLineColor="#000",this.staffLineColor="#000",this.dividerLineColor="#000",this.defaultLanguage=new _Exsurge3.Latin,this.canvas=document.createElement("canvas"),this.canvasCtxt=this.canvas.getContext("2d");var dpr=window.devicePixelRatio||1,bsr=this.canvasCtxt.webkitBackingStorePixelRatio||this.canvasCtxt.mozBackingStorePixelRatio||this.canvasCtxt.msBackingStorePixelRatio||this.canvasCtxt.oBackingStorePixelRatio||this.canvasCtxt.backingStorePixelRatio||1;this.pixelRatio=dpr/bsr,this.canvasCtxt.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0),this.svgTextMeasurer=QuickSvg.svg(1,1),this.svgTextMeasurer.setAttribute("id","TextMeasurer"),document.querySelector("body").appendChild(this.svgTextMeasurer);var hyphen=new Lyric(this,"-",LyricType.SingleSyllable);this.hyphenWidth=hyphen.bounds.width,this.minLyricWordSpacing=this.hyphenWidth,this.intraNeumeSpacing=this.staffInterval/2,this.syllableConnector="-",this.drawGuides=!1,this.drawDebuggingBounds=!0,this.activeNotations=null,this.currNotationIndex=-1,this.condensingTolerance=.9,this.autoColor=!0,this.insertFontsInDoc()}return _createClass(ChantContext,[{key:"calculateHeightFromStaffPosition",value:function(staffPosition){return-staffPosition*this.staffInterval}},{key:"insertFontsInDoc",value:function(){var styleElement=document.getElementById("exsurge-fonts");null===styleElement&&(styleElement=document.createElement("style"),styleElement.id="exsurge-fonts",styleElement.appendChild(document.createTextNode("@font-face{font-family: 'Exsurge Characters';font-weight: normal;font-style: normal;src: url("+__exsurgeCharactersFont+") format('opentype');}")),document.head.appendChild(styleElement))}},{key:"findNextNeume",value:function(){if("undefined"==typeof this.currNotationIndex)throw"findNextNeume() called without a valid currNotationIndex set";for(var i=this.currNotationIndex+1;i<this.notations.length;i++){var notation=this.notations[i];if(notation.isNeume)return notation}return null}},{key:"setCanvasSize",value:function(width,height){this.canvas.width=width*this.pixelRatio,this.canvas.height=height*this.pixelRatio,this.canvas.style.width=width+"px",this.canvas.style.height=height+"px",this.canvasCtxt.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}}]),ChantContext}(),exports.ChantLayoutElement=function(){function ChantLayoutElement(){_classCallCheck(this,ChantLayoutElement),this.bounds=new _Exsurge.Rect,this.origin=new _Exsurge.Point(0,0),this.selected=!1,this.highlighted=!1}return _createClass(ChantLayoutElement,[{key:"draw",value:function(ctxt){}},{key:"createSvgFragment",value:function(ctxt){throw"ChantLayout Elements must implement createSvgFragment(ctxt)"}}]),ChantLayoutElement}()),GlyphVisualizer=(exports.DividerLineVisualizer=function(_ChantLayoutElement){function DividerLineVisualizer(ctxt,staffPosition0,staffPosition1){_classCallCheck(this,DividerLineVisualizer);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(DividerLineVisualizer).call(this)),y0=ctxt.calculateHeightFromStaffPosition(staffPosition0),y1=ctxt.calculateHeightFromStaffPosition(staffPosition1);if(y0>y1){var temp=y0;y0=y1,y1=temp}return _this.bounds.x=0,_this.bounds.y=y0,_this.bounds.width=ctxt.dividerLineWeight,_this.bounds.height=y1-y0,_this.origin.x=_this.bounds.width/2,_this.origin.y=y0,_this}return _inherits(DividerLineVisualizer,_ChantLayoutElement),_createClass(DividerLineVisualizer,[{key:"draw",value:function(ctxt){var canvasCtxt=ctxt.canvasCtxt;canvasCtxt.lineWidth=this.bounds.width,canvasCtxt.strokeStyle=ctxt.dividerLineColor,canvasCtxt.beginPath(),canvasCtxt.moveTo(this.bounds.x-this.origin.x,this.bounds.y),canvasCtxt.lineTo(this.bounds.x-this.origin.x,this.bounds.y+this.bounds.height),canvasCtxt.stroke()}},{key:"createSvgFragment",value:function(ctxt){return QuickSvg.createFragment("rect",{x:this.bounds.x,y:this.bounds.y,width:ctxt.dividerLineWeight,height:this.bounds.height,fill:ctxt.dividerLineColor,"class":"dividerLine"})}}]),DividerLineVisualizer}(ChantLayoutElement),exports.NeumeLineVisualizer=function(_ChantLayoutElement2){function NeumeLineVisualizer(ctxt,note0,note1,hanging){_classCallCheck(this,NeumeLineVisualizer);var _this2=_possibleConstructorReturn(this,Object.getPrototypeOf(NeumeLineVisualizer).call(this)),staffPosition0=note0.staffPosition,staffPosition1=note1.staffPosition;if(staffPosition0<staffPosition1){var temp=staffPosition0;staffPosition0=staffPosition1,staffPosition1=temp}var y0=ctxt.calculateHeightFromStaffPosition(staffPosition0),y1=0;return hanging&&(staffPosition0-staffPosition1===1&&Math.abs(staffPosition0)%2===1&&staffPosition1>-3&&staffPosition1--,y1+=ctxt.glyphPunctumHeight*ctxt.glyphScaling/2.2),y1+=ctxt.calculateHeightFromStaffPosition(staffPosition1),_this2.bounds.x=0,_this2.bounds.y=y0,_this2.bounds.width=ctxt.neumeLineWeight,_this2.bounds.height=y1-y0,_this2.origin.x=0,_this2.origin.y=0,_this2}return _inherits(NeumeLineVisualizer,_ChantLayoutElement2),_createClass(NeumeLineVisualizer,[{key:"draw",value:function(ctxt){var canvasCtxt=ctxt.canvasCtxt;canvasCtxt.lineWidth=this.bounds.width,canvasCtxt.strokeStyle=ctxt.neumeLineColor,canvasCtxt.beginPath();var x=this.bounds.x+this.bounds.width/2;canvasCtxt.moveTo(x,this.bounds.y),canvasCtxt.lineTo(x,this.bounds.y+this.bounds.height),canvasCtxt.stroke()}},{key:"createSvgFragment",value:function(ctxt){return QuickSvg.createFragment("rect",{x:this.bounds.x,y:this.bounds.y,width:ctxt.neumeLineWeight,height:this.bounds.height,fill:ctxt.neumeLineColor,"class":"neumeLine"})}}]),NeumeLineVisualizer}(ChantLayoutElement),exports.VirgaLineVisualizer=function(_ChantLayoutElement3){function VirgaLineVisualizer(ctxt,note){_classCallCheck(this,VirgaLineVisualizer);var y1,_this3=_possibleConstructorReturn(this,Object.getPrototypeOf(VirgaLineVisualizer).call(this)),staffPosition=note.staffPosition,y0=ctxt.calculateHeightFromStaffPosition(staffPosition);return y1=0===Math.abs(staffPosition%2)?y0+1.8*ctxt.staffInterval:y0+2.7*ctxt.staffInterval,_this3.bounds.x=0,_this3.bounds.y=y0,_this3.bounds.width=ctxt.neumeLineWeight,_this3.bounds.height=y1-y0,_this3.origin.x=0,_this3.origin.y=0,_this3}return _inherits(VirgaLineVisualizer,_ChantLayoutElement3),_createClass(VirgaLineVisualizer,[{key:"draw",value:function(ctxt){var canvasCtxt=ctxt.canvasCtxt;canvasCtxt.lineWidth=this.bounds.width,canvasCtxt.strokeStyle=ctxt.neumeLineColor,canvasCtxt.beginPath(),canvasCtxt.moveTo(this.bounds.x,this.bounds.y),canvasCtxt.lineTo(this.bounds.x,this.bounds.y+this.bounds.height),canvasCtxt.stroke()}},{key:"createSvgFragment",value:function(ctxt){return QuickSvg.createFragment("rect",{x:this.bounds.x,y:this.bounds.y,width:ctxt.neumeLineWeight,height:this.bounds.height,fill:ctxt.neumeLineColor,"class":"neumeLine"})}}]),VirgaLineVisualizer}(ChantLayoutElement),exports.GlyphVisualizer=function(_ChantLayoutElement4){function GlyphVisualizer(ctxt,glyphCode){_classCallCheck(this,GlyphVisualizer);var _this4=_possibleConstructorReturn(this,Object.getPrototypeOf(GlyphVisualizer).call(this));return _this4.glyph=null,_this4.setGlyph(ctxt,glyphCode),_this4}return _inherits(GlyphVisualizer,_ChantLayoutElement4),_createClass(GlyphVisualizer,[{key:"setGlyph",value:function(ctxt,glyphCode){if(this.glyphCode!==glyphCode){if("undefined"==typeof glyphCode||null===glyphCode||""===glyphCode?this.glyphCode=GlyphCode.None:this.glyphCode=glyphCode,this.glyph=_Exsurge2.Glyphs[this.glyphCode],!ctxt.defs.hasOwnProperty(this.glyphCode)){var glyphSrc=this.glyph.svgSrc;ctxt.defs[this.glyphCode]=QuickSvg.createFragment("g",{id:this.glyphCode,"class":"glyph",transform:"scale("+ctxt.glyphScaling+")"},glyphSrc)}this.align=this.glyph.align,this.origin.x=this.glyph.origin.x*ctxt.glyphScaling,this.origin.y=this.glyph.origin.y*ctxt.glyphScaling,this.bounds.x=0,this.bounds.y=-this.origin.y,this.bounds.width=this.glyph.bounds.width*ctxt.glyphScaling,this.bounds.height=this.glyph.bounds.height*ctxt.glyphScaling}}},{key:"setStaffPosition",value:function(ctxt,staffPosition){this.bounds.y+=ctxt.calculateHeightFromStaffPosition(staffPosition)}},{key:"draw",value:function(ctxt){var canvasCtxt=ctxt.canvasCtxt,x=this.bounds.x+this.origin.x,y=this.bounds.y+this.origin.y;canvasCtxt.translate(x,y),canvasCtxt.scale(ctxt.glyphScaling,ctxt.glyphScaling);for(var i=0;i<this.glyph.paths.length;i++){var path=this.glyph.paths[i];canvasCtxt.fillStyle=ctxt.neumeLineColor,
canvasCtxt.fill(new Path2D(path.data))}canvasCtxt.scale(1/ctxt.glyphScaling,1/ctxt.glyphScaling),canvasCtxt.translate(-x,-y)}},{key:"createSvgFragment",value:function(ctxt){return QuickSvg.createFragment("use",{"xlink:href":"#"+this.glyphCode,x:this.bounds.x+this.origin.x,y:this.bounds.y+this.origin.y})}}]),GlyphVisualizer}(ChantLayoutElement)),TextSpan=(exports.RoundBraceVisualizer=function(_ChantLayoutElement5){function RoundBraceVisualizer(ctxt,x1,x2,y,isAbove){_classCallCheck(this,RoundBraceVisualizer);var _this5=_possibleConstructorReturn(this,Object.getPrototypeOf(RoundBraceVisualizer).call(this));if(x1>x2){var temp=x1;x1=x2,x2=temp}return _this5.isAbove=isAbove,_this5.braceHeight=ctxt.staffInterval/2,_this5.bounds=new _Exsurge.Rect(x1,y,x2-x1,_this5.braceHeight),_this5.origin.x=0,_this5.origin.y=0,_this5}return _inherits(RoundBraceVisualizer,_ChantLayoutElement5),_createClass(RoundBraceVisualizer,[{key:"createSvgFragment",value:function(ctxt){var fragment=QuickSvg.createFragment("path",{d:this.generatePathString(),stroke:ctxt.neumeLineColor,"stroke-width":ctxt.staffLineWeight+"px",fill:"none","class":"brace"});return this.acuteAccent?(fragment+=this.acuteAccent.createSvgFragment(ctxt),QuickSvg.createFragment("g",{"class":"accentedBrace"},fragment)):fragment}},{key:"generatePathString",value:function(){var y,dx,dy,x1=this.bounds.x,x2=this.bounds.right(),width=this.bounds.width;this.isAbove?(y=this.bounds.bottom(),dx=width/6,dy=-width/6):(y=this.bounds.y,dx=width/6,dy=width/6);var cx1=x1+dx,cy=y+dy,cx2=x2-dx,dp=2;return"M "+x1.toFixed(dp)+" "+y.toFixed(dp)+" C "+cx1.toFixed(dp)+" "+cy.toFixed(dp)+" "+cx2.toFixed(dp)+" "+cy.toFixed(dp)+" "+x2.toFixed(dp)+" "+y.toFixed(dp)}}]),RoundBraceVisualizer}(ChantLayoutElement),exports.CurlyBraceVisualizer=function(_ChantLayoutElement6){function CurlyBraceVisualizer(ctxt,x1,x2,y){var isAbove=arguments.length<=4||void 0===arguments[4]||arguments[4],addAcuteAccent=!(arguments.length<=5||void 0===arguments[5])&&arguments[5];_classCallCheck(this,CurlyBraceVisualizer);var _this6=_possibleConstructorReturn(this,Object.getPrototypeOf(CurlyBraceVisualizer).call(this));if(x1>x2){var temp=x1;x1=x2,x2=temp}_this6.isAbove=isAbove,_this6.braceHeight=ctxt.staffInterval/2,isAbove&&(y-=_this6.braceHeight);var bounds=new _Exsurge.Rect(x1,y,x2-x1,_this6.braceHeight);return addAcuteAccent&&isAbove&&(_this6.acuteAccent=new GlyphVisualizer(ctxt,GlyphCode.AcuteAccent),_this6.acuteAccent.bounds.x+=bounds.x+(x2-x1)/2,_this6.acuteAccent.bounds.y+=bounds.y-ctxt.staffInterval/4,bounds.union(_this6.acuteAccent.bounds)),_this6.bounds=bounds,_this6.origin.x=0,_this6.origin.y=0,_this6}return _inherits(CurlyBraceVisualizer,_ChantLayoutElement6),_createClass(CurlyBraceVisualizer,[{key:"createSvgFragment",value:function(ctxt){var fragment=QuickSvg.createFragment("path",{d:this.generatePathString(),stroke:ctxt.neumeLineColor,"stroke-width":ctxt.staffLineWeight+"px",fill:"none","class":"brace"});return this.acuteAccent?(fragment+=this.acuteAccent.createSvgFragment(ctxt),QuickSvg.createFragment("g",{"class":"accentedBrace"},fragment)):fragment}},{key:"generatePathString",value:function(){var y,h,q=.6,x1=this.bounds.x,x2=this.bounds.right(),width=this.bounds.width;this.isAbove?(y=this.bounds.bottom(),h=-this.braceHeight):(y=this.bounds.y,h=this.braceHeight);var qy1=y+q*h,qx2=x1+.25*width,qy2=y+(1-q)*h,tx1=x1+.5*width,ty1=y+h,qy3=y+q*h,qx4=x1+.75*width,qy4=y+(1-q)*h,dp=2;return"M "+x1.toFixed(dp)+" "+y.toFixed(dp)+" Q "+x1.toFixed(dp)+" "+qy1.toFixed(dp)+" "+qx2.toFixed(dp)+" "+qy2.toFixed(dp)+" T "+tx1.toFixed(dp)+" "+ty1.toFixed(dp)+" M "+x2.toFixed(dp)+" "+y.toFixed(dp)+" Q "+x2.toFixed(dp)+" "+qy3.toFixed(dp)+" "+qx4.toFixed(dp)+" "+qy4.toFixed(dp)+" T "+tx1.toFixed(dp)+" "+ty1.toFixed(dp)}}]),CurlyBraceVisualizer}(ChantLayoutElement),function(text,properties){"undefined"!=typeof properties&&null!==properties||(properties=""),this.text=text,this.properties=properties}),boldMarkup="*",italicMarkup="_",redMarkup="^",smallCapsMarkup="%";MarkupStackFrame.createStackFrame=function(symbol,startIndex){var properties="";switch(symbol){case boldMarkup:properties="font-weight:bold;";break;case italicMarkup:properties="font-style:italic;";break;case redMarkup:properties="fill:#f00;";break;case smallCapsMarkup:properties="font-variant:small-caps;font-feature-settings:'smcp';-webkit-font-feature-settings:'smcp';"}return new MarkupStackFrame(symbol,startIndex,properties)};var __subsForTspans={"&":"&amp;","<":"&lt;",">":"&gt;"},TextElement=exports.TextElement=function(_ChantLayoutElement7){function TextElement(ctxt,text,fontFamily,fontSize,textAnchor){_classCallCheck(this,TextElement);var _this7=_possibleConstructorReturn(this,Object.getPrototypeOf(TextElement).call(this));return _this7.bounds.x=0,_this7.bounds.y=0,_this7.bounds.width=0,_this7.bounds.height=0,_this7.origin.x=0,_this7.origin.y=0,_this7.fontFamily=fontFamily,_this7.fontSize=fontSize,_this7.textAnchor=textAnchor,_this7.dominantBaseline="baseline",_this7.generateSpansFromText(ctxt,text),_this7.recalculateMetrics(ctxt),_this7}return _inherits(TextElement,_ChantLayoutElement7),_createClass(TextElement,[{key:"generateSpansFromText",value:function(ctxt,text){if(this.text="",this.spans=[],"*"===text||"†"===text)return void this.spans.push(new TextSpan(text));for(var markupStack=[],spanStartIndex=0,filterFrames=function(frame,symbol){return frame.Symbol===symbol},that=this,closeSpan=function(spanText,extraProperties){if(""!==spanText){that.text+=spanText;for(var properties="",i=0;i<markupStack.length;i++)properties+=markupStack[i].properties;extraProperties&&(properties+=extraProperties),that.spans.push(new TextSpan(spanText,properties))}},markupRegex=/(\*|_|\^|%|[ARVarv]\/\.)/g,match=null;match=markupRegex.exec(text);){var markupSymbol=match[0];if("A/."===markupSymbol||"R/."===markupSymbol||"V/."===markupSymbol||"a/."===markupSymbol||"r/."===markupSymbol||"v/."===markupSymbol)closeSpan(text[match.index]+".","font-family:'Exsurge Characters';fill:#f00;");else if(0===markupStack.length)closeSpan(text.substring(spanStartIndex,match.index)),markupStack.push(MarkupStackFrame.createStackFrame(markupSymbol,match.index));else if(markupStack[markupStack.length-1].symbol===markupSymbol)closeSpan(text.substring(spanStartIndex,match.index)),markupStack.pop();else{if(markupStack.filter(filterFrames).length>0){spanStartIndex=markupStack[markupStack.length-1].startIndex,markupStack.pop();continue}closeSpan(text.substring(spanStartIndex,match.index)),markupStack.push(MarkupStackFrame.createStackFrame(markupSymbol,match.index))}spanStartIndex=match.index+markupSymbol.length}spanStartIndex<text.length&&closeSpan(text.substring(spanStartIndex,text.length)),0===this.spans.length&&closeSpan(text)}},{key:"recalculateMetrics",value:function(ctxt){this.bounds.x=0,this.bounds.y=0;for(var xml='<svg xmlns="http://www.w3.org/2000/svg">'+this.createSvgFragment(ctxt)+"</svg>",doc=(new DOMParser).parseFromString(xml,"application/xml");ctxt.svgTextMeasurer.firstChild;)ctxt.svgTextMeasurer.firstChild.remove();ctxt.svgTextMeasurer.appendChild(ctxt.svgTextMeasurer.ownerDocument.importNode(doc.documentElement,!0).firstChild);var bbox=ctxt.svgTextMeasurer.firstChild.getBBox();this.bounds.x=0,this.bounds.y=0,this.bounds.width=bbox.width,this.bounds.height=bbox.height,this.origin.x=0,this.origin.y=-bbox.y}},{key:"getCssClasses",value:function(){return""}},{key:"getExtraStyleProperties",value:function(ctxt){return""}},{key:"draw",value:function(ctxt){var canvasCtxt=ctxt.canvasCtxt;"middle"===this.textAnchor?canvasCtxt.textAlign="center":canvasCtxt.textAlign="start",canvasCtxt.font=this.fontSize+"px "+this.fontFamily;for(var i=0;i<this.spans.length;i++)canvasCtxt.fillText(this.spans[i].text,this.bounds.x,this.bounds.y)}},{key:"createSvgFragment",value:function(ctxt){for(var spans="",i=0;i<this.spans.length;i++){var options={};this.spans[i].properties&&(options.style=this.spans[i].properties),spans+=QuickSvg.createFragment("tspan",options,TextElement.escapeForTspan(this.spans[i].text))}var styleProperties="font-family:"+this.fontFamily+";font-size:"+this.fontSize+"px;font-kerning:normal;"+this.getExtraStyleProperties(ctxt);return QuickSvg.createFragment("text",{x:this.bounds.x,y:this.bounds.y,"class":this.getCssClasses().trim(),"text-anchor":this.textAnchor,"dominant-baseline":this.dominantBaseline,dy:this.dy||"",style:styleProperties},spans)}}],[{key:"escapeForTspan",value:function(string){return String(string).replace(/[&<>]/g,function(s){return __subsForTspans[s]})}}]),TextElement}(ChantLayoutElement),LyricType=exports.LyricType={SingleSyllable:0,BeginningSyllable:1,MiddleSyllable:2,EndingSyllable:3,Directive:4},Lyric=exports.Lyric=function(_TextElement){function Lyric(ctxt,text,lyricType){_classCallCheck(this,Lyric);var _this8=_possibleConstructorReturn(this,Object.getPrototypeOf(Lyric).call(this,ctxt,text,ctxt.lyricTextFont,ctxt.lyricTextSize,"start"));return _this8.originalText=text,"undefined"==typeof lyricType||null===lyricType||""===lyricType?_this8.lyricType=LyricType.SingleSyllable:_this8.lyricType=lyricType,_this8.centerStartIndex=-1,_this8.centerLength=text.length,_this8.needsConnector=!1,_this8.language=null,_this8}return _inherits(Lyric,_TextElement),_createClass(Lyric,[{key:"allowsConnector",value:function(){return this.lyricType===LyricType.BeginningSyllable||this.lyricType===LyricType.MiddleSyllable}},{key:"setNeedsConnector",value:function(needs){needs===!0?(this.needsConnector=!0,this.bounds.width=this.widthWithConnector,this.spans.length>0&&(this.spans[this.spans.length-1].text=this.lastSpanTextWithConnector)):(this.needsConnector=!1,this.bounds.width=this.widthWithoutConnector,this.spans.length>0&&(this.spans[this.spans.length-1].text=this.lastSpanText))}},{key:"generateSpansFromText",value:function(ctxt,text){_get(Object.getPrototypeOf(Lyric.prototype),"generateSpansFromText",this).call(this,ctxt,text),this.spans.length>0?(this.lastSpanText=this.spans[this.spans.length-1].text,this.lastSpanTextWithConnector=this.lastSpanText+ctxt.syllableConnector):(this.lastSpanText="",this.lastSpanTextWithConnector="")}},{key:"recalculateMetrics",value:function(ctxt){_get(Object.getPrototypeOf(Lyric.prototype),"recalculateMetrics",this).call(this,ctxt),this.widthWithoutConnector=this.bounds.width,this.textWithConnector=this.text+ctxt.syllableConnector,this.widthWithConnector=this.bounds.width+ctxt.hyphenWidth;var x1,x2,activeLanguage=this.language||ctxt.defaultLanguage,offset=this.widthWithoutConnector/2;if(this.centerStartIndex>=0&&(this.centerStartIndex>=this.text.length||this.centerLength<0||this.centerStartIndex+this.centerLength>this.text.length)&&(this.centerStartIndex=-1),0===this.text.length);else if(this.centerStartIndex>=0)x1=ctxt.svgTextMeasurer.firstChild.getSubStringLength(0,this.centerStartIndex),x2=ctxt.svgTextMeasurer.firstChild.getSubStringLength(0,this.centerStartIndex+this.centerLength),offset=x1+(x2-x1)/2;else if(this.lyricType!==LyricType.Directive){var result=activeLanguage.findVowelSegment(this.text,0);result.found===!0&&(x1=ctxt.svgTextMeasurer.firstChild.getSubStringLength(0,result.startIndex),x2=ctxt.svgTextMeasurer.firstChild.getSubStringLength(0,result.startIndex+result.length),offset=x1+(x2-x1)/2)}this.bounds.x=-offset,this.bounds.y=0,this.origin.x=offset,this.bounds.width=this.widthWithoutConnector,this.bounds.height=ctxt.lyricTextSize}},{key:"generateDropCap",value:function(ctxt){var dropCap=new DropCap(ctxt,this.originalText.substring(0,1));return 1===this.originalText.length?(this.generateSpansFromText(ctxt,ctxt.syllableConnector),this.centerStartIndex=-1,this.lyricType=LyricType.SingleSyllable):(this.generateSpansFromText(ctxt,this.originalText.substring(1)),this.centerStartIndex--),dropCap}},{key:"getCssClasses",value:function(){var classes="lyric ";return this.lyricType===LyricType.Directive&&(classes+="directive "),classes+_get(Object.getPrototypeOf(Lyric.prototype),"getCssClasses",this).call(this)}},{key:"getExtraStyleProperties",value:function(ctxt){var props=_get(Object.getPrototypeOf(Lyric.prototype),"getExtraStyleProperties",this).call(this);return this.lyricType===LyricType.Directive&&ctxt.autoColor===!0&&(props+="fill:#f00;"),props}},{key:"createSvgFragment",value:function(ctxt){return this.spans.length>0&&(this.needsConnector?this.spans[this.spans.length-1].text=this.lastSpanTextWithConnector:this.spans[this.spans.length-1].text=this.lastSpanText),_get(Object.getPrototypeOf(Lyric.prototype),"createSvgFragment",this).call(this,ctxt)}}]),Lyric}(TextElement),DropCap=exports.DropCap=function(_TextElement2){function DropCap(ctxt,text){_classCallCheck(this,DropCap);var _this9=_possibleConstructorReturn(this,Object.getPrototypeOf(DropCap).call(this,ctxt,text,ctxt.dropCapTextFont,ctxt.dropCapTextSize,"middle"));return _this9.padding=2*ctxt.staffInterval,_this9}return _inherits(DropCap,_TextElement2),_createClass(DropCap,[{key:"getCssClasses",value:function(){return"dropCap "+_get(Object.getPrototypeOf(DropCap.prototype),"getCssClasses",this).call(this)}}]),DropCap}(TextElement);exports.Annotation=function(_TextElement3){function Annotation(ctxt,text){_classCallCheck(this,Annotation);var _this10=_possibleConstructorReturn(this,Object.getPrototypeOf(Annotation).call(this,ctxt,text,ctxt.annotationTextFont,ctxt.annotationTextSize,"middle"));return _this10.padding=ctxt.staffInterval,_this10.dy="1.5ex",_this10}return _inherits(Annotation,_TextElement3),_createClass(Annotation,[{key:"getCssClasses",value:function(){return"annotation "+_get(Object.getPrototypeOf(Annotation.prototype),"getCssClasses",this).call(this)}}]),Annotation}(TextElement),exports.ChantNotationElement=function(_ChantLayoutElement8){function ChantNotationElement(){_classCallCheck(this,ChantNotationElement);var _this11=_possibleConstructorReturn(this,Object.getPrototypeOf(ChantNotationElement).call(this));return _this11.leadingSpace=0,_this11.trailingSpace=-1,_this11.keepWithNext=!1,_this11.needsLayout=!0,_this11.lyrics=[],_this11.score=null,_this11.line=null,_this11.visualizers=[],_this11}return _inherits(ChantNotationElement,_ChantLayoutElement8),_createClass(ChantNotationElement,[{key:"hasLyrics",value:function(){return 0!==this.lyrics.length}},{key:"getLyricLeft",value:function(index){return this.bounds.x+this.lyrics[index].bounds.x}},{key:"getAllLyricsLeft",value:function(){if(0===this.lyrics.length)return this.bounds.right();for(var x=Number.MAX_VALUE,i=0;i<this.lyrics.length;i++)this.lyrics[i]&&(x=Math.min(x,this.lyrics[i].bounds.x));return this.bounds.x+x}},{key:"getLyricRight",value:function(index){return this.bounds.x+this.lyrics[index].bounds.x+this.lyrics[index].bounds.width}},{key:"getAllLyricsRight",value:function(){if(0===this.lyrics.length)return this.bounds.x;for(var x=Number.MIN_VALUE,i=0;i<this.lyrics.length;i++)this.lyrics[i]&&(x=Math.max(x,this.lyrics[i].bounds.x+this.lyrics[i].bounds.width));return this.bounds.x+x}},{key:"addVisualizer",value:function(chantLayoutElement){this.bounds.isEmpty()?this.bounds=chantLayoutElement.bounds.clone():this.bounds.union(chantLayoutElement.bounds),this.visualizers.push(chantLayoutElement)}},{key:"prependVisualizer",value:function(chantLayoutElement){this.bounds.isEmpty()?this.bounds=chantLayoutElement.bounds.clone():this.bounds.union(chantLayoutElement.bounds),this.visualizers.unshift(chantLayoutElement)}},{key:"performLayout",value:function(ctxt){this.trailingSpace<0&&(this.trailingSpace=4*ctxt.intraNeumeSpacing),this.visualizers=[],this.bounds=new _Exsurge.Rect(1/0,1/0,(-(1/0)),(-(1/0)));for(var i=0;i<this.lyrics.length;i++)this.lyrics[i].recalculateMetrics(ctxt)}},{key:"resetDependencies",value:function(){}},{key:"finishLayout",value:function(ctxt){this.bounds.x=0;for(var i=0;i<this.lyrics.length;i++)this.lyrics[i].bounds.x=this.origin.x-this.lyrics[i].origin.x;this.needsLayout=!1}},{key:"draw",value:function(ctxt){var canvasCtxt=ctxt.canvasCtxt;canvasCtxt.translate(this.bounds.x,0);for(var i=0;i<this.visualizers.length;i++)this.visualizers[i].draw(ctxt);for(i=0;i<this.lyrics.length;i++)this.lyrics[i].draw(ctxt);canvasCtxt.translate(-this.bounds.x,0)}},{key:"createSvgFragment",value:function(ctxt){for(var inner="",i=0;i<this.visualizers.length;i++)inner+=this.visualizers[i].createSvgFragment(ctxt);for(i=0;i<this.lyrics.length;i++)inner+=this.lyrics[i].createSvgFragment(ctxt);return QuickSvg.createFragment("g",{"class":"ChantNotationElement "+this.constructor.name,transform:"translate("+this.bounds.x+",0)"},inner)}}]),ChantNotationElement}(ChantLayoutElement)},function(module,exports){module.exports="data:font/opentype;base64,AAEAAAATAQAABAAwRFNJRwAAAAEAAENkAAAACEdERUYAbgADAABDbAAAABhHUE9TTxtiswAAQ4QAAAE8R1NVQjtgWB4AAETAAAAAlk9TLzJKLTibAAABuAAAAGBjbWFwCRIK1gAAA4gAAAEEY3Z0IAGGB0cAAAZ0AAAAGmZwZ20GWZw3AAAEjAAAAXNnYXNwABcACAAAQ1QAAAAQZ2x5ZhRQNO4AAAdQAAAEzGhlYWQKMl2QAAABPAAAADZoaGVhDC0CmQAAAXQAAAAkaG10eB67AO4AAAIYAAABbmtlcm4E1wS9AAAMHAAAAMZsb2NhLQ4u0gAABpAAAADAbWF4cAJtAJoAAAGYAAAAIG5hbWUmgJC3AAAM5AAANY5wb3N0CJUJxAAAQnQAAADgcHJlcNTHuIYAAAYAAAAAcgABAAAAAQAArr24P18PPPUAGwgAAAAAANLrfC8AAAAA0uuXUgAA/vAFLAYhAAAACQACAAAAAAAAAAEAAAb+/bwAAAUzAAD/UQUsAAEAAAAAAAAAAAAAAAAAAABYAAEAAABfAE4AAwAAAAAAAQAAAAAACgAAAgAASwAAAAAAAwNBAZAABQAAA1gDWAAABLADWANYAAAEsABkAfQAAAIABQMGAAACAAQAAAABAAAAAAAAAAAAAAAAICAgIABAACEAfgb+/bwAAAb+AkQAAAABAAAAAAOiBOwAAAAgAAIDMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAHVAIMDMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAAEwwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAR9ACkDMwAAAzMAAAMzAAAFMwAUAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAO6AAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAAzMAAAMzAAADMwAAA4kAHwMzAAADMwAAAzMAAAQNAA8DMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAHAABAAAAAAA8AAMAAQAAABwABAAgAAAABAAEAAEAAAB+//8AAAAg////4AABAAAAAAAGAMgAAAAgAF8AAAABAAIAAwAEAAUABgAHAAgACQAKAAsADAANAA4ADwAQABEAEgATABQAFQAWABcAGAAZABoAGwAcAB0AHgAfACAAIQAiACMAJAAlACYAJwAoACkAKgArACwALQAuAC8AMAAxADIAMwA0ADUANgA3ADgAOQA6ADsAPAA9AD4APwBAAEEAQgBDAEQARQBGAEcASABJAEoASwBMAE0ATgBPAFAAUQBSAFMAVABVAFYAVwBYAFkAWgBbAFwAXQBeuAAALEu4AAlQWLEBAY5ZuAH/hbgARB25AAkAA19eLbgAASwgIEVpRLABYC24AAIsuAABKiEtuAADLCBGsAMlRlJYI1kgiiCKSWSKIEYgaGFksAQlRiBoYWRSWCNlilkvILAAU1hpILAAVFghsEBZG2kgsABUWCGwQGVZWTotuAAELCBGsAQlRlJYI4pZIEYgamFksAQlRiBqYWRSWCOKWS/9LbgABSxLILADJlBYUViwgEQbsEBEWRshISBFsMBQWLDARBshWVktuAAGLCAgRWlEsAFgICBFfWkYRLABYC24AAcsuAAGKi24AAgsSyCwAyZTWLBAG7AAWYqKILADJlNYIyGwgIqKG4ojWSCwAyZTWCMhuADAioobiiNZILADJlNYIyG4AQCKihuKI1kgsAMmU1gjIbgBQIqKG4ojWSC4AAMmU1iwAyVFuAGAUFgjIbgBgCMhG7ADJUUjISMhWRshWUQtuAAJLEtTWEVEGyEhWS0AuAAAKwC6AAEAAgACKwG6AAMAAgACKwG/AAMATAA8AC8AIgAUAAAACCu/AAQARwA8AC8AIgAUAAAACCsAvwABAIAAZgBQADkAIgAAAAgrvwACAHgAZgBQADkAIgAAAAgrALoABQAEAAcruAAAIEV9aRhEAAAAKgArAFAAbgCCAAAAHv4gABQDogAeBOwAOQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEIAQgBCAEIAQgBCAEIAQgBCAEIAQgBCAEIAQgBCAEIAQgBCAEIAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAQwBDAEMAQwBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAagBqAGoAagBqAGoAagBqAGoAagBqAGoAagBqAGoAagBqAIcAhwCHAIcAmYCZgJmAmYCZgJmAmYCZgJmAAEAg//YAXEA7AAPAEu7AAAABAAIAAQrQRMABgAAABYAAAAmAAAANgAAAEYAAABWAAAAZgAAAHYAAACGAAAACV1BBQCVAAAApQAAAAJdALoADQAFAAMrMDElFA4CIyImNTQ+AjMyFgFxFSUzHTYuFiYzHDIxeyM7LBk6NiI7LRo7AAAAAAMAAP72BK4GIQACAB4ALAAAAQsBBwMGFhcVITU+ATcBPgE3AR4DFxUhNT4BJwMCFjcGJjcBLgEHNhYDAQL2sKsebwpKUv5gRFAKAXQXRBoBpAUSHi4g/lpOPAtyoi1ecrRIAdcBRVR70VX+OQIXAgL9/lr+sh8cCSsrDBoeBGYZKQ77Sg4WEAwEKysFHiEBTv3MDQSKE+8FHkMMCsZJ/vn7AwAAAwAp/vAFLAYbADEAPwBNAAAzNT4BNREOAQcnPgMzMh4CFRQOAgcBHgM3Fw4BIyImJwEGKwEiJicRFBYXFQMiBxEeATMyNjU0LgISFjcGJjcBLgEHNhYDATJETSNJJQkvYGhzQnSscjgpS2g+AS8PIys1IgtCdycdNw7+0Q0NGxo0HEhJRCYnGygWnqonU4HtLV5ytEgB1wFFVHvRVf45Kw4hDgQ9BQsFPgwVEQouUm9ASHVaQBP+GhYaDQEDKxYdIBcCMQIFBv4FDCMOKwS2A/4ABQKLhTdcQiX6zQ0EihPvBR5DDArGSf75+wMAAAAAAgAU/vYFCgYhABoAKAAAAQ4BBwEOAwcBLgEnNSEVDgEXCQE2Jic1IQAWNwYmNwEuAQc2FgMBBQpETQr+gQgnLiwN/kgKRT8Bs1A7CwFhAVALR1IBoPxdLV5ytEgB1wFFVHvRVf45BMENGRz7vBYfFQwDBJ0aIAgrKwYdHfxKA7QdGwor+p0NBIoT7wUeQwwKxkn++fsDAAADAAD/LwOrBOUAAgAeACwAAAELAQ8BBhYXFSE1PgE3AT4BNwEeAxcVITU+AS8BAhY3BiY3ATQmBzYWBwECNGtpHlAFKEv+oEAxBgEXFTYtAUIDCxAeJ/6bRx8GU3oOZGuBOQFhIV1xlUL+qgG5AUf+uV76ERAJNzYMEREDcBciGfw+CQ4JCAU3OAUQFPr+WwUFhxPFA/0rBgy8RNX8HAAAAwAf/y8D6wTlADEAPwBNAAAzNT4BNREiBgcnPgMzMh4CFRQOAgcTHgM3Fw4BIyImJwM2KwEiJhcRFBYXFQMiBxEeATMyNjU0LgISFjcGJjcBNCYHNhYHASc+LgI3MQoxSk9ZM1uIXCwfO1Mi3goVGCIsDT9eIR0zDN4GDBQVKgMrQkcbCwQbEG11HDhYqw5ka4E5AWEhXXGVQv6qNg0VBQM/CQdHDRENCCZFWjM5Xkk1C/6ODxEHAQQ1FhgfFQGqAQQB/oYEFg02A60B/oQBAWNlKkQuG/wJBQWHE8UD/SsGDLxE1fwcAAIAD/8vA/AE5QAaACgAAAEOAQcBDgMHAS4BJzUhFQ4BFxsBNiYnNSEAFjcGJjcBNCYHNhYHAQPwQDAF/uEHIickH/6xBio7AW5IHgb16AYmSgFg/TIOZGuBOQFhIV1xlUL+qgO5DRAQ/KwTHRIKCAOoEBQINzgGDxH9UwKrEA8KN/vHBQWHE8UD/SsGDLxE1fwcAAAAAAEAAADCAAEAHgBgAAQAVAAhAA7/nAAhACEANgAhADIADQAhADb/8gAhAEEANgAhAFIAFwAhAFb/pQAyAA7/nAAyACEAWAAyADIAoQAyADYAvQAyAEEAWAAyAFIATwAyAFYAaQA2AA7+cAA2ACH+kwA2ADL/+QA2ADYADgA2AEH+kwA2AFL/YQA2AFb/fABBAA7/nABBAFIAFwBBAFb/1QBSAA7/nABSAFIANgBSAFYATABWAA7+cABWAFIACQBWAFYAGQAAAAAAFAD2AAEAAAAAAAAALgAAAAEAAAAAAAEAEgA1AAEAAAAAAAIABwAuAAEAAAAAAAMAHwA1AAEAAAAAAAQAEgA1AAEAAAAAAAUALwBUAAEAAAAAAAYAEQCDAAEAAAAAAA0Q9ACUAAEAAAAAAA4AGgEkAAEAAAAAABIAEgA1AAMAAQQJAAAAXBGIAAMAAQQJAAEAJBHyAAMAAQQJAAIADhHkAAMAAQQJAAMAPhHyAAMAAQQJAAQAJBHyAAMAAQQJAAUAXhIwAAMAAQQJAAYAIhKOAAMAAQQJAA0h6BKwAAMAAQQJAA4ANBPQAAMAAQQJABIAJBHyQ29weXJpZ2h0IChjKSAyMDE2IEZyLiBNYXR0aGV3IFNwZW5jZXIsIE8uUy5KLlJlZ3VsYXJFeHN1cmdlIENoYXJhY3RlcnM6VmVyc2lvbiAxLjAwVmVyc2lvbiAxLjAwIEZlYnJ1YXJ5IDE4LCAyMDE2LCBpbml0aWFsIHJlbGVhc2VFeHN1cmdlQ2hhcmFjdGVyc1RoaXMgRm9udCBTb2Z0d2FyZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgU0lMIE9wZW4gRm9udCBMaWNlbnNlLCBWZXJzaW9uIDEuMS4gVGhpcyBsaWNlbnNlIGlzIGNvcGllZCBiZWxvdywgYW5kIGlzIGFsc28gYXZhaWxhYmxlIHdpdGggYSBGQVEgYXQ6IGh0dHA6Ly9zY3JpcHRzLnNpbC5vcmcvT0ZMDQoNCg0KLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0NClNJTCBPUEVOIEZPTlQgTElDRU5TRSBWZXJzaW9uIDEuMSAtIDI2IEZlYnJ1YXJ5IDIwMDcNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNClBSRUFNQkxFDQpUaGUgZ29hbHMgb2YgdGhlIE9wZW4gRm9udCBMaWNlbnNlIChPRkwpIGFyZSB0byBzdGltdWxhdGUgd29ybGR3aWRlIGRldmVsb3BtZW50IG9mIGNvbGxhYm9yYXRpdmUgZm9udCBwcm9qZWN0cywgdG8gc3VwcG9ydCB0aGUgZm9udCBjcmVhdGlvbiBlZmZvcnRzIG9mIGFjYWRlbWljIGFuZCBsaW5ndWlzdGljIGNvbW11bml0aWVzLCBhbmQgdG8gcHJvdmlkZSBhIGZyZWUgYW5kIG9wZW4gZnJhbWV3b3JrIGluIHdoaWNoIGZvbnRzIG1heSBiZSBzaGFyZWQgYW5kIGltcHJvdmVkIGluIHBhcnRuZXJzaGlwIHdpdGggb3RoZXJzLg0KDQpUaGUgT0ZMIGFsbG93cyB0aGUgbGljZW5zZWQgZm9udHMgdG8gYmUgdXNlZCwgc3R1ZGllZCwgbW9kaWZpZWQgYW5kIHJlZGlzdHJpYnV0ZWQgZnJlZWx5IGFzIGxvbmcgYXMgdGhleSBhcmUgbm90IHNvbGQgYnkgdGhlbXNlbHZlcy4gVGhlIGZvbnRzLCBpbmNsdWRpbmcgYW55IGRlcml2YXRpdmUgd29ya3MsIGNhbiBiZSBidW5kbGVkLCBlbWJlZGRlZCwgcmVkaXN0cmlidXRlZCBhbmQvb3Igc29sZCB3aXRoIGFueSBzb2Z0d2FyZSBwcm92aWRlZCB0aGF0IGFueSByZXNlcnZlZCBuYW1lcyBhcmUgbm90IHVzZWQgYnkgZGVyaXZhdGl2ZSB3b3Jrcy4gVGhlIGZvbnRzIGFuZCBkZXJpdmF0aXZlcywgaG93ZXZlciwgY2Fubm90IGJlIHJlbGVhc2VkIHVuZGVyIGFueSBvdGhlciB0eXBlIG9mIGxpY2Vuc2UuIFRoZSByZXF1aXJlbWVudCBmb3IgZm9udHMgdG8gcmVtYWluIHVuZGVyIHRoaXMgbGljZW5zZSBkb2VzIG5vdCBhcHBseSB0byBhbnkgZG9jdW1lbnQgY3JlYXRlZCB1c2luZyB0aGUgZm9udHMgb3IgdGhlaXIgZGVyaXZhdGl2ZXMuDQoNCkRFRklOSVRJT05TDQoiRm9udCBTb2Z0d2FyZSIgcmVmZXJzIHRvIHRoZSBzZXQgb2YgZmlsZXMgcmVsZWFzZWQgYnkgdGhlIENvcHlyaWdodCBIb2xkZXIocykgdW5kZXIgdGhpcyBsaWNlbnNlIGFuZCBjbGVhcmx5IG1hcmtlZCBhcyBzdWNoLiBUaGlzIG1heSBpbmNsdWRlIHNvdXJjZSBmaWxlcywgYnVpbGQgc2NyaXB0cyBhbmQgZG9jdW1lbnRhdGlvbi4NCg0KIlJlc2VydmVkIEZvbnQgTmFtZSIgcmVmZXJzIHRvIGFueSBuYW1lcyBzcGVjaWZpZWQgYXMgc3VjaCBhZnRlciB0aGUgY29weXJpZ2h0IHN0YXRlbWVudChzKS4NCg0KIk9yaWdpbmFsIFZlcnNpb24iIHJlZmVycyB0byB0aGUgY29sbGVjdGlvbiBvZiBGb250IFNvZnR3YXJlIGNvbXBvbmVudHMgYXMgZGlzdHJpYnV0ZWQgYnkgdGhlIENvcHlyaWdodCBIb2xkZXIocykuDQoNCiJNb2RpZmllZCBWZXJzaW9uIiByZWZlcnMgdG8gYW55IGRlcml2YXRpdmUgbWFkZSBieSBhZGRpbmcgdG8sIGRlbGV0aW5nLCBvciBzdWJzdGl0dXRpbmcgLS0gaW4gcGFydCBvciBpbiB3aG9sZSAtLSBhbnkgb2YgdGhlIGNvbXBvbmVudHMgb2YgdGhlIE9yaWdpbmFsIFZlcnNpb24sIGJ5IGNoYW5naW5nIGZvcm1hdHMgb3IgYnkgcG9ydGluZyB0aGUgRm9udCBTb2Z0d2FyZSB0byBhIG5ldyBlbnZpcm9ubWVudC4NCg0KIkF1dGhvciIgcmVmZXJzIHRvIGFueSBkZXNpZ25lciwgZW5naW5lZXIsIHByb2dyYW1tZXIsIHRlY2huaWNhbCB3cml0ZXIgb3Igb3RoZXIgcGVyc29uIHdobyBjb250cmlidXRlZCB0byB0aGUgRm9udCBTb2Z0d2FyZS4NCg0KUEVSTUlTU0lPTiAmIENPTkRJVElPTlMNClBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhlIEZvbnQgU29mdHdhcmUsIHRvIHVzZSwgc3R1ZHksIGNvcHksIG1lcmdlLCBlbWJlZCwgbW9kaWZ5LCByZWRpc3RyaWJ1dGUsIGFuZCBzZWxsIG1vZGlmaWVkIGFuZCB1bm1vZGlmaWVkIGNvcGllcyBvZiB0aGUgRm9udCBTb2Z0d2FyZSwgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6DQoNCjEpIE5laXRoZXIgdGhlIEZvbnQgU29mdHdhcmUgbm9yIGFueSBvZiBpdHMgaW5kaXZpZHVhbCBjb21wb25lbnRzLCBpbiBPcmlnaW5hbCBvciBNb2RpZmllZCBWZXJzaW9ucywgbWF5IGJlIHNvbGQgYnkgaXRzZWxmLg0KDQoyKSBPcmlnaW5hbCBvciBNb2RpZmllZCBWZXJzaW9ucyBvZiB0aGUgRm9udCBTb2Z0d2FyZSBtYXkgYmUgYnVuZGxlZCwgcmVkaXN0cmlidXRlZCBhbmQvb3Igc29sZCB3aXRoIGFueSBzb2Z0d2FyZSwgcHJvdmlkZWQgdGhhdCBlYWNoIGNvcHkgY29udGFpbnMgdGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgbGljZW5zZS4gVGhlc2UgY2FuIGJlIGluY2x1ZGVkIGVpdGhlciBhcyBzdGFuZC1hbG9uZSB0ZXh0IGZpbGVzLCBodW1hbi1yZWFkYWJsZSBoZWFkZXJzIG9yIGluIHRoZSBhcHByb3ByaWF0ZSBtYWNoaW5lLXJlYWRhYmxlIG1ldGFkYXRhIGZpZWxkcyB3aXRoaW4gdGV4dCBvciBiaW5hcnkgZmlsZXMgYXMgbG9uZyBhcyB0aG9zZSBmaWVsZHMgY2FuIGJlIGVhc2lseSB2aWV3ZWQgYnkgdGhlIHVzZXIuDQoNCjMpIE5vIE1vZGlmaWVkIFZlcnNpb24gb2YgdGhlIEZvbnQgU29mdHdhcmUgbWF5IHVzZSB0aGUgUmVzZXJ2ZWQgRm9udCBOYW1lKHMpIHVubGVzcyBleHBsaWNpdCB3cml0dGVuIHBlcm1pc3Npb24gaXMgZ3JhbnRlZCBieSB0aGUgY29ycmVzcG9uZGluZyBDb3B5cmlnaHQgSG9sZGVyLiBUaGlzIHJlc3RyaWN0aW9uIG9ubHkgYXBwbGllcyB0byB0aGUgcHJpbWFyeSBmb250IG5hbWUgYXMgcHJlc2VudGVkIHRvIHRoZSB1c2Vycy4NCg0KNCkgVGhlIG5hbWUocykgb2YgdGhlIENvcHlyaWdodCBIb2xkZXIocykgb3IgdGhlIEF1dGhvcihzKSBvZiB0aGUgRm9udCBTb2Z0d2FyZSBzaGFsbCBub3QgYmUgdXNlZCB0byBwcm9tb3RlLCBlbmRvcnNlIG9yIGFkdmVydGlzZSBhbnkgTW9kaWZpZWQgVmVyc2lvbiwgZXhjZXB0IHRvIGFja25vd2xlZGdlIHRoZSBjb250cmlidXRpb24ocykgb2YgdGhlIENvcHlyaWdodCBIb2xkZXIocykgYW5kIHRoZSBBdXRob3Iocykgb3Igd2l0aCB0aGVpciBleHBsaWNpdCB3cml0dGVuIHBlcm1pc3Npb24uDQoNCjUpIFRoZSBGb250IFNvZnR3YXJlLCBtb2RpZmllZCBvciB1bm1vZGlmaWVkLCBpbiBwYXJ0IG9yIGluIHdob2xlLCBtdXN0IGJlIGRpc3RyaWJ1dGVkIGVudGlyZWx5IHVuZGVyIHRoaXMgbGljZW5zZSwgYW5kIG11c3Qgbm90IGJlIGRpc3RyaWJ1dGVkIHVuZGVyIGFueSBvdGhlciBsaWNlbnNlLiBUaGUgcmVxdWlyZW1lbnQgZm9yIGZvbnRzIHRvIHJlbWFpbiB1bmRlciB0aGlzIGxpY2Vuc2UgZG9lcyBub3QgYXBwbHkgdG8gYW55IGRvY3VtZW50IGNyZWF0ZWQgdXNpbmcgdGhlIEZvbnQgU29mdHdhcmUuDQoNClRFUk1JTkFUSU9ODQpUaGlzIGxpY2Vuc2UgYmVjb21lcyBudWxsIGFuZCB2b2lkIGlmIGFueSBvZiB0aGUgYWJvdmUgY29uZGl0aW9ucyBhcmUgbm90IG1ldC4NCg0KRElTQ0xBSU1FUg0KVEhFIEZPTlQgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIEFOWSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVCBPRiBDT1BZUklHSFQsIFBBVEVOVCwgVFJBREVNQVJLLCBPUiBPVEhFUiBSSUdIVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIENPUFlSSUdIVCBIT0xERVIgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBJTkNMVURJTkcgQU5ZIEdFTkVSQUwsIFNQRUNJQUwsIElORElSRUNULCBJTkNJREVOVEFMLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMsIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgVEhFIFVTRSBPUiBJTkFCSUxJVFkgVE8gVVNFIFRIRSBGT05UIFNPRlRXQVJFIE9SIEZST00gT1RIRVIgREVBTElOR1MgSU4gVEhFIEZPTlQgU09GVFdBUkUuAEMAbwBwAHkAcgBpAGcAaAB0ACAAKABjACkAIAAyADAAMQA2ACAARgByAC4AIABNAGEAdAB0AGgAZQB3ACAAUwBwAGUAbgBjAGUAcgAsACAATwAuAFMALgBKAC4AUgBlAGcAdQBsAGEAcgBFAHgAcwB1AHIAZwBlACAAQwBoAGEAcgBhAGMAdABlAHIAcwA6AFYAZQByAHMAaQBvAG4AIAAxAC4AMAAwAFYAZQByAHMAaQBvAG4AIAAxAC4AMAAwACAARgBlAGIAcgB1AGEAcgB5ACAAMQA4ACwAIAAyADAAMQA2ACwAIABpAG4AaQB0AGkAYQBsACAAcgBlAGwAZQBhAHMAZQBFAHgAcwB1AHIAZwBlAEMAaABhAHIAYQBjAHQAZQByAHMAVABoAGkAcwAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABpAHMAIABsAGkAYwBlAG4AcwBlAGQAIAB1AG4AZABlAHIAIAB0AGgAZQAgAFMASQBMACAATwBwAGUAbgAgAEYAbwBuAHQAIABMAGkAYwBlAG4AcwBlACwAIABWAGUAcgBzAGkAbwBuACAAMQAuADEALgAgAFQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAaQBzACAAYwBvAHAAaQBlAGQAIABiAGUAbABvAHcALAAgAGEAbgBkACAAaQBzACAAYQBsAHMAbwAgAGEAdgBhAGkAbABhAGIAbABlACAAdwBpAHQAaAAgAGEAIABGAEEAUQAgAGEAdAA6ACAAaAB0AHQAcAA6AC8ALwBzAGMAcgBpAHAAdABzAC4AcwBpAGwALgBvAHIAZwAvAE8ARgBMAA0ACgANAAoADQAKAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQANAAoAUwBJAEwAIABPAFAARQBOACAARgBPAE4AVAAgAEwASQBDAEUATgBTAEUAIABWAGUAcgBzAGkAbwBuACAAMQAuADEAIAAtACAAMgA2ACAARgBlAGIAcgB1AGEAcgB5ACAAMgAwADAANwANAAoALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAC0ALQAtAA0ACgANAAoAUABSAEUAQQBNAEIATABFAA0ACgBUAGgAZQAgAGcAbwBhAGwAcwAgAG8AZgAgAHQAaABlACAATwBwAGUAbgAgAEYAbwBuAHQAIABMAGkAYwBlAG4AcwBlACAAKABPAEYATAApACAAYQByAGUAIAB0AG8AIABzAHQAaQBtAHUAbABhAHQAZQAgAHcAbwByAGwAZAB3AGkAZABlACAAZABlAHYAZQBsAG8AcABtAGUAbgB0ACAAbwBmACAAYwBvAGwAbABhAGIAbwByAGEAdABpAHYAZQAgAGYAbwBuAHQAIABwAHIAbwBqAGUAYwB0AHMALAAgAHQAbwAgAHMAdQBwAHAAbwByAHQAIAB0AGgAZQAgAGYAbwBuAHQAIABjAHIAZQBhAHQAaQBvAG4AIABlAGYAZgBvAHIAdABzACAAbwBmACAAYQBjAGEAZABlAG0AaQBjACAAYQBuAGQAIABsAGkAbgBnAHUAaQBzAHQAaQBjACAAYwBvAG0AbQB1AG4AaQB0AGkAZQBzACwAIABhAG4AZAAgAHQAbwAgAHAAcgBvAHYAaQBkAGUAIABhACAAZgByAGUAZQAgAGEAbgBkACAAbwBwAGUAbgAgAGYAcgBhAG0AZQB3AG8AcgBrACAAaQBuACAAdwBoAGkAYwBoACAAZgBvAG4AdABzACAAbQBhAHkAIABiAGUAIABzAGgAYQByAGUAZAAgAGEAbgBkACAAaQBtAHAAcgBvAHYAZQBkACAAaQBuACAAcABhAHIAdABuAGUAcgBzAGgAaQBwACAAdwBpAHQAaAAgAG8AdABoAGUAcgBzAC4ADQAKAA0ACgBUAGgAZQAgAE8ARgBMACAAYQBsAGwAbwB3AHMAIAB0AGgAZQAgAGwAaQBjAGUAbgBzAGUAZAAgAGYAbwBuAHQAcwAgAHQAbwAgAGIAZQAgAHUAcwBlAGQALAAgAHMAdAB1AGQAaQBlAGQALAAgAG0AbwBkAGkAZgBpAGUAZAAgAGEAbgBkACAAcgBlAGQAaQBzAHQAcgBpAGIAdQB0AGUAZAAgAGYAcgBlAGUAbAB5ACAAYQBzACAAbABvAG4AZwAgAGEAcwAgAHQAaABlAHkAIABhAHIAZQAgAG4AbwB0ACAAcwBvAGwAZAAgAGIAeQAgAHQAaABlAG0AcwBlAGwAdgBlAHMALgAgAFQAaABlACAAZgBvAG4AdABzACwAIABpAG4AYwBsAHUAZABpAG4AZwAgAGEAbgB5ACAAZABlAHIAaQB2AGEAdABpAHYAZQAgAHcAbwByAGsAcwAsACAAYwBhAG4AIABiAGUAIABiAHUAbgBkAGwAZQBkACwAIABlAG0AYgBlAGQAZABlAGQALAAgAHIAZQBkAGkAcwB0AHIAaQBiAHUAdABlAGQAIABhAG4AZAAvAG8AcgAgAHMAbwBsAGQAIAB3AGkAdABoACAAYQBuAHkAIABzAG8AZgB0AHcAYQByAGUAIABwAHIAbwB2AGkAZABlAGQAIAB0AGgAYQB0ACAAYQBuAHkAIAByAGUAcwBlAHIAdgBlAGQAIABuAGEAbQBlAHMAIABhAHIAZQAgAG4AbwB0ACAAdQBzAGUAZAAgAGIAeQAgAGQAZQByAGkAdgBhAHQAaQB2AGUAIAB3AG8AcgBrAHMALgAgAFQAaABlACAAZgBvAG4AdABzACAAYQBuAGQAIABkAGUAcgBpAHYAYQB0AGkAdgBlAHMALAAgAGgAbwB3AGUAdgBlAHIALAAgAGMAYQBuAG4AbwB0ACAAYgBlACAAcgBlAGwAZQBhAHMAZQBkACAAdQBuAGQAZQByACAAYQBuAHkAIABvAHQAaABlAHIAIAB0AHkAcABlACAAbwBmACAAbABpAGMAZQBuAHMAZQAuACAAVABoAGUAIAByAGUAcQB1AGkAcgBlAG0AZQBuAHQAIABmAG8AcgAgAGYAbwBuAHQAcwAgAHQAbwAgAHIAZQBtAGEAaQBuACAAdQBuAGQAZQByACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUAIABkAG8AZQBzACAAbgBvAHQAIABhAHAAcABsAHkAIAB0AG8AIABhAG4AeQAgAGQAbwBjAHUAbQBlAG4AdAAgAGMAcgBlAGEAdABlAGQAIAB1AHMAaQBuAGcAIAB0AGgAZQAgAGYAbwBuAHQAcwAgAG8AcgAgAHQAaABlAGkAcgAgAGQAZQByAGkAdgBhAHQAaQB2AGUAcwAuAA0ACgANAAoARABFAEYASQBOAEkAVABJAE8ATgBTAA0ACgAiAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAdABoAGUAIABzAGUAdAAgAG8AZgAgAGYAaQBsAGUAcwAgAHIAZQBsAGUAYQBzAGUAZAAgAGIAeQAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAHUAbgBkAGUAcgAgAHQAaABpAHMAIABsAGkAYwBlAG4AcwBlACAAYQBuAGQAIABjAGwAZQBhAHIAbAB5ACAAbQBhAHIAawBlAGQAIABhAHMAIABzAHUAYwBoAC4AIABUAGgAaQBzACAAbQBhAHkAIABpAG4AYwBsAHUAZABlACAAcwBvAHUAcgBjAGUAIABmAGkAbABlAHMALAAgAGIAdQBpAGwAZAAgAHMAYwByAGkAcAB0AHMAIABhAG4AZAAgAGQAbwBjAHUAbQBlAG4AdABhAHQAaQBvAG4ALgANAAoADQAKACIAUgBlAHMAZQByAHYAZQBkACAARgBvAG4AdAAgAE4AYQBtAGUAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAYQBuAHkAIABuAGEAbQBlAHMAIABzAHAAZQBjAGkAZgBpAGUAZAAgAGEAcwAgAHMAdQBjAGgAIABhAGYAdABlAHIAIAB0AGgAZQAgAGMAbwBwAHkAcgBpAGcAaAB0ACAAcwB0AGEAdABlAG0AZQBuAHQAKABzACkALgANAAoADQAKACIATwByAGkAZwBpAG4AYQBsACAAVgBlAHIAcwBpAG8AbgAiACAAcgBlAGYAZQByAHMAIAB0AG8AIAB0AGgAZQAgAGMAbwBsAGwAZQBjAHQAaQBvAG4AIABvAGYAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACAAYwBvAG0AcABvAG4AZQBuAHQAcwAgAGEAcwAgAGQAaQBzAHQAcgBpAGIAdQB0AGUAZAAgAGIAeQAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAuAA0ACgANAAoAIgBNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuACIAIAByAGUAZgBlAHIAcwAgAHQAbwAgAGEAbgB5ACAAZABlAHIAaQB2AGEAdABpAHYAZQAgAG0AYQBkAGUAIABiAHkAIABhAGQAZABpAG4AZwAgAHQAbwAsACAAZABlAGwAZQB0AGkAbgBnACwAIABvAHIAIABzAHUAYgBzAHQAaQB0AHUAdABpAG4AZwAgAC0ALQAgAGkAbgAgAHAAYQByAHQAIABvAHIAIABpAG4AIAB3AGgAbwBsAGUAIAAtAC0AIABhAG4AeQAgAG8AZgAgAHQAaABlACAAYwBvAG0AcABvAG4AZQBuAHQAcwAgAG8AZgAgAHQAaABlACAATwByAGkAZwBpAG4AYQBsACAAVgBlAHIAcwBpAG8AbgAsACAAYgB5ACAAYwBoAGEAbgBnAGkAbgBnACAAZgBvAHIAbQBhAHQAcwAgAG8AcgAgAGIAeQAgAHAAbwByAHQAaQBuAGcAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIAB0AG8AIABhACAAbgBlAHcAIABlAG4AdgBpAHIAbwBuAG0AZQBuAHQALgANAAoADQAKACIAQQB1AHQAaABvAHIAIgAgAHIAZQBmAGUAcgBzACAAdABvACAAYQBuAHkAIABkAGUAcwBpAGcAbgBlAHIALAAgAGUAbgBnAGkAbgBlAGUAcgAsACAAcAByAG8AZwByAGEAbQBtAGUAcgAsACAAdABlAGMAaABuAGkAYwBhAGwAIAB3AHIAaQB0AGUAcgAgAG8AcgAgAG8AdABoAGUAcgAgAHAAZQByAHMAbwBuACAAdwBoAG8AIABjAG8AbgB0AHIAaQBiAHUAdABlAGQAIAB0AG8AIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUALgANAAoADQAKAFAARQBSAE0ASQBTAFMASQBPAE4AIAAmACAAQwBPAE4ARABJAFQASQBPAE4AUwANAAoAUABlAHIAbQBpAHMAcwBpAG8AbgAgAGkAcwAgAGgAZQByAGUAYgB5ACAAZwByAGEAbgB0AGUAZAAsACAAZgByAGUAZQAgAG8AZgAgAGMAaABhAHIAZwBlACwAIAB0AG8AIABhAG4AeQAgAHAAZQByAHMAbwBuACAAbwBiAHQAYQBpAG4AaQBuAGcAIABhACAAYwBvAHAAeQAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAsACAAdABvACAAdQBzAGUALAAgAHMAdAB1AGQAeQAsACAAYwBvAHAAeQAsACAAbQBlAHIAZwBlACwAIABlAG0AYgBlAGQALAAgAG0AbwBkAGkAZgB5ACwAIAByAGUAZABpAHMAdAByAGkAYgB1AHQAZQAsACAAYQBuAGQAIABzAGUAbABsACAAbQBvAGQAaQBmAGkAZQBkACAAYQBuAGQAIAB1AG4AbQBvAGQAaQBmAGkAZQBkACAAYwBvAHAAaQBlAHMAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUALAAgAHMAdQBiAGoAZQBjAHQAIAB0AG8AIAB0AGgAZQAgAGYAbwBsAGwAbwB3AGkAbgBnACAAYwBvAG4AZABpAHQAaQBvAG4AcwA6AA0ACgANAAoAMQApACAATgBlAGkAdABoAGUAcgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAG4AbwByACAAYQBuAHkAIABvAGYAIABpAHQAcwAgAGkAbgBkAGkAdgBpAGQAdQBhAGwAIABjAG8AbQBwAG8AbgBlAG4AdABzACwAIABpAG4AIABPAHIAaQBnAGkAbgBhAGwAIABvAHIAIABNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuAHMALAAgAG0AYQB5ACAAYgBlACAAcwBvAGwAZAAgAGIAeQAgAGkAdABzAGUAbABmAC4ADQAKAA0ACgAyACkAIABPAHIAaQBnAGkAbgBhAGwAIABvAHIAIABNAG8AZABpAGYAaQBlAGQAIABWAGUAcgBzAGkAbwBuAHMAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABtAGEAeQAgAGIAZQAgAGIAdQBuAGQAbABlAGQALAAgAHIAZQBkAGkAcwB0AHIAaQBiAHUAdABlAGQAIABhAG4AZAAvAG8AcgAgAHMAbwBsAGQAIAB3AGkAdABoACAAYQBuAHkAIABzAG8AZgB0AHcAYQByAGUALAAgAHAAcgBvAHYAaQBkAGUAZAAgAHQAaABhAHQAIABlAGEAYwBoACAAYwBvAHAAeQAgAGMAbwBuAHQAYQBpAG4AcwAgAHQAaABlACAAYQBiAG8AdgBlACAAYwBvAHAAeQByAGkAZwBoAHQAIABuAG8AdABpAGMAZQAgAGEAbgBkACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUALgAgAFQAaABlAHMAZQAgAGMAYQBuACAAYgBlACAAaQBuAGMAbAB1AGQAZQBkACAAZQBpAHQAaABlAHIAIABhAHMAIABzAHQAYQBuAGQALQBhAGwAbwBuAGUAIAB0AGUAeAB0ACAAZgBpAGwAZQBzACwAIABoAHUAbQBhAG4ALQByAGUAYQBkAGEAYgBsAGUAIABoAGUAYQBkAGUAcgBzACAAbwByACAAaQBuACAAdABoAGUAIABhAHAAcAByAG8AcAByAGkAYQB0AGUAIABtAGEAYwBoAGkAbgBlAC0AcgBlAGEAZABhAGIAbABlACAAbQBlAHQAYQBkAGEAdABhACAAZgBpAGUAbABkAHMAIAB3AGkAdABoAGkAbgAgAHQAZQB4AHQAIABvAHIAIABiAGkAbgBhAHIAeQAgAGYAaQBsAGUAcwAgAGEAcwAgAGwAbwBuAGcAIABhAHMAIAB0AGgAbwBzAGUAIABmAGkAZQBsAGQAcwAgAGMAYQBuACAAYgBlACAAZQBhAHMAaQBsAHkAIAB2AGkAZQB3AGUAZAAgAGIAeQAgAHQAaABlACAAdQBzAGUAcgAuAA0ACgANAAoAMwApACAATgBvACAATQBvAGQAaQBmAGkAZQBkACAAVgBlAHIAcwBpAG8AbgAgAG8AZgAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAgAG0AYQB5ACAAdQBzAGUAIAB0AGgAZQAgAFIAZQBzAGUAcgB2AGUAZAAgAEYAbwBuAHQAIABOAGEAbQBlACgAcwApACAAdQBuAGwAZQBzAHMAIABlAHgAcABsAGkAYwBpAHQAIAB3AHIAaQB0AHQAZQBuACAAcABlAHIAbQBpAHMAcwBpAG8AbgAgAGkAcwAgAGcAcgBhAG4AdABlAGQAIABiAHkAIAB0AGgAZQAgAGMAbwByAHIAZQBzAHAAbwBuAGQAaQBuAGcAIABDAG8AcAB5AHIAaQBnAGgAdAAgAEgAbwBsAGQAZQByAC4AIABUAGgAaQBzACAAcgBlAHMAdAByAGkAYwB0AGkAbwBuACAAbwBuAGwAeQAgAGEAcABwAGwAaQBlAHMAIAB0AG8AIAB0AGgAZQAgAHAAcgBpAG0AYQByAHkAIABmAG8AbgB0ACAAbgBhAG0AZQAgAGEAcwAgAHAAcgBlAHMAZQBuAHQAZQBkACAAdABvACAAdABoAGUAIAB1AHMAZQByAHMALgANAAoADQAKADQAKQAgAFQAaABlACAAbgBhAG0AZQAoAHMAKQAgAG8AZgAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAG8AcgAgAHQAaABlACAAQQB1AHQAaABvAHIAKABzACkAIABvAGYAIAB0AGgAZQAgAEYAbwBuAHQAIABTAG8AZgB0AHcAYQByAGUAIABzAGgAYQBsAGwAIABuAG8AdAAgAGIAZQAgAHUAcwBlAGQAIAB0AG8AIABwAHIAbwBtAG8AdABlACwAIABlAG4AZABvAHIAcwBlACAAbwByACAAYQBkAHYAZQByAHQAaQBzAGUAIABhAG4AeQAgAE0AbwBkAGkAZgBpAGUAZAAgAFYAZQByAHMAaQBvAG4ALAAgAGUAeABjAGUAcAB0ACAAdABvACAAYQBjAGsAbgBvAHcAbABlAGQAZwBlACAAdABoAGUAIABjAG8AbgB0AHIAaQBiAHUAdABpAG8AbgAoAHMAKQAgAG8AZgAgAHQAaABlACAAQwBvAHAAeQByAGkAZwBoAHQAIABIAG8AbABkAGUAcgAoAHMAKQAgAGEAbgBkACAAdABoAGUAIABBAHUAdABoAG8AcgAoAHMAKQAgAG8AcgAgAHcAaQB0AGgAIAB0AGgAZQBpAHIAIABlAHgAcABsAGkAYwBpAHQAIAB3AHIAaQB0AHQAZQBuACAAcABlAHIAbQBpAHMAcwBpAG8AbgAuAA0ACgANAAoANQApACAAVABoAGUAIABGAG8AbgB0ACAAUwBvAGYAdAB3AGEAcgBlACwAIABtAG8AZABpAGYAaQBlAGQAIABvAHIAIAB1AG4AbQBvAGQAaQBmAGkAZQBkACwAIABpAG4AIABwAGEAcgB0ACAAbwByACAAaQBuACAAdwBoAG8AbABlACwAIABtAHUAcwB0ACAAYgBlACAAZABpAHMAdAByAGkAYgB1AHQAZQBkACAAZQBuAHQAaQByAGUAbAB5ACAAdQBuAGQAZQByACAAdABoAGkAcwAgAGwAaQBjAGUAbgBzAGUALAAgAGEAbgBkACAAbQB1AHMAdAAgAG4AbwB0ACAAYgBlACAAZABpAHMAdAByAGkAYgB1AHQAZQBkACAAdQBuAGQAZQByACAAYQBuAHkAIABvAHQAaABlAHIAIABsAGkAYwBlAG4AcwBlAC4AIABUAGgAZQAgAHIAZQBxAHUAaQByAGUAbQBlAG4AdAAgAGYAbwByACAAZgBvAG4AdABzACAAdABvACAAcgBlAG0AYQBpAG4AIAB1AG4AZABlAHIAIAB0AGgAaQBzACAAbABpAGMAZQBuAHMAZQAgAGQAbwBlAHMAIABuAG8AdAAgAGEAcABwAGwAeQAgAHQAbwAgAGEAbgB5ACAAZABvAGMAdQBtAGUAbgB0ACAAYwByAGUAYQB0AGUAZAAgAHUAcwBpAG4AZwAgAHQAaABlACAARgBvAG4AdAAgAFMAbwBmAHQAdwBhAHIAZQAuAA0ACgANAAoAVABFAFIATQBJAE4AQQBUAEkATwBOAA0ACgBUAGgAaQBzACAAbABpAGMAZQBuAHMAZQAgAGIAZQBjAG8AbQBlAHMAIABuAHUAbABsACAAYQBuAGQAIAB2AG8AaQBkACAAaQBmACAAYQBuAHkAIABvAGYAIAB0AGgAZQAgAGEAYgBvAHYAZQAgAGMAbwBuAGQAaQB0AGkAbwBuAHMAIABhAHIAZQAgAG4AbwB0ACAAbQBlAHQALgANAAoADQAKAEQASQBTAEMATABBAEkATQBFAFIADQAKAFQASABFACAARgBPAE4AVAAgAFMATwBGAFQAVwBBAFIARQAgAEkAUwAgAFAAUgBPAFYASQBEAEUARAAgACIAQQBTACAASQBTACIALAAgAFcASQBUAEgATwBVAFQAIABXAEEAUgBSAEEATgBUAFkAIABPAEYAIABBAE4AWQAgAEsASQBOAEQALAAgAEUAWABQAFIARQBTAFMAIABPAFIAIABJAE0AUABMAEkARQBEACwAIABJAE4AQwBMAFUARABJAE4ARwAgAEIAVQBUACAATgBPAFQAIABMAEkATQBJAFQARQBEACAAVABPACAAQQBOAFkAIABXAEEAUgBSAEEATgBUAEkARQBTACAATwBGACAATQBFAFIAQwBIAEEATgBUAEEAQgBJAEwASQBUAFkALAAgAEYASQBUAE4ARQBTAFMAIABGAE8AUgAgAEEAIABQAEEAUgBUAEkAQwBVAEwAQQBSACAAUABVAFIAUABPAFMARQAgAEEATgBEACAATgBPAE4ASQBOAEYAUgBJAE4ARwBFAE0ARQBOAFQAIABPAEYAIABDAE8AUABZAFIASQBHAEgAVAAsACAAUABBAFQARQBOAFQALAAgAFQAUgBBAEQARQBNAEEAUgBLACwAIABPAFIAIABPAFQASABFAFIAIABSAEkARwBIAFQALgAgAEkATgAgAE4ATwAgAEUAVgBFAE4AVAAgAFMASABBAEwATAAgAFQASABFACAAQwBPAFAAWQBSAEkARwBIAFQAIABIAE8ATABEAEUAUgAgAEIARQAgAEwASQBBAEIATABFACAARgBPAFIAIABBAE4AWQAgAEMATABBAEkATQAsACAARABBAE0AQQBHAEUAUwAgAE8AUgAgAE8AVABIAEUAUgAgAEwASQBBAEIASQBMAEkAVABZACwAIABJAE4AQwBMAFUARABJAE4ARwAgAEEATgBZACAARwBFAE4ARQBSAEEATAAsACAAUwBQAEUAQwBJAEEATAAsACAASQBOAEQASQBSAEUAQwBUACwAIABJAE4AQwBJAEQARQBOAFQAQQBMACwAIABPAFIAIABDAE8ATgBTAEUAUQBVAEUATgBUAEkAQQBMACAARABBAE0AQQBHAEUAUwAsACAAVwBIAEUAVABIAEUAUgAgAEkATgAgAEEATgAgAEEAQwBUAEkATwBOACAATwBGACAAQwBPAE4AVABSAEEAQwBUACwAIABUAE8AUgBUACAATwBSACAATwBUAEgARQBSAFcASQBTAEUALAAgAEEAUgBJAFMASQBOAEcAIABGAFIATwBNACwAIABPAFUAVAAgAE8ARgAgAFQASABFACAAVQBTAEUAIABPAFIAIABJAE4AQQBCAEkATABJAFQAWQAgAFQATwAgAFUAUwBFACAAVABIAEUAIABGAE8ATgBUACAAUwBPAEYAVABXAEEAUgBFACAATwBSACAARgBSAE8ATQAgAE8AVABIAEUAUgAgAEQARQBBAEwASQBOAEcAUwAgAEkATgAgAFQASABFACAARgBPAE4AVAAgAFMATwBGAFQAVwBBAFIARQAuAAAAAgAAAAAAAP8GAGQAAAAAAAAAAAAAAAAAAAAAAAAAAABfAAMABAAFAAYABwAIAAkACgALAAwADQAOAA8AEAARABIAEwAUABUAFgAXABgAGQAaABsAHAAdAB4AHwAgACEAIgAjACQAJQAmACcAKAApACoAKwAsAC0ALgAvADAAMQAyADMANAA1ADYANwA4ADkAOgA7ADwAPQA+AD8AQABBAEIAQwBEAEUARgBHAEgASQBKAEsATABNAE4ATwBQAFEAUgBTAFQAVQBWAFcAWABZAFoAWwBcAF0AXgBfAGAAYQAAAAMACAACABAAAf//AAIAAAABAAAAAAABAAAADgAAAAAAAAAAAAIAAQAAAF4AAQABAAAACgBKAGQAAmN5cmwADmxhdG4AGAAEAAAAAP//AAAAEAACSVBBIAAaVklUIAAiAAD//wACAAEAAAAA//8AAQABAAD//wAAAAJrZXJuAA5tYXJrABQAAAABAAEAAAABAAAAAgAGAA4ABAAEAAEAEAACAAAAAQAsAAEADAAQAAAAIAAiAAIAAAABAAYAIQAyADYAQQBSAFYAAAAGAAEAjgAEAAAABgAWADAASgBkAHIAgAAGAA7/nAAhADYAQQA2ADIADQA2//IAUgAXAAYADv+cACEAWABBAFgAMgChADYAvQBSAE8ABgAO/nAAIf6TAEH+kwAy//kANgAOAFL/YQADAA7/nABSABcAVv/VAAMADv+cAFIANgBWAEwAAwAO/nAAUgAJAFYAGQABAAYAIQAyADYAQQBSAFYAAQAAAAoATgBoAAJjeXJsAA5sYXRuABoABAAAAAD//wABAAAAEAACSVBBIAAaVklUIAAiAAD//wACAAAAAQAA//8AAQAAAAD//wABAAAAAmFhbHQADnNtY3AAFAAAAAEAAAAAAAEAAAABAAQAAwAAAAEACAABABgAAwAMABAAFAABAEEAAQBSAAEAVgABAAMAIQAyADYAAA==";
},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChantDocument=exports.ChantScore=exports.ChantMapping=exports.ChantLineBreak=exports.TextOnly=exports.FaClef=exports.DoClef=exports.Clef=exports.Note=exports.NoteShapeModifiers=exports.NoteShape=exports.LiquescentType=void 0;var _get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Exsurge=__webpack_require__(1),_Exsurge2=(_interopRequireWildcard(_Exsurge),__webpack_require__(4)),_ExsurgeChant=__webpack_require__(7),_ExsurgeChant2=__webpack_require__(8),_Exsurge3=(__webpack_require__(9),__webpack_require__(10)),LiquescentType=exports.LiquescentType={None:0,Large:1,Small:2,Ascending:4,Descending:8,InitioDebilis:16,LargeAscending:5,LargeDescending:9,SmallAscending:6,SmallDescending:10},NoteShape=exports.NoteShape={Default:0,Virga:1,Inclinatum:2,Quilisma:3,Stropha:4,Oriscus:5},NoteShapeModifiers=exports.NoteShapeModifiers={None:0,Ascending:1,Descending:2,Cavum:4,Stemmed:8},Clef=(exports.Note=function(_ChantLayoutElement){function Note(pitch){_classCallCheck(this,Note);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Note).call(this));return"undefined"!=typeof pitch?_this.pitch=pitch:_this.pitch=null,_this.glyphVisualizer=null,_this.staffPosition=0,_this.liquescent=LiquescentType.None,_this.shape=NoteShape.Default,_this.shapeModifiers=NoteShapeModifiers.None,_this.neume=null,_this.epismata=[],_this.morae=[],_this}return _inherits(Note,_ChantLayoutElement),_createClass(Note,[{key:"setGlyph",value:function(ctxt,glyphCode){this.glyphVisualizer?this.glyphVisualizer.setGlyph(ctxt,glyphCode):this.glyphVisualizer=new _Exsurge2.GlyphVisualizer(ctxt,glyphCode),this.glyphVisualizer.setStaffPosition(ctxt,this.staffPosition),this.bounds.x=this.glyphVisualizer.bounds.x,this.bounds.y=this.glyphVisualizer.bounds.y,this.bounds.width=this.glyphVisualizer.bounds.width,this.bounds.height=this.glyphVisualizer.bounds.height,this.origin.x=this.glyphVisualizer.origin.x,this.origin.y=this.glyphVisualizer.origin.y}},{key:"shapeModifierMatches",value:function(shapeModifier){return shapeModifier===NoteShapeModifiers.None?this.shapeModifier===NoteShapeModifiers.None:this.shapeModifier&0!==shapeModifier}},{key:"draw",value:function(ctxt){this.glyphVisualizer.bounds.x=this.bounds.x,this.glyphVisualizer.bounds.y=this.bounds.y,this.glyphVisualizer.draw(ctxt)}},{key:"createSvgFragment",value:function(ctxt){return this.glyphVisualizer.bounds.x=this.bounds.x,this.glyphVisualizer.bounds.y=this.bounds.y,this.glyphVisualizer.createSvgFragment(ctxt)}}]),Note}(_Exsurge2.ChantLayoutElement),exports.Clef=function(_ChantNotationElement){function Clef(staffPosition,octave){var defaultAccidental=arguments.length<=2||void 0===arguments[2]?null:arguments[2];_classCallCheck(this,Clef);var _this2=_possibleConstructorReturn(this,Object.getPrototypeOf(Clef).call(this));return _this2.isClef=!0,_this2.staffPosition=staffPosition,_this2.octave=octave,_this2.defaultAccidental=defaultAccidental,_this2.activeAccidental=defaultAccidental,_this2}return _inherits(Clef,_ChantNotationElement),_createClass(Clef,[{key:"resetAccidentals",value:function(){this.activeAccidental=this.defaultAccidental}},{key:"pitchToStaffPosition",value:function(pitch){}},{key:"performLayout",value:function(ctxt){ctxt.activeClef=this,this.defaultAccidental&&this.defaultAccidental.performLayout(ctxt),_get(Object.getPrototypeOf(Clef.prototype),"performLayout",this).call(this,ctxt)}},{key:"finishLayout",value:function(ctxt){if(this.defaultAccidental){var accidentalGlyph=this.defaultAccidental.createGlyphVisualizer(ctxt);accidentalGlyph.bounds.x+=this.visualizers[0].bounds.right()+ctxt.intraNeumeSpacing,this.addVisualizer(accidentalGlyph)}_get(Object.getPrototypeOf(Clef.prototype),"finishLayout",this).call(this,ctxt)}}],[{key:"default",value:function(){return __defaultDoClef}}]),Clef}(_Exsurge2.ChantNotationElement)),DoClef=exports.DoClef=function(_Clef){function DoClef(staffPosition,octave){var defaultAccidental=arguments.length<=2||void 0===arguments[2]?null:arguments[2];_classCallCheck(this,DoClef);var _this3=_possibleConstructorReturn(this,Object.getPrototypeOf(DoClef).call(this,staffPosition,octave,defaultAccidental));return _this3.leadingSpace=0,_this3}return _inherits(DoClef,_Clef),_createClass(DoClef,[{key:"pitchToStaffPosition",value:function(pitch){return 7*(pitch.octave-this.octave)+this.staffPosition+_Exsurge.Pitch.stepToStaffOffset(pitch.step)-_Exsurge.Pitch.stepToStaffOffset(_Exsurge.Step.Do)}},{key:"staffPositionToPitch",value:function(staffPosition){var offset=staffPosition-this.staffPosition,octaveOffset=Math.floor(offset/7),step=_Exsurge.Pitch.staffOffsetToStep(offset);return null!==this.defaultAccidental&&step===this.defaultAccidental.step&&(step+=this.defaultAccidental.accidentalType),new _Exsurge.Pitch(step,this.octave+octaveOffset)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(DoClef.prototype),"performLayout",this).call(this,ctxt);var glyph=new _Exsurge2.GlyphVisualizer(ctxt,_Exsurge2.GlyphCode.DoClef);glyph.setStaffPosition(ctxt,this.staffPosition),this.addVisualizer(glyph),this.finishLayout(ctxt)}},{key:"clone",value:function(){return new DoClef(this.staffPosition,this.octave,this.defaultAccidental)}}]),DoClef}(Clef),__defaultDoClef=new DoClef(1,2),ChantScore=(exports.FaClef=function(_Clef2){function FaClef(staffPosition,octave){var defaultAccidental=arguments.length<=2||void 0===arguments[2]?null:arguments[2];_classCallCheck(this,FaClef);var _this4=_possibleConstructorReturn(this,Object.getPrototypeOf(FaClef).call(this,staffPosition,octave,defaultAccidental));return _this4.octave=octave,_this4.leadingSpace=0,_this4}return _inherits(FaClef,_Clef2),_createClass(FaClef,[{key:"pitchToStaffPosition",value:function(pitch){return 7*(pitch.octave-this.octave)+this.staffPosition+_Exsurge.Pitch.stepToStaffOffset(pitch.step)-_Exsurge.Pitch.stepToStaffOffset(_Exsurge.Step.Fa)}},{key:"staffPositionToPitch",value:function(staffPosition){var offset=staffPosition-this.staffPosition+3,octaveOffset=Math.floor(offset/7),step=_Exsurge.Pitch.staffOffsetToStep(offset);return step===_Exsurge.Step.Ti&&this.defaultAccidental===_ExsurgeChant2.AccidentalType.Flat&&(step=_Exsurge.Step.Te),new _Exsurge.Pitch(step,this.octave+octaveOffset)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(FaClef.prototype),"performLayout",this).call(this,ctxt);var glyph=new _Exsurge2.GlyphVisualizer(ctxt,_Exsurge2.GlyphCode.FaClef);glyph.setStaffPosition(ctxt,this.staffPosition),this.addVisualizer(glyph),this.finishLayout(ctxt)}},{key:"clone",value:function(){return new FaClef(this.staffPosition,this.octave,this.defaultAccidental)}}]),FaClef}(Clef),exports.TextOnly=function(_ChantNotationElement2){function TextOnly(){return _classCallCheck(this,TextOnly),_possibleConstructorReturn(this,Object.getPrototypeOf(TextOnly).call(this))}return _inherits(TextOnly,_ChantNotationElement2),_createClass(TextOnly,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(TextOnly.prototype),"performLayout",this).call(this,ctxt),this.addVisualizer(new _Exsurge2.GlyphVisualizer(ctxt,_Exsurge2.GlyphCode.None)),this.origin.x=0,this.origin.y=0,this.finishLayout(ctxt)}}]),TextOnly}(_Exsurge2.ChantNotationElement),exports.ChantLineBreak=function(_ChantNotationElement3){function ChantLineBreak(justify){_classCallCheck(this,ChantLineBreak);var _this6=_possibleConstructorReturn(this,Object.getPrototypeOf(ChantLineBreak).call(this));return _this6.justify=justify,_this6}return _inherits(ChantLineBreak,_ChantNotationElement3),_createClass(ChantLineBreak,[{key:"performLayout",value:function(ctxt){this.bounds=new _Exsurge.Rect(0,0,0,0)}},{key:"clone",value:function(){var lb=new ChantLineBreak;return lb.justify=this.justify,lb}}]),ChantLineBreak}(_Exsurge2.ChantNotationElement),exports.ChantMapping=function ChantMapping(source,notations){_classCallCheck(this,ChantMapping),this.source=source,this.notations=notations},exports.ChantScore=function(){function ChantScore(ctxt){var mappings=arguments.length<=1||void 0===arguments[1]?[]:arguments[1],useDropCap=arguments[2];_classCallCheck(this,ChantScore),this.mappings=mappings,this.lines=[],this.notes=[],this.startingClef=null,this.useDropCap=useDropCap,this.dropCap=null,this.annotation=null,this.compiled=!1,this.autoColoring=!0,this.needsLayout=!0,this.bounds=new _Exsurge.Rect,this.updateNotations(ctxt)}return _createClass(ChantScore,[{key:"updateNotations",value:function(ctxt){var i;for(this.notations=[],i=0;i<this.mappings.length;i++)this.notations=this.notations.concat(this.mappings[i].notations);this.startingClef=null;var defaultClef=new DoClef(1,2);for(i=0;i<this.notations.length;i++){if(this.notations[i].isNeume){this.startingClef=defaultClef;break}if(this.notations[i].isClef){this.startingClef=this.notations[i],this.notations.splice(i,1);break}}this.startingClef||(this.startingClef=defaultClef),this.useDropCap&&this.recreateDropCap(ctxt),this.needsLayout=!0}},{key:"recreateDropCap",value:function(ctxt){for(var i=0;i<this.notations.length;i++)if(this.notations[i].hasLyrics()&&null!==this.notations[i].lyrics[0])return void(this.dropCap=this.notations[i].lyrics[0].generateDropCap(ctxt))}},{key:"performLayout",value:function(ctxt){if(this.needsLayout!==!1){ctxt.activeClef=this.startingClef,ctxt.notations=this.notations,ctxt.currNotationIndex=0,this.dropCap&&this.dropCap.recalculateMetrics(ctxt),this.annotation&&this.annotation.recalculateMetrics(ctxt);for(var i=0;i<this.notations.length;i++)this.notations[i].performLayout(ctxt),ctxt.currNotationIndex++;this.needsLayout=!1}}},{key:"performLayoutAsync",value:function(ctxt,finishedCallback){var _this7=this;return this.needsLayout===!1?void(finishedCallback&&setTimeout(function(){return finishedCallback()},0)):(ctxt.activeClef=this.startingClef,ctxt.notations=this.notations,ctxt.currNotationIndex=0,this.dropCap&&this.dropCap.recalculateMetrics(ctxt),this.annotation&&this.annotation.recalculateMetrics(ctxt),void setTimeout(function(){return _this7.layoutElementsAsync(ctxt,0,finishedCallback)},0))}},{key:"layoutElementsAsync",value:function(ctxt,index,finishedCallback){var _this8=this;if(index>=this.notations.length)return this.needsLayout=!1,void(finishedCallback&&setTimeout(function(){return finishedCallback()},0));0===index&&(ctxt.activeClef=this.startingClef);var timeout=(new Date).getTime()+50;do{var notation=this.notations[index];notation.needsLayout&&(ctxt.currNotationIndex=index,notation.performLayout(ctxt)),index++}while(index<this.notations.length&&(new Date).getTime()<timeout);setTimeout(function(){return _this8.layoutElementsAsync(ctxt,index,finishedCallback)},0)}},{key:"layoutChantLines",value:function(ctxt,width,finishedCallback){this.lines=[];var y=0,currIndex=0;ctxt.activeClef=this.startingClef;do{var line=new _ExsurgeChant.ChantLine(this);line.buildFromChantNotationIndex(ctxt,currIndex,width),currIndex=line.notationsStartIndex+line.numNotationsOnLine,line.performLayout(ctxt),this.lines.push(line),line.bounds.y=-line.bounds.y+y,y+=line.bounds.height+1.5*ctxt.staffInterval}while(currIndex<this.notations.length);var lastLine=this.lines[this.lines.length-1];this.bounds.x=0,this.bounds.y=0,this.bounds.width=lastLine.bounds.width,this.bounds.height=y,finishedCallback&&finishedCallback(this)}},{key:"draw",value:function(ctxt){var canvasCtxt=ctxt.canvasCtxt;canvasCtxt.clearRect(0,0,ctxt.canvas.width,ctxt.canvas.height),canvasCtxt.translate(this.bounds.x,this.bounds.y);for(var i=0;i<this.lines.length;i++)this.lines[i].draw(ctxt);canvasCtxt.translate(-this.bounds.x,-this.bounds.y)}},{key:"createSvg",value:function(ctxt){var fragment="";for(var def in ctxt.defs)ctxt.defs.hasOwnProperty(def)&&(fragment+=ctxt.defs[def]);fragment=_Exsurge2.QuickSvg.createFragment("defs",{},fragment);for(var i=0;i<this.lines.length;i++)fragment+=this.lines[i].createSvgFragment(ctxt);return fragment=_Exsurge2.QuickSvg.createFragment("g",{},fragment),fragment=_Exsurge2.QuickSvg.createFragment("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink","class":"ChantScore",width:this.bounds.width,height:this.bounds.height},fragment)}},{key:"unserializeFromJson",value:function(data){this.autoColoring=data["auto-coloring"],null!==data.annotation&&""!==data.annotation?this.annotation=new _Exsurge2.Annotation(ctxt,data.annotation):this.annotation=null;var createDropCap="auto"===data["drop-cap"];_Exsurge3.Gabc.parseChantNotations(data.notations,this,createDropCap)}},{key:"serializeToJson",value:function(){var data={};return data.type="score",data["auto-coloring"]=!0,null!==this.annotation?data.annotation=this.annotation.unsanitizedText:data.annotation="",data}}]),ChantScore}());exports.ChantDocument=function(){function ChantDocument(){_classCallCheck(this,ChantDocument);var defaults={layout:{units:"mm","default-font":{"font-family":"Crimson","font-size":14},page:{width:8.5,height:11,"margin-left":0,"margin-top":0,"margin-right":0,"margin-bottom":0}},scores:[]};this.copyLayout(this,defaults),this.scores=defaults.scores}return _createClass(ChantDocument,[{key:"copyLayout",value:function(to,from){to.layout={units:from.layout.units,"default-font":{"font-family":from.layout["default-font"]["font-family"],"font-size":from.layout["default-font"]["font-size"]},page:{width:from.layout.page.width,height:from.layout.page.height,"margin-left":from.layout.page["margin-left"],"margin-top":from.layout.page["margin-top"],"margin-right":from.layout.page["margin-right"],"margin-bottom":from.layout.page["margin-bottom"]}}}},{key:"unserializeFromJson",value:function(data){this.copyLayout(this,data),this.scores=[];for(var i=0;i<data.scores.length;i++){var score=new ChantScore;score.unserializeFromJson(data.scores[i]),this.scores.push(score)}}},{key:"serializeToJson",value:function(){var data={};this.copyLayout(data,this),data.scores=[];for(var i=0;i<this.scores.length;i++)data.scores.push(this.scores[i].serializeToJson());return data}}]),ChantDocument}()},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChantLine=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Exsurge=__webpack_require__(1),_Exsurge2=(_interopRequireWildcard(_Exsurge),__webpack_require__(4)),_Exsurge3=__webpack_require__(6),_Exsurge4=__webpack_require__(3),_ExsurgeChant=__webpack_require__(8),_ExsurgeChant2=__webpack_require__(9);exports.ChantLine=function(_ChantLayoutElement){function ChantLine(score){_classCallCheck(this,ChantLine);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(ChantLine).call(this));return _this.score=score,_this.notationsStartIndex=0,_this.numNotationsOnLine=0,_this.notationBounds=null,_this.staffLeft=0,_this.staffRight=0,_this.startingClef=null,_this.custos=null,_this.justify=!0,_this.ledgerLines=[],_this.braces=[],_this.nextLine=null,_this.previousLine=null,_this.lyricLineHeights=[],_this.lyricLineBaselines=[],_this.spaceAfterNotations=0,_this.spaceBetweenTextTracks=0,_this}return _inherits(ChantLine,_ChantLayoutElement),_createClass(ChantLine,[{key:"performLayout",value:function(ctxt){this.notationBounds=new _Exsurge.Rect(this.staffLeft,-3.1*ctxt.staffInterval,this.staffRight-this.staffLeft,6.2*ctxt.staffInterval);var i,notations=this.score.notations,lastIndex=this.notationsStartIndex+this.numNotationsOnLine,notation=null;for(this.notationBounds.union(this.startingClef.bounds),this.lyricLineHeights=[],this.lyricLineBaselines=[],i=this.notationsStartIndex;i<lastIndex;i++)for(notation=notations[i],this.notationBounds.union(notation.bounds),j=0;j<notation.lyrics.length;j++)this.lyricLineHeights.length<j+1&&(this.lyricLineHeights.push(0),this.lyricLineBaselines.push(0)),this.lyricLineHeights[j]=Math.max(this.lyricLineHeights[j],notation.lyrics[j].bounds.height),this.lyricLineBaselines[j]=Math.max(this.lyricLineBaselines[j],notation.lyrics[j].origin.y);for(this.custos&&this.notationBounds.union(this.custos.bounds),i=this.notationsStartIndex;i<lastIndex;i++){notation=notations[i];for(var offset=this.notationBounds.y+this.notationBounds.height,j=0;j<notation.lyrics.length;j++)notation.lyrics[j].bounds.y=offset+this.lyricLineBaselines[j],offset+=this.lyricLineHeights[j]}for(i=0;i<this.braces.length;i++)this.notationBounds.union(this.braces[i].bounds);var totalHeight=this.notationBounds.height;for(i=0;i<this.lyricLineHeights.length;i++)totalHeight+=this.lyricLineHeights[i];if(0===this.notationsStartIndex){if(null!==this.score.dropCap){var dropCapY;dropCapY=this.lyricLineHeights.length>0?this.notationBounds.y+this.notationBounds.height+this.lyricLineBaselines[0]:this.notationBounds.y+this.notationBounds.height,this.score.dropCap.bounds.x=this.staffLeft/2,this.score.dropCap.bounds.y=dropCapY}null!==this.score.annotation&&(this.score.annotation.bounds.x=this.staffLeft/2,this.score.annotation.bounds.y=3*-ctxt.staffInterval)}this.notationBounds.height+=ctxt.lyricTextSize,this.bounds.x=0,this.bounds.y=this.notationBounds.y,this.bounds.width=this.notationBounds.right(),this.bounds.height=totalHeight,this.origin=new _Exsurge.Point(this.staffLeft,(-this.notationBounds.y))}},{key:"draw",value:function(ctxt){var canvasCtxt=ctxt.canvasCtxt;canvasCtxt.translate(this.bounds.x,this.bounds.y);var i,y,x1=this.staffLeft,x2=this.staffRight;for(canvasCtxt.lineWidth=Math.round(ctxt.staffLineWeight),canvasCtxt.strokeStyle=ctxt.staffLineWeight,i=-3;i<=3;i+=2)y=Math.round(ctxt.staffInterval*i)+.5,canvasCtxt.beginPath(),canvasCtxt.moveTo(x1,y),canvasCtxt.lineTo(x2,y),canvasCtxt.stroke();for(i=0;i<this.ledgerLines.length;i++){var ledgerLine=this.ledgerLines[i];y=ctxt.calculateHeightFromStaffPosition(ledgerLine.staffPosition),canvasCtxt.beginPath(),canvasCtxt.moveTo(ledgerLine.x1,y),canvasCtxt.lineTo(ledgerLine.x2,y),canvasCtxt.stroke()}0===this.notationsStartIndex&&(null!==this.score.dropCap&&this.score.dropCap.draw(ctxt),null!==this.score.annotation&&this.score.annotation.draw(ctxt));var notations=this.score.notations,lastIndex=this.notationsStartIndex+this.numNotationsOnLine;for(i=this.notationsStartIndex;i<lastIndex;i++)notations[i].draw(ctxt);this.startingClef.draw(ctxt),this.custos&&this.custos.draw(ctxt),canvasCtxt.translate(-this.bounds.x,-this.bounds.y)}},{key:"createSvgFragment",value:function(ctxt){var i,inner="",x1=this.staffLeft,x2=this.staffRight;for(i=-3;i<=3;i+=2)inner+=_Exsurge2.QuickSvg.createFragment("line",{x1:x1,y1:ctxt.staffInterval*i,x2:x2,y2:ctxt.staffInterval*i,stroke:ctxt.staffLineColor,"stroke-width":ctxt.staffLineWeight,"class":"staffLine"});for(i=0;i<this.ledgerLines.length;i++){var ledgerLine=this.ledgerLines[i],y=ctxt.calculateHeightFromStaffPosition(ledgerLine.staffPosition);inner+=_Exsurge2.QuickSvg.createFragment("line",{x1:ledgerLine.x1,y1:y,x2:ledgerLine.x2,y2:y,stroke:ctxt.staffLineColor,"stroke-width":ctxt.staffLineWeight,"class":"ledgerLine"})}for(i=0;i<this.braces.length;i++)inner+=this.braces[i].createSvgFragment(ctxt);0===this.notationsStartIndex&&(null!==this.score.dropCap&&(inner+=this.score.dropCap.createSvgFragment(ctxt)),null!==this.score.annotation&&(inner+=this.score.annotation.createSvgFragment(ctxt))),inner+=this.startingClef.createSvgFragment(ctxt);var notations=this.score.notations,lastIndex=this.notationsStartIndex+this.numNotationsOnLine;for(i=this.notationsStartIndex;i<lastIndex;i++)inner+=notations[i].createSvgFragment(ctxt);return this.custos&&(inner+=this.custos.createSvgFragment(ctxt)),_Exsurge2.QuickSvg.createFragment("g",{"class":"chantLine",transform:"translate("+this.bounds.x+","+this.bounds.y+")"},inner)}},{key:"generateCurlyBraceDrawable",value:function(ctxt,x1,x2,y,isAbove){var h;h=isAbove?-ctxt.staffInterval/2:ctxt.staffInterval/2;var q=.6,len=x2-x1,qx1=x1,qy1=y+q*h,qx2=x1+.25*len,qy2=y+(1-q)*h,tx1=x1+.5*len,ty1=y+h,qx3=x2,qy3=y+q*h,qx4=x1+.75*len,qy4=y+(1-q)*h,d="M "+x1+" "+y+" Q "+qx1+" "+qy1+" "+qx2+" "+qy2+" T "+tx1+" "+ty1+" M "+x2+" "+y+" Q "+qx3+" "+qy3+" "+qx4+" "+qy4+" T "+tx1+" "+ty1;return _Exsurge2.QuickSvg.createFragment("path",{d:d,stroke:ctxt.neumeLineColor,"stroke-width":ctxt.neumeLineWeight+"px",fill:"none"})}},{key:"buildFromChantNotationIndex",value:function(ctxt,newElementStart,width){var notations=this.score.notations;if(this.notationsStartIndex=newElementStart,this.numNotationsOnLine=0,this.staffLeft=0,width>0?this.staffRight=width:this.staffRight=99999999,0===this.notationsStartIndex){var padding=0;null!==this.score.dropCap&&(padding=this.score.dropCap.bounds.width+2*this.score.dropCap.padding),null!==this.score.annotation&&(padding=Math.max(padding,this.score.annotation.bounds.width+4*this.score.annotation.padding)),this.staffLeft+=padding}notations[newElementStart].isClef&&(ctxt.activeClef=notations[newElementStart].clone(),newElementStart++,this.notationsStartIndex++),this.startingClef=ctxt.activeClef.clone(),this.startingClef.performLayout(ctxt),this.startingClef.bounds.x=this.staffLeft;var i,j,curr=this.startingClef,prev=null,prevWithLyrics=null,rightNotationBoundary=this.staffRight-_Exsurge4.Glyphs.CustosLong.bounds.width*ctxt.glyphScaling-4*ctxt.intraNeumeSpacing,lastNotationIndex=notations.length-1;for(i=newElementStart;i<=lastNotationIndex;i++){curr.hasLyrics()&&(prevWithLyrics=curr),prev=curr,curr=notations[i];var actualRightBoundary;actualRightBoundary=i===lastNotationIndex?this.staffRight:i===lastNotationIndex-1?Math.max(rightNotationBoundary,this.staffRight-notations[lastNotationIndex].bounds.width):rightNotationBoundary;var fitsOnLine=this.positionNotationElement(ctxt,prevWithLyrics,prev,curr,actualRightBoundary);if(fitsOnLine===!1){for(j=i-1;j>this.notationsStartIndex;j--){var cne=notations[j];if(!(cne.keepWithNext===!0||j===i-1&&curr.isDivider))break;this.numNotationsOnLine--}break}if(curr.chantLine=this,this.numNotationsOnLine++,curr.isClef&&(ctxt.activeClef=curr),curr.constructor.name===_Exsurge3.ChantLineBreak.name&&width>0){this.justify=curr.justify;break}}for(i=this.notationsStartIndex+this.numNotationsOnLine;i<notations.length;i++){var notation=notations[i];if(notation.isNeume){this.custos=new _ExsurgeChant.Custos((!0)),ctxt.currNotationIndex=i-1,this.custos.performLayout(ctxt),this.custos.bounds.x=this.staffRight-this.custos.bounds.width-this.custos.leadingSpace;break}}var last=notations[this.notationsStartIndex+this.numNotationsOnLine-1];width<=0?(this.staffRight=last.bounds.right(),this.justify=!1):this.notationsStartIndex+this.numNotationsOnLine===notations.length&&(this.justify=!0,this.justify=last.isDivider&&(this.staffRight-last.bounds.right())/this.staffRight<.1),this.justify===!0&&this.justifyElements(),this.finishLayout(ctxt)}},{key:"justifyElements",value:function(){var i,toJustify=[],notations=this.score.notations,lastIndex=this.notationsStartIndex+this.numNotationsOnLine,extraSpace=0;if(this.numNotationsOnLine>0){var last=notations[lastIndex-1],lastWithLyrics=null;for(i=lastIndex-1;i>=this.notationsStartIndex;i--)if(notations[i].hasLyrics()){lastWithLyrics=notations[i];break}extraSpace=lastWithLyrics?this.staffRight-Math.max(lastWithLyrics.getAllLyricsRight(),last.bounds.right()+last.trailingSpace):this.staffRight-(last.bounds.right()+last.trailingSpace)}if(this.custos&&(extraSpace-=this.custos.bounds.width+this.custos.leadingSpace),!(extraSpace<=0)){var prev=null,curr=null,prevWithLyrics=null;for(i=this.notationsStartIndex;i<lastIndex;i++)null!==curr&&curr.hasLyrics()&&(prevWithLyrics=curr),prev=curr,curr=notations[i],null!==prev&&prev.keepWithNext===!0||null!==prevWithLyrics&&prevWithLyrics.lyrics[0].allowsConnector()&&!prevWithLyrics.lyrics[0].needsConnector||curr.constructor.name!==_Exsurge3.ChantLineBreak.name&&toJustify.push(curr);if(0!==toJustify.length){var offset=0,increment=extraSpace/toJustify.length,toJustifyIndex=0;for(i=this.notationsStartIndex;i<lastIndex;i++)curr=notations[i],toJustifyIndex<toJustify.length&&toJustify[toJustifyIndex]===curr&&(offset+=increment,toJustifyIndex++),curr.bounds.x+=offset}}}},{key:"finishLayout",value:function(ctxt){var _this2=this;this.ledgerLines=[];for(var notations=this.score.notations,lastIndex=this.notationsStartIndex+this.numNotationsOnLine,processElementForLedgerLine=function(element){var offsetX=arguments.length<=1||void 0===arguments[1]?0:arguments[1],staffPosition=(arguments.length<=2||void 0===arguments[2]?0:arguments[2],element.staffPosition);if(staffPosition>=5||staffPosition<=-5){var x1=offsetX+element.bounds.x-ctxt.intraNeumeSpacing,x2=offsetX+element.bounds.x+element.bounds.width+ctxt.intraNeumeSpacing;staffPosition-=staffPosition>0?(staffPosition-1)%2:(staffPosition+1)%2;var minLedgerSeperation=5*ctxt.staffInterval;if(_this2.ledgerLines.length>0&&_this2.ledgerLines[_this2.ledgerLines.length-1].x2+minLedgerSeperation>=x1){var half=(x1-_this2.ledgerLines[_this2.ledgerLines.length-1].x2)/2;_this2.ledgerLines[_this2.ledgerLines.length-1].x2+=half,x1-=half}x2>_this2.staffRight&&(x2=_this2.staffRight),_this2.ledgerLines.push({x1:x1,x2:x2,staffPosition:staffPosition})}},epismata=[],startBrace=null,startBraceNotationIndex=0,minY=Number.MAX_VALUE,maxY=Number.MIN_VALUE,i=this.notationsStartIndex;i<lastIndex;i++)if(minY=Math.min(minY,notations[i].bounds.y),maxY=Math.max(maxY,notations[i].bounds.bottom()),notations[i].constructor.name!==_ExsurgeChant.Custos.name){if(notations[i].isNeume)for(var neume=notations[i],j=0;j<neume.notes.length;j++){var k,note=neume.notes[j];for(processElementForLedgerLine(note,neume.bounds.x,neume.bounds.y),k=0;k<note.epismata.length;k++){var episema=note.epismata[k],spaceBetweenEpismata=0;if(epismata.length>0&&(spaceBetweenEpismata=neume.bounds.x+episema.bounds.x-(epismata[epismata.length-1].note.neume.bounds.x+epismata[epismata.length-1].bounds.right())),0===epismata.length||epismata[epismata.length-1].positionHint!==episema.positionHint||epismata[epismata.length-1].terminating===!0||epismata[epismata.length-1].alignment===_ExsurgeChant2.HorizontalEpisemaAlignment.Left||episema.alignment===_ExsurgeChant2.HorizontalEpisemaAlignment.Right||spaceBetweenEpismata>2*ctxt.intraNeumeSpacing)epismata=[],epismata.push(episema);else{var newY;if(newY=episema.positionHint===_ExsurgeChant2.MarkingPositionHint.Below?Math.max(episema.bounds.y,epismata[epismata.length-1].bounds.y):Math.min(episema.bounds.y,epismata[epismata.length-1].bounds.y),episema.bounds.y!==newY)episema.bounds.y=newY;else for(var l=0;l<epismata.length;l++)epismata[l].bounds.y=newY;var newWidth=neume.bounds.x+episema.bounds.x-(epismata[epismata.length-1].note.neume.bounds.x+epismata[epismata.length-1].bounds.x);epismata[epismata.length-1].bounds.width=newWidth,epismata.push(episema)}}if(note.braceEnd){var y,dy=ctxt.intraNeumeSpacing/2;if(startBrace.isAbove)for(y=ctxt.calculateHeightFromStaffPosition(4),k=startBraceNotationIndex;k<=i;k++)y=Math.min(y,notations[k].bounds.y-dy);else for(y=ctxt.calculateHeightFromStaffPosition(-4),k=startBraceNotationIndex;k<=i;k++)y=Math.max(y,notations[k].bounds.y+dy);if(null===startBrace);else{var addAcuteAccent=!1;startBrace.shape===_ExsurgeChant2.BraceShape.RoundBrace?this.braces.push(new _Exsurge2.RoundBraceVisualizer(ctxt,startBrace.getAttachmentX(),note.braceEnd.getAttachmentX(),y,startBrace.isAbove)):(startBrace.shape===_ExsurgeChant2.BraceShape.AccentedCurlyBrace&&(addAcuteAccent=!0),this.braces.push(new _Exsurge2.CurlyBraceVisualizer(ctxt,startBrace.getAttachmentX(),note.braceEnd.getAttachmentX(),y,startBrace.isAbove,addAcuteAccent)))}}note.braceStart&&(startBrace=note.braceStart,startBraceNotationIndex=i),null!==startBrace&&(startBrace.isAbove?startBrace.bounds.y=Math.min(startBrace.bounds.y,note.bounds.y):startBrace.bounds.y=Math.max(startBrace.bounds.y,note.bounds.bottom()))}}else processElementForLedgerLine(notations[i]);null!==startBrace&&(startBrace=startBrace),this.custos&&processElementForLedgerLine(this.custos)}},{key:"positionNotationElement",value:function(ctxt,prevWithLyrics,prev,curr,rightNotationBoundary){var i;if(curr.bounds.x=prev.bounds.right()+prev.trailingSpace,null===prevWithLyrics){var maxRight=curr.bounds.right()+curr.trailingSpace;for(i=0;i<curr.lyrics.length;i++)curr.lyrics[i].setNeedsConnector(!1),curr.getLyricLeft(i)<0&&(curr.bounds.x+=-curr.getLyricLeft(i)),maxRight=Math.max(maxRight,curr.getLyricRight(i));return!(maxRight>rightNotationBoundary)}if(curr.hasLyrics()===!1){for(i=0;i<prevWithLyrics.lyrics.length;i++)null!==prevWithLyrics.lyrics[i]&&prevWithLyrics.lyrics[i].allowsConnector()&&prevWithLyrics.lyrics[i].setNeedsConnector(!0);return curr.bounds.right()+curr.trailingSpace<rightNotationBoundary}var lyricCount=Math.max(prevWithLyrics.lyrics.length,curr.lyrics.length);if(lyricCount>1){var prevLyricRightMax=Number.MIN_VALUE,currLyricLeftMin=Number.MAX_VALUE,currLyricRightMax=Number.MIN_VALUE;
for(i=0;i<lyricCount;i++){if(i<prevWithLyrics.lyrics.length&&null!==prevWithLyrics.lyrics[i]){var right=prevWithLyrics.getLyricRight(i);prevWithLyrics.lyrics[i].allowsConnector()?(prevWithLyrics.lyrics[i].setNeedsConnector(!0),right+=prevWithLyrics.lyrics[i].widthWithConnector-prevWithLyrics.lyrics[i].widthWithoutConnector):right+=ctxt.minLyricWordSpacing,prevLyricRightMax=Math.max(prevLyricRightMax,right)}i<curr.lyrics.length&&null!==curr.lyrics[i]&&(currLyricLeftMin=Math.min(currLyricLeftMin,curr.getLyricLeft(i)),currLyricRightMax=Math.max(currLyricRightMax,curr.getLyricRight(i)))}return prevLyricRightMax>currLyricLeftMin&&(curr.bounds.x+=prevLyricRightMax-currLyricLeftMin,currLyricRightMax+=prevLyricRightMax-currLyricLeftMin),curr.bounds.right()<rightNotationBoundary&&currLyricRightMax<=this.staffRight||(curr.bounds.x=0,!1)}curr.lyrics[0].setNeedsConnector(!1);var currLyricLeft=curr.getLyricLeft(0),prevLyricRight=prevWithLyrics.getLyricRight(0);return prevWithLyrics.lyrics[0].allowsConnector()===!1?prevLyricRight+ctxt.minLyricWordSpacing>currLyricLeft&&(curr.bounds.x+=prevLyricRight+ctxt.minLyricWordSpacing-currLyricLeft):prevLyricRight>currLyricLeft?curr.bounds.x+=prevLyricRight-currLyricLeft:(prevWithLyrics.lyrics[0].setNeedsConnector(!0),prevLyricRight=prevWithLyrics.getLyricRight(0),prevLyricRight>currLyricLeft&&(curr.bounds.x+=prevLyricRight-currLyricLeft)),curr.bounds.right()+curr.trailingSpace<rightNotationBoundary&&curr.getLyricRight(0)<=this.staffRight||(prevWithLyrics.hasLyrics()&&prevWithLyrics.lyrics[0].allowsConnector()&&prevWithLyrics.lyrics[0].setNeedsConnector(!0),!1)}}]),ChantLine}(_Exsurge2.ChantLayoutElement)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Virgula=exports.Accidental=exports.AccidentalType=exports.DoubleBar=exports.FullBar=exports.HalfBar=exports.QuarterBar=exports.Divider=exports.Custos=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_Exsurge=__webpack_require__(1),_Exsurge2=(_interopRequireWildcard(_Exsurge),__webpack_require__(4)),Divider=(exports.Custos=function(_ChantNotationElement){function Custos(){var auto=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];_classCallCheck(this,Custos);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Custos).call(this));return _this.auto=auto,_this.staffPosition=0,_this}return _inherits(Custos,_ChantNotationElement),_createClass(Custos,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Custos.prototype),"performLayout",this).call(this,ctxt);if(this.auto){var neume=ctxt.findNextNeume();neume&&(this.staffPosition=ctxt.activeClef.pitchToStaffPosition(neume.notes[0].pitch))}var glyph=new _Exsurge2.GlyphVisualizer(ctxt,Custos.getGlyphCode(this.staffPosition));glyph.setStaffPosition(ctxt,this.staffPosition),this.addVisualizer(glyph),this.finishLayout(ctxt)}},{key:"resetDependencies",value:function(){this.auto&&(this.needsLayout=!0)}}],[{key:"getGlyphCode",value:function(staffPosition){return staffPosition<=2?Math.abs(staffPosition)%2===1?_Exsurge2.GlyphCode.CustosLong:_Exsurge2.GlyphCode.CustosShort:Math.abs(staffPosition)%2===1?_Exsurge2.GlyphCode.CustosDescLong:_Exsurge2.GlyphCode.CustosDescShort}}]),Custos}(_Exsurge2.ChantNotationElement),exports.Divider=function(_ChantNotationElement2){function Divider(){_classCallCheck(this,Divider);var _this2=_possibleConstructorReturn(this,Object.getPrototypeOf(Divider).call(this));return _this2.isDivider=!0,_this2.resetsAccidentals=!0,_this2}return _inherits(Divider,_ChantNotationElement2),Divider}(_Exsurge2.ChantNotationElement)),AccidentalType=(exports.QuarterBar=function(_Divider){function QuarterBar(){return _classCallCheck(this,QuarterBar),_possibleConstructorReturn(this,Object.getPrototypeOf(QuarterBar).apply(this,arguments))}return _inherits(QuarterBar,_Divider),_createClass(QuarterBar,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(QuarterBar.prototype),"performLayout",this).call(this,ctxt),this.addVisualizer(new _Exsurge2.DividerLineVisualizer(ctxt,2,4)),this.origin.x=this.bounds.width/2,this.finishLayout(ctxt)}}]),QuarterBar}(Divider),exports.HalfBar=function(_Divider2){function HalfBar(){return _classCallCheck(this,HalfBar),_possibleConstructorReturn(this,Object.getPrototypeOf(HalfBar).apply(this,arguments))}return _inherits(HalfBar,_Divider2),_createClass(HalfBar,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(HalfBar.prototype),"performLayout",this).call(this,ctxt),this.addVisualizer(new _Exsurge2.DividerLineVisualizer(ctxt,(-2),2)),this.origin.x=this.bounds.width/2,this.finishLayout(ctxt)}}]),HalfBar}(Divider),exports.FullBar=function(_Divider3){function FullBar(){return _classCallCheck(this,FullBar),_possibleConstructorReturn(this,Object.getPrototypeOf(FullBar).apply(this,arguments))}return _inherits(FullBar,_Divider3),_createClass(FullBar,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(FullBar.prototype),"performLayout",this).call(this,ctxt),this.addVisualizer(new _Exsurge2.DividerLineVisualizer(ctxt,(-3),3)),this.origin.x=this.bounds.width/2,this.finishLayout(ctxt)}}]),FullBar}(Divider),exports.DoubleBar=function(_Divider4){function DoubleBar(){return _classCallCheck(this,DoubleBar),_possibleConstructorReturn(this,Object.getPrototypeOf(DoubleBar).apply(this,arguments))}return _inherits(DoubleBar,_Divider4),_createClass(DoubleBar,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(DoubleBar.prototype),"performLayout",this).call(this,ctxt);var line0=new _Exsurge2.DividerLineVisualizer(ctxt,(-3),3);line0.bounds.x=0,this.addVisualizer(line0);var line1=new _Exsurge2.DividerLineVisualizer(ctxt,(-3),3);line1.bounds.x=2*ctxt.intraNeumeSpacing,this.addVisualizer(line1),this.origin.x=this.bounds.width/2,this.finishLayout(ctxt)}}]),DoubleBar}(Divider),exports.AccidentalType={Flat:-1,Natural:0,Sharp:1});exports.Accidental=function(_ChantNotationElement3){function Accidental(staffPosition,accidentalType){_classCallCheck(this,Accidental);var _this7=_possibleConstructorReturn(this,Object.getPrototypeOf(Accidental).call(this));return _this7.isAccidental=!0,_this7.keepWithNext=!0,_this7.staffPosition=staffPosition,_this7.accidentalType=accidentalType,_this7}return _inherits(Accidental,_ChantNotationElement3),_createClass(Accidental,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Accidental.prototype),"performLayout",this).call(this,ctxt),this.addVisualizer(this.createGlyphVisualizer(ctxt)),this.finishLayout(ctxt)}},{key:"createGlyphVisualizer",value:function(ctxt){var glyphCode=_Exsurge2.GlyphCode.Flat;switch(this.accidentalType){case AccidentalType.Natural:glyphCode=_Exsurge2.GlyphCode.Natural;break;case AccidentalType.Sharp:glyphCode=_Exsurge2.GlyphCode.Sharp;break;default:glyphCode=_Exsurge2.GlyphCode.Flat}var glyph=new _Exsurge2.GlyphVisualizer(ctxt,glyphCode);return glyph.setStaffPosition(ctxt,this.staffPosition),glyph}},{key:"adjustStep",value:function(step){switch(this.accidentalType){case AccidentalType.Flat:if(step===Step.Ti)return Step.Te;if(step===Step.Mi)return Step.Me;break;case AccidentalType.Sharp:if(step===Step.Do)return Step.Du;if(step===Step.Fa)return Step.Fu;break;case AccidentalType.Natural:if(step===Step.Te)return Step.Ti;if(step===Step.Me)return Step.Mi;if(step===Step.Du)return Step.Do;if(step===Step.Fu)return Step.Fa}return step}},{key:"applyToPitch",value:function(pitch){this.octave===pitch.octave&&(pitch.step=this.adjustStep(pitch.step))}}]),Accidental}(_Exsurge2.ChantNotationElement),exports.Virgula=function(_Divider5){function Virgula(){_classCallCheck(this,Virgula);var _this8=_possibleConstructorReturn(this,Object.getPrototypeOf(Virgula).call(this));return _this8.resetsAccidentals=!1,_this8.staffPosition=3,_this8}return _inherits(Virgula,_Divider5),_createClass(Virgula,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Virgula.prototype),"performLayout",this).call(this,ctxt);var glyph=new _Exsurge2.GlyphVisualizer(ctxt,_Exsurge2.GlyphCode.Virgula);glyph.setStaffPosition(ctxt,this.staffPosition),this.addVisualizer(glyph),this.origin.x=this.bounds.width/2,this.finishLayout(ctxt)}}]),Virgula}(Divider)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.BracePoint=exports.BraceAttachment=exports.BraceShape=exports.Mora=exports.Ictus=exports.HorizontalEpisema=exports.HorizontalEpisemaAlignment=exports.AcuteAccent=exports.MarkingPositionHint=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Exsurge=__webpack_require__(1),_Exsurge2=(_interopRequireWildcard(_Exsurge),__webpack_require__(4)),MarkingPositionHint=(__webpack_require__(6),exports.MarkingPositionHint={Default:0,Above:1,Below:2}),HorizontalEpisemaAlignment=(exports.AcuteAccent=function(_GlyphVisualizer){function AcuteAccent(ctxt,note){_classCallCheck(this,AcuteAccent);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(AcuteAccent).call(this,ctxt,_Exsurge2.GlyphCode.AcuteAccent));return _this.note=note,_this.positionHint=MarkingPositionHint.Above,_this}return _inherits(AcuteAccent,_GlyphVisualizer),_createClass(AcuteAccent,[{key:"performLayout",value:function(ctxt){this.bounds.x+=this.bounds.width/2,this.setStaffPosition(ctxt,Math.max(this.note.staffPosition+1,4))}}]),AcuteAccent}(_Exsurge2.GlyphVisualizer),exports.HorizontalEpisemaAlignment={Default:0,Left:1,Center:2,Right:3}),BraceAttachment=(exports.HorizontalEpisema=function(_ChantLayoutElement){function HorizontalEpisema(note){_classCallCheck(this,HorizontalEpisema);var _this2=_possibleConstructorReturn(this,Object.getPrototypeOf(HorizontalEpisema).call(this));return _this2.note=note,_this2.positionHint=MarkingPositionHint.Default,_this2.terminating=!1,_this2.alignment=HorizontalEpisemaAlignment.Default,_this2}return _inherits(HorizontalEpisema,_ChantLayoutElement),_createClass(HorizontalEpisema,[{key:"performLayout",value:function(ctxt){var step,y=0,minDistanceAway=.4*ctxt.staffInterval;this.positionHint===MarkingPositionHint.Below?(y=this.note.bounds.bottom()+minDistanceAway,step=Math.floor(y/ctxt.staffInterval),1===Math.abs(step%2)&&(step+=1)):(y=this.note.bounds.y-minDistanceAway,step=Math.ceil(y/ctxt.staffInterval),1===Math.abs(step%2)&&(step-=1)),y=step*ctxt.staffInterval;var width,glyphCode=this.note.glyphVisualizer.glyphCode;width=glyphCode===_Exsurge2.GlyphCode.Porrectus1||glyphCode===_Exsurge2.GlyphCode.Porrectus2||glyphCode===_Exsurge2.GlyphCode.Porrectus3||glyphCode===_Exsurge2.GlyphCode.Porrectus4?ctxt.staffInterval:this.note.bounds.width;var x=this.note.bounds.x;this.alignment===HorizontalEpisemaAlignment.Left?width*=.8:this.alignment===HorizontalEpisemaAlignment.Center?(x+=.2*width,width*=.6):this.alignment===HorizontalEpisemaAlignment.Right&&(x+=.2*width,width*=.8),this.bounds.x=x,this.bounds.y=y,this.bounds.width=width,this.bounds.height=ctxt.episemaLineWeight,this.origin.x=0,this.origin.y=0}},{key:"createSvgFragment",value:function(ctxt){return _Exsurge2.QuickSvg.createFragment("rect",{x:this.bounds.x,y:this.bounds.y,width:this.bounds.width,height:this.bounds.height,fill:ctxt.neumeLineColor,"class":"horizontalEpisema"})}}]),HorizontalEpisema}(_Exsurge2.ChantLayoutElement),exports.Ictus=function(_GlyphVisualizer2){function Ictus(ctxt,note){_classCallCheck(this,Ictus);var _this3=_possibleConstructorReturn(this,Object.getPrototypeOf(Ictus).call(this,ctxt,_Exsurge2.GlyphCode.VerticalEpisemaAbove));return _this3.note=note,_this3.positionHint=MarkingPositionHint.Default,_this3}return _inherits(Ictus,_GlyphVisualizer2),_createClass(Ictus,[{key:"performLayout",value:function(ctxt){var glyphCode;glyphCode=this.positionHint===MarkingPositionHint.Above?_Exsurge2.GlyphCode.VerticalEpisemaAbove:_Exsurge2.GlyphCode.VerticalEpisemaBelow;var staffPosition=this.note.staffPosition,horizontalOffset=this.note.bounds.width/2,verticalOffset=0;switch(glyphCode){case _Exsurge2.GlyphCode.VerticalEpisemaAbove:verticalOffset-=staffPosition%2===0?1.5*ctxt.staffInterval:.9*ctxt.staffInterval;break;case _Exsurge2.GlyphCode.VerticalEpisemaBelow:default:verticalOffset+=staffPosition%2===0?1.5*ctxt.staffInterval:.8*ctxt.staffInterval}this.setGlyph(ctxt,glyphCode),this.setStaffPosition(ctxt,staffPosition),this.bounds.x=this.note.bounds.x+horizontalOffset-this.origin.x,this.bounds.y+=verticalOffset}}]),Ictus}(_Exsurge2.GlyphVisualizer),exports.Mora=function(_GlyphVisualizer3){function Mora(ctxt,note){_classCallCheck(this,Mora);var _this4=_possibleConstructorReturn(this,Object.getPrototypeOf(Mora).call(this,ctxt,_Exsurge2.GlyphCode.Mora));return _this4.note=note,_this4.positionHint=MarkingPositionHint.Default,_this4.horizontalOffset=0,_this4}return _inherits(Mora,_GlyphVisualizer3),_createClass(Mora,[{key:"performLayout",value:function(ctxt){var staffPosition=this.note.staffPosition;this.setStaffPosition(ctxt,staffPosition);var verticalOffset=0;this.positionHint===MarkingPositionHint.Above?verticalOffset-=staffPosition%2===0?ctxt.staffInterval+.75*ctxt.staffInterval:.75*ctxt.staffInterval:this.positionHint===MarkingPositionHint.Below?verticalOffset+=staffPosition%2===0?ctxt.staffInterval+.75*ctxt.staffInterval:.75*ctxt.staffInterval:Math.abs(staffPosition)%2===1&&(verticalOffset-=.75*ctxt.staffInterval),this.bounds.x+=this.horizontalOffset+this.note.bounds.right()+ctxt.staffInterval/4,this.bounds.y+=verticalOffset}}]),Mora}(_Exsurge2.GlyphVisualizer),exports.BraceShape={RoundBrace:0,CurlyBrace:1,AccentedCurlyBrace:2},exports.BraceAttachment={Left:0,Right:1});exports.BracePoint=function(_ChantLayoutElement2){function BracePoint(note,isAbove,shape,attachment){_classCallCheck(this,BracePoint);var _this5=_possibleConstructorReturn(this,Object.getPrototypeOf(BracePoint).call(this));return _this5.note=note,_this5.isAbove=isAbove,_this5.shape=shape,_this5.attachment=attachment,_this5}return _inherits(BracePoint,_ChantLayoutElement2),_createClass(BracePoint,[{key:"getAttachmentX",value:function(){return this.attachment===BraceAttachment.Left?this.note.neume.bounds.x+this.note.bounds.x:this.note.neume.bounds.x+this.note.bounds.right()}}]),BracePoint}(_Exsurge2.ChantLayoutElement)},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Gabc=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Exsurge=__webpack_require__(1),_Exsurge2=__webpack_require__(4),_Exsurge3=__webpack_require__(6),_ExsurgeChant=__webpack_require__(9),Markings=_interopRequireWildcard(_ExsurgeChant),_ExsurgeChant2=__webpack_require__(8),Signs=_interopRequireWildcard(_ExsurgeChant2),_ExsurgeChant3=__webpack_require__(11),Neumes=_interopRequireWildcard(_ExsurgeChant3),__syllablesRegex=/(?=.)((?:[^(])*)(?:\(?([^)]*)\)?)?/g,__notationsRegex=/z0|z|Z|::|:|;|,|`|c1|c2|c3|c4|f3|f4|cb3|cb4|\/\/|\/| |\!|-?[a-mA-M][oOwWvVrRsxy#~\+><_\.'012345]*(?:\[[^\]]*\]?)*/g,__braceSpecRegex=/([ou])(b|cb|cba):([01])(?:([{}])|;(\d*(?:\.\d+)?)mm)/;exports.Gabc=function(){function Gabc(){_classCallCheck(this,Gabc)}return _createClass(Gabc,null,[{key:"createMappingsFromSource",value:function(ctxt,gabcSource){var words=this.splitWords(gabcSource);ctxt.activeClef=_Exsurge3.Clef["default"]();var mappings=this.createMappingsFromWords(ctxt,words,function(clef){return ctxt.activeClef=clef});return mappings.length>0&&mappings[mappings.length-1].notations.length>0&&(mappings[mappings.length-1].notations[mappings[mappings.length-1].notations.length-1].trailingSpace=0),mappings}},{key:"diffDescriptorsAndNewWords",value:function(before,after){var i,oldIndexMap={};for(i=0;i<before.length;i++)oldIndexMap[before[i].source]=oldIndexMap[before[i].source]||[],oldIndexMap[before[i].source].push(i);var startOld,startNew,subLength,inew,overlap=[];for(startOld=startNew=subLength=0,inew=0;inew<after.length;inew++){var _overlap=[];for(oldIndexMap[after[inew]]=oldIndexMap[after[inew]]||[],i=0;i<oldIndexMap[after[inew]].length;i++){var iold=oldIndexMap[after[inew]][i];_overlap[iold]=(iold&&overlap[iold-1]||0)+1,_overlap[iold]>subLength&&(subLength=_overlap[iold],startOld=iold-subLength+1,startNew=inew-subLength+1)}overlap=_overlap}if(0===subLength){var result=[];return before.length&&result.push(["-",before]),after.length&&result.push(["+",after]),result}return[].concat(this.diffDescriptorsAndNewWords(before.slice(0,startOld),after.slice(0,startNew)),[["=",after.slice(startNew,startNew+subLength)]],this.diffDescriptorsAndNewWords(before.slice(startOld+subLength),after.slice(startNew+subLength)))}},{key:"updateMappingsFromSource",value:function(ctxt,mappings,newGabcSource){mappings.pop();var j,k,newWords=this.splitWords(newGabcSource),results=this.diffDescriptorsAndNewWords(mappings,newWords),index=0;ctxt.activeClef=_Exsurge3.Clef["default"]();for(var i=0;i<results.length;i++){var resultCode=results[i][0],resultValues=results[i][1];if("="===resultCode)for(j=0;j<resultValues.length;j++,index++)for(k=0;k<mappings[index].notations.length;k++)mappings[index].notations[k].resetDependencies(),mappings[index].notations[k].isClef&&(ctxt.activeClef=mappings[index].notations[k]);else if("-"===resultCode)mappings.splice(index,resultValues.length);else if("+"===resultCode)for(j=0;j<resultValues.length;j++){var mapping=this.createMappingFromWord(ctxt,resultValues[j]);for(k=0;k<mapping.notations.length;k++)mapping.notations[k].isClef&&(ctxt.activeClef=mapping.notations[k]);mappings.splice(index++,0,mapping)}}mappings.length>0&&mappings[mappings.length-1].notations.length>0&&(mappings[mappings.length-1].notations[mappings[mappings.length-1].notations.length-1].trailingSpace=0)}},{key:"createMappingsFromWords",value:function(ctxt,words){for(var mappings=[],i=0;i<words.length;i++){var word=words[i].trim();if(""!==word){var mapping=this.createMappingFromWord(ctxt,word);mapping&&mappings.push(mapping)}}return mappings}},{key:"createMappingFromWord",value:function(ctxt,word){for(var matches=[],notations=[],currSyllable=0;match=__syllablesRegex.exec(word);)matches.push(match);for(var j=0;j<matches.length;j++){var match=matches[j],lyricText=match[1].trim(),notationData=match[2],items=this.parseNotations(ctxt,notationData);if(0!==items.length&&(notations=notations.concat(items),""!==lyricText)){for(var notationWithLyrics=null,i=0;i<items.length;i++){var cne=items[i];if(!cne.isAccidental&&cne.constructor.name!==Signs.Custos.name){notationWithLyrics=cne;break}}if(null===notationWithLyrics)return notations;var proposedLyricType;proposedLyricType=cne.isNeume||cne.constructor.name===_Exsurge3.TextOnly.name?0===currSyllable&&j===matches.length-1?_Exsurge2.LyricType.SingleSyllable:0===currSyllable&&j<matches.length-1?_Exsurge2.LyricType.BeginningSyllable:j===matches.length-1?_Exsurge2.LyricType.EndingSyllable:_Exsurge2.LyricType.MiddleSyllable:_Exsurge2.LyricType.Directive,currSyllable++,proposedLyricType!==_Exsurge2.LyricType.BeginningSyllable&&proposedLyricType!==_Exsurge2.LyricType.SingleSyllable||ctxt.activeClef.resetAccidentals();var lyrics=this.createSyllableLyrics(ctxt,lyricText,proposedLyricType);null!==lyrics&&0!==lyrics.length&&(notationWithLyrics.lyrics=lyrics)}}return new _Exsurge3.ChantMapping(word,notations)}},{key:"createSyllableLyrics",value:function(ctxt,text,proposedLyricType){for(var lyrics=[],lyricTexts=text.split("|"),i=0;i<lyricTexts.length;i++){var lyricText=lyricTexts[i],centerStartIndex=lyricText.indexOf("{"),centerLength=0;if(centerStartIndex>=0){var indexClosingBracket=lyricText.indexOf("}");indexClosingBracket>=0&&indexClosingBracket>centerStartIndex?(centerLength=indexClosingBracket-centerStartIndex-1,lyricText=lyricText.substring(0,centerStartIndex)+lyricText.substring(centerStartIndex+1,indexClosingBracket)+lyricText.substring(indexClosingBracket+1,lyricText.length)):centerStartIndex=-1}var lyric=this.makeLyric(ctxt,lyricText,proposedLyricType);centerStartIndex>=0&&(lyric.centerStartIndex=centerStartIndex,lyric.centerLength=centerLength),lyrics.push(lyric)}return lyrics}},{key:"makeLyric",value:function(ctxt,text,lyricType){text.length>1&&"-"===text[text.length-1]&&(lyricType===_Exsurge2.LyricType.EndingSyllable?lyricType=_Exsurge2.LyricType.MiddleSyllable:lyricType===_Exsurge2.LyricType.SingleSyllable&&(lyricType=_Exsurge2.LyricType.BeginningSyllable),text=text.substring(0,text.length-1));var elides=!1;text.length>1&&"_"===text[text.length-1]&&(elides=!0,text=text.substring(0,text.length-1)),"*"!==text&&"†"!==text||(lyricType=_Exsurge2.LyricType.Directive);var lyric=new _Exsurge2.Lyric(ctxt,text,lyricType);return lyric.elidesToNext=elides,lyric}},{key:"parseNotations",value:function(ctxt,data){var _this=this;if(!data)return[new _Exsurge3.TextOnly];var notations=[],notes=[],trailingSpace=-1,addNotation=function(notation){if(notes.length>0){for(var neumes=_this.createNeumesFromNotes(ctxt,notes,trailingSpace),i=0;i<neumes.length;i++)notations.push(neumes[i]);trailingSpace=-1,notes=[]}null!==notation&&(notation.isClef?ctxt.activeClef=notation:notation.isAccidental?ctxt.activeClef.activeAccidental=notation:notation.resetsAccidentals&&ctxt.activeClef.resetAccidentals(),notations.push(notation))},atoms=data.match(__notationsRegex);if(null===atoms)return notations;for(var i=0;i<atoms.length;i++){var atom=atoms[i];switch(atom){case",":addNotation(new Signs.QuarterBar);break;case"`":addNotation(new Signs.Virgula);break;case";":addNotation(new Signs.HalfBar);break;case":":addNotation(new Signs.FullBar);break;case"::":addNotation(new Signs.DoubleBar);break;case"c1":addNotation(ctxt.activeClef=new _Exsurge3.DoClef((-3),2));break;case"c2":addNotation(ctxt.activeClef=new _Exsurge3.DoClef((-1),2));break;case"c3":addNotation(ctxt.activeClef=new _Exsurge3.DoClef(1,2));break;case"c4":addNotation(ctxt.activeClef=new _Exsurge3.DoClef(3,2));break;case"f3":addNotation(ctxt.activeClef=new _Exsurge3.FaClef(1,2));break;case"f4":addNotation(ctxt.activeClef=new _Exsurge3.FaClef(3,2));break;case"cb3":addNotation(ctxt.activeClef=new _Exsurge3.DoClef(1,2,new Signs.Accidental(0,Signs.AccidentalType.Flat)));break;case"cb4":addNotation(ctxt.activeClef=new _Exsurge3.DoClef(3,2,new Signs.Accidental(2,Signs.AccidentalType.Flat)));break;case"z":addNotation(new _Exsurge3.ChantLineBreak((!0)));break;case"Z":addNotation(new _Exsurge3.ChantLineBreak((!1)));break;case"z0":addNotation(new Signs.Custos((!0)));break;case"!":trailingSpace=0,addNotation(null);break;case"/":trailingSpace=ctxt.intraNeumeSpacing,addNotation(null);break;case"//":trailingSpace=2*ctxt.intraNeumeSpacing,addNotation(null);break;case" ":trailingSpace=2*ctxt.intraNeumeSpacing,addNotation(null);break;default:if(atom.length>1&&"+"===atom[1]){var custos=new Signs.Custos;custos.staffPosition=this.gabcHeightToExsurgeHeight(data[0]),addNotation(custos)}else if(atom.length>1&&("x"===atom[1]||"y"===atom[1]||"#"===atom[1])){var accidentalType;switch(atom[1]){case"y":accidentalType=Signs.AccidentalType.Natural;break;case"#":accidentalType=Signs.AccidentalType.Sharp;break;default:accidentalType=Signs.AccidentalType.Flat}var noteArray=[];this.createNoteFromData(ctxt,ctxt.activeClef,atom,noteArray);var accidental=new Signs.Accidental(noteArray[0].staffPosition,accidentalType);accidental.trailingSpace=2*ctxt.intraNeumeSpacing,ctxt.activeClef.activeAccidental=accidental,addNotation(accidental)}else this.createNoteFromData(ctxt,ctxt.activeClef,atom,notes)}}return addNotation(null),notations}},{key:"createNeumesFromNotes",value:function(ctxt,notes,finalTrailingSpace){for(var neumes=[],firstNoteIndex=0,currNoteIndex=0,createNeume=function(neume,includeCurrNote){var lastNoteIndex,includePrevNote=arguments.length<=2||void 0===arguments[2]||arguments[2];if(lastNoteIndex=includeCurrNote?currNoteIndex:includePrevNote?currNoteIndex-1:currNoteIndex-2,!(lastNoteIndex<0)){for(;firstNoteIndex<=lastNoteIndex;)neume.addNote(notes[firstNoteIndex++]);return neumes.push(neume),includeCurrNote===!1&&(currNoteIndex--,includePrevNote===!1&&currNoteIndex--,neume.keepWithNext=!0,neume.trailingSpace=ctxt.intraNeumeSpacing),unknownState}},unknownState={neume:function(){return new Neumes.Punctum},handle:function(currNote,prevNote){return currNote.shape===_Exsurge3.NoteShape.Virga?virgaState:currNote.shape===_Exsurge3.NoteShape.Stropha?apostrophaState:currNote.shape===_Exsurge3.NoteShape.Oriscus?oriscusState:currNote.shape===_Exsurge3.NoteShape.Inclinatum?punctaInclinataState:currNote.shapeModifiers&_Exsurge3.NoteShapeModifiers.Cavum?createNeume(new Neumes.Punctum,!0):punctumState}},punctumState={neume:function(){return new Neumes.Punctum},handle:function(currNote,prevNote){return currNote.staffPosition>prevNote.staffPosition?podatusState:currNote.staffPosition<prevNote.staffPosition?currNote.shape===_Exsurge3.NoteShape.Inclinatum?climacusState:clivisState:distrophaState}},punctaInclinataState={neume:function(){return new Neumes.PunctaInclinata},handle:function(){return currNote.shape!==_Exsurge3.NoteShape.Inclinatum?createNeume(new Neumes.PunctaInclinata,!1):punctaInclinataState}},oriscusState={neume:function(){return new Neumes.Oriscus},handle:function(currNote,prevNote){return currNote.shape!==_Exsurge3.NoteShape.Default?createNeume(new Neumes.Oriscus,!0):currNote.staffPosition>prevNote.staffPosition?(prevNote.shapeModifiers|=_Exsurge3.NoteShapeModifiers.Ascending,createNeume(new Neumes.PesQuassus,!0)):currNote.staffPosition<prevNote.staffPosition?(prevNote.shapeModifiers|=_Exsurge3.NoteShapeModifiers.Descending,createNeume(new Neumes.Clivis,!0)):void 0}},podatusState={neume:function(){return new Neumes.Podatus},handle:function(currNote,prevNote){return currNote.staffPosition>prevNote.staffPosition?prevNote.shape===_Exsurge3.NoteShape.Oriscus?salicusState:scandicusState:currNote.staffPosition<prevNote.staffPosition?currNote.shape===_Exsurge3.NoteShape.Inclinatum?pesSubpunctisState:torculusState:createNeume(new Neumes.Podatus,!1)}},clivisState={neume:function(){return new Neumes.Clivis},handle:function(currNote,prevNote){return currNote.shape===_Exsurge3.NoteShape.Default&&currNote.staffPosition>prevNote.staffPosition?porrectusState:createNeume(new Neumes.Clivis,!1)}},climacusState={neume:function(){return new Neumes.Climacus},handle:function(currNote,prevNote){return currNote.shape!==_Exsurge3.NoteShape.Inclinatum?createNeume(new Neumes.Climacus,!1):state}},porrectusState={neume:function(){return new Neumes.Porrectus},handle:function(currNote,prevNote){return currNote.shape===_Exsurge3.NoteShape.Default&&currNote.staffPosition<prevNote.staffPosition?createNeume(new Neumes.PorrectusFlexus,!0):createNeume(new Neumes.Porrectus,!1)}},pesSubpunctisState={neume:function(){return new Neumes.PesSubpunctis},handle:function(currNote,prevNote){return currNote.shape!==_Exsurge3.NoteShape.Inclinatum?createNeume(new Neumes.PesSubpunctis,!1):state}},salicusState={neume:function(){return new Neumes.Salicus},handle:function(currNote,prevNote){return currNote.staffPosition<prevNote.staffPosition?salicusFlexusState:createNeume(new Neumes.Salicus,!1)}},salicusFlexusState={neume:function(){return new Neumes.SalicusFlexus},handle:function(currNote,prevNote){return createNeume(new Neumes.SalicusFlexus,!1)}},scandicusState={neume:function(){return new Neumes.Scandicus},handle:function(currNote,prevNote){return prevNote.shape===_Exsurge3.NoteShape.Virga&&currNote.shape===_Exsurge3.NoteShape.Inclinatum&&currNote.staffPosition<prevNote.staffPosition?createNeume(new Neumes.Podatus,!1,!1):currNote.shape===_Exsurge3.NoteShape.Default&&currNote.staffPosition<prevNote.staffPosition?scandicusFlexusState:createNeume(new Neumes.Scandicus,!1)}},scandicusFlexusState={neume:function(){return new Neumes.ScandicusFlexus},handle:function(currNote,prevNote){return createNeume(new Neumes.ScandicusFlexus,!1)}},virgaState={neume:function(){return new Neumes.Virga},handle:function(currNote,prevNote){return currNote.shape===_Exsurge3.NoteShape.Inclinatum&&currNote.staffPosition<prevNote.staffPosition?climacusState:currNote.shape===_Exsurge3.NoteShape.Virga&&currNote.staffPosition===prevNote.staffPosition?bivirgaState:createNeume(new Neumes.Virga,!1);
}},bivirgaState={neume:function(){return new Neumes.Bivirga},handle:function(currNote,prevNote){return currNote.shape===_Exsurge3.NoteShape.Virga&&currNote.staffPosition===prevNote.staffPosition?createNeume(new Neumes.Trivirga,!0):createNeume(new Neumes.Bivirga,!1)}},apostrophaState={neume:function(){return new Neumes.Apostropha},handle:function(currNote,prevNote){return currNote.staffPosition===prevNote.staffPosition?distrophaState:createNeume(new Neumes.Apostropha,!1)}},distrophaState={neume:function(){return new Neumes.Distropha},handle:function(currNote,prevNote){return currNote.staffPosition===prevNote.staffPosition?tristrophaState:createNeume(new Neumes.Apostropha,!1,!1)}},tristrophaState={neume:function(){return new Neumes.Tristropha},handle:function(currNote,prevNote){return createNeume(new Neumes.Distropha,!1,!1)}},torculusState={neume:function(){return new Neumes.Torculus},handle:function(currNote,prevNote){return currNote.shape===_Exsurge3.NoteShape.Default&&currNote.staffPosition>prevNote.staffPosition?torculusResupinusState:createNeume(new Neumes.Torculus,!1)}},torculusResupinusState={neume:function(){return new Neumes.TorculusResupinus},handle:function(currNote,prevNote){return currNote.shape===_Exsurge3.NoteShape.Default&&currNote.staffPosition<prevNote.staffPosition?createNeume(new Neumes.TorculusResupinusFlexus,!0):createNeume(new Neumes.TorculusResupinus,!1)}},state=unknownState;currNoteIndex<notes.length;){var prevNote=currNoteIndex>0?notes[currNoteIndex-1]:null,currNote=notes[currNoteIndex];state=state.handle(currNote,prevNote),currNoteIndex===notes.length-1&&state!==unknownState&&createNeume(state.neume(),!0),currNoteIndex++}return neumes.length>0&&finalTrailingSpace>=0&&(neumes[neumes.length-1].trailingSpace=finalTrailingSpace,finalTrailingSpace>ctxt.intraNeumeSpacing?neumes[neumes.length-1].keepWithNext=!1:neumes[neumes.length-1].keepWithNext=!0),neumes}},{key:"createNoteFromData",value:function(ctxt,clef,data,notes){var note=new _Exsurge3.Note;if(data.length<1)throw"Invalid note data: "+data;if("-"===data[0]&&(note.liquescent=_Exsurge3.LiquescentType.InitioDebilis,data=data.substring(1)),data.length<1)throw"Invalid note data: "+data;var pitch=this.gabcHeightToExsurgePitch(clef,data[0]);data[0]===data[0].toUpperCase()&&(note.shape=_Exsurge3.NoteShape.Inclinatum),note.staffPosition=this.gabcHeightToExsurgeHeight(data[0]),note.pitch=pitch;for(var mark,episemaNoteIndex=notes.length,episemaNote=note,i=1;i<data.length;i++){var c=data[i],lookahead="\0",haveLookahead=i+1<data.length;switch(haveLookahead&&(lookahead=data[i+1]),c){case".":if(mark=null,note.morae.length>0&&notes.length){var previousNote=notes.slice(-1)[0],previousMora=note.morae.slice(-1)[0];previousMora.note=previousNote}mark=new Markings.Mora(ctxt,note),haveLookahead&&"1"===lookahead?mark.positionHint=Markings.MarkingPositionHint.Above:haveLookahead&&"0"===lookahead&&(mark.positionHint=Markings.MarkingPositionHint.Below),note.morae.push(mark);break;case"_":var episemaHadModifier=!1;for(mark=new Markings.HorizontalEpisema(episemaNote);haveLookahead;){if("0"===lookahead)mark.positionHint=Markings.MarkingPositionHint.Below;else if("1"===lookahead)mark.positionHint=Markings.MarkingPositionHint.Above;else if("2"===lookahead)mark.terminating=!0;else if("3"===lookahead)mark.alignment=Markings.HorizontalEpisemaAlignment.Left;else if("4"===lookahead)mark.alignment=Markings.HorizontalEpisemaAlignment.Center;else{if("5"!==lookahead)break;mark.alignment=Markings.HorizontalEpisemaAlignment.Right}mark.alignment!==Markings.HorizontalEpisemaAlignment.Default&&mark.positionHint!==Markings.MarkingPositionHint.Below&&(episemaHadModifier=!0),i++,haveLookahead=i+1<data.length,haveLookahead&&(lookahead=data[i+1])}episemaNote&&episemaNote.epismata.push(mark),episemaNote===note&&episemaHadModifier?episemaNote=note:episemaNoteIndex>=0&&notes.length>0&&(episemaNote=notes[--episemaNoteIndex]);break;case"'":mark=new Markings.Ictus(ctxt,note),haveLookahead&&"1"===lookahead?mark.positionHint=Markings.MarkingPositionHint.Above:haveLookahead&&"0"===lookahead&&(mark.positionHint=Markings.MarkingPositionHint.Below),note.ictus=mark;break;case"r":haveLookahead&&"1"===lookahead?(note.acuteAccent=new Markings.AcuteAccent(ctxt,note),i++):note.shapeModifiers|=_Exsurge3.NoteShapeModifiers.Cavum;break;case"s":note.shape===_Exsurge3.NoteShape.Stropha&&(notes.push(note),note=new _Exsurge3.Note,episemaNoteIndex++),note.shape=_Exsurge3.NoteShape.Stropha;break;case"v":note.shape===_Exsurge3.NoteShape.Virga&&(notes.push(note),note=new _Exsurge3.Note,episemaNoteIndex++),note.shape=_Exsurge3.NoteShape.Virga;break;case"w":note.shape=_Exsurge3.NoteShape.Quilisma;break;case"o":note.shape=_Exsurge3.NoteShape.Oriscus,haveLookahead&&"<"===lookahead?(note.shapeModifiers|=_Exsurge3.NoteShapeModifiers.Ascending,i++):haveLookahead&&">"===lookahead&&(note.shapeModifiers|=_Exsurge3.NoteShapeModifiers.Descending,i++);break;case"O":note.shape=_Exsurge3.NoteShape.Oriscus,haveLookahead&&"<"===lookahead?(note.shapeModifiers|=_Exsurge3.NoteShapeModifiers.Ascending|_Exsurge3.NoteShapeModifiers.Stemmed,i++):haveLookahead&&">"===lookahead?(note.shapeModifiers|=_Exsurge3.NoteShapeModifiers.Descending|_Exsurge3.NoteShapeModifiers.Stemmed,i++):note.shapeModifiers|=_Exsurge3.NoteShapeModifiers.Stemmed;break;case"~":note.shape===_Exsurge3.NoteShape.Inclinatum?note.liquescent|=_Exsurge3.LiquescentType.Small:note.shape===_Exsurge3.NoteShape.Oriscus?note.liquescent|=_Exsurge3.LiquescentType.Large:note.liquescent|=_Exsurge3.LiquescentType.Small;break;case"<":note.liquescent|=_Exsurge3.LiquescentType.Ascending;break;case">":note.liquescent|=_Exsurge3.LiquescentType.Descending;break;case"x":note.pitch.step===_Exsurge.Step.Mi?note.pitch.step=_Exsurge.Step.Me:note.pitch.step===_Exsurge.Step.Ti&&(note.pitch.step=_Exsurge.Step.Te);break;case"y":note.pitch.step===_Exsurge.Step.Te?note.pitch.step=_Exsurge.Step.Ti:note.pitch.step===_Exsurge.Step.Me?note.pitch.step=_Exsurge.Step.Mi:note.pitch.step===_Exsurge.Step.Du?note.pitch.step=_Exsurge.Step.Do:note.pitch.step===_Exsurge.Step.Fu&&(note.pitch.step=_Exsurge.Step.Fa);break;case"#":note.pitch.step===_Exsurge.Step.Do?note.pitch.step=_Exsurge.Step.Du:note.pitch.step===_Exsurge.Step.Fa&&(note.pitch.step=_Exsurge.Step.Fu);break;case"[":for(var startIndex=++i;i<data.length&&"]"!==data[i];)i++;this.processInstructionForNote(ctxt,note,data.substring(startIndex,i))}}notes.push(note)}},{key:"processInstructionForNote",value:function(ctxt,note,instruction){var results=instruction.match(__braceSpecRegex);if(null!==results){var above="o"===results[1],shape=Markings.BraceShape.CurlyBrace;switch(results[2]){case"b":shape=Markings.BraceShape.RoundBrace;break;case"cb":shape=Markings.BraceShape.CurlyBrace;break;case"cba":shape=Markings.BraceShape.AccentedCurlyBrace}var attachmentPoint="0"===results[3]?Markings.BraceAttachment.Left:Markings.BraceAttachment.Right;"{"===results[4]?note.braceStart=new Markings.BracePoint(note,above,shape,attachmentPoint):note.braceEnd=new Markings.BracePoint(note,above,shape,attachmentPoint)}}},{key:"splitWords",value:function(gabcNotations){return gabcNotations=gabcNotations.trim().replace(/\s/g," "),gabcNotations.split(/ +(?=[^\)]*(?:\(|$))/g)}},{key:"parseSource",value:function(gabcSource){return this.parseWords(this.splitWords(gabcSource))}},{key:"parseWords",value:function(gabcWords){for(var words=[],i=0;i<gabcWords.length;i++)words.push(this.parseWord(gabcWords[i]));return words}},{key:"parseWord",value:function(gabcWord){for(var syllables=[],matches=[];match=__syllablesRegex.exec(gabcWord);)matches.push(match);for(var j=0;j<matches.length;j++){var match=matches[j],lyrics=match[1].trim().split("|"),notations=match[2];syllables.push({notations:notations,lyrics:lyrics})}return syllables}},{key:"gabcHeightToExsurgeHeight",value:function(gabcHeight){return gabcHeight.toLowerCase().charCodeAt(0)-"a".charCodeAt(0)-6}},{key:"gabcHeightToExsurgePitch",value:function(clef,gabcHeight){var exsurgeHeight=this.gabcHeightToExsurgeHeight(gabcHeight),pitch=clef.staffPositionToPitch(exsurgeHeight);return null!==clef.activeAccidental&&clef.activeAccidental.applyToPitch(pitch),pitch}}]),Gabc}()},function(module,exports,__webpack_require__){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Virga=exports.Tristropha=exports.TorculusResupinusFlexus=exports.TorculusResupinus=exports.Torculus=exports.ScandicusFlexus=exports.Scandicus=exports.SalicusFlexus=exports.Salicus=exports.Punctum=exports.PunctaInclinata=exports.PorrectusFlexus=exports.Porrectus=exports.Podatus=exports.PesSubpunctis=exports.PesQuassus=exports.Oriscus=exports.Distropha=exports.Clivis=exports.Climacus=exports.Trivirga=exports.Bivirga=exports.Apostropha=exports.Neume=void 0;var _get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;if(void 0!==getter)return getter.call(receiver)},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_Exsurge=__webpack_require__(1),_Exsurge2=(_interopRequireWildcard(_Exsurge),__webpack_require__(4)),_Exsurge3=__webpack_require__(6),_ExsurgeChant=__webpack_require__(9),_Exsurge4=__webpack_require__(3),NeumeBuilder=function(){function NeumeBuilder(ctxt,neume){var startingX=arguments.length<=2||void 0===arguments[2]?0:arguments[2];_classCallCheck(this,NeumeBuilder),this.ctxt=ctxt,this.neume=neume,this.x=startingX,this.lastNote=null,this.lineIsHanging=!1}return _createClass(NeumeBuilder,[{key:"lineFrom",value:function(note){return this.lastNote=note,this.lineIsHanging=!0,this}},{key:"noteAt",value:function(note,glyph){var withLineTo=arguments.length<=2||void 0===arguments[2]||arguments[2];if(!note)throw"NeumeBuilder.noteAt: note must be a valid note";if(!glyph)throw"NeumeBuilder.noteAt: glyph must be a valid glyph code";note.setGlyph(this.ctxt,glyph);var noteAlignsRight="right"===note.glyphVisualizer.align,needsLine=withLineTo&&null!==this.lastNote&&(this.lineIsHanging||"right"===this.lastNote.glyphVisualizer.align||Math.abs(this.lastNote.staffPosition-note.staffPosition)>1);if(needsLine){var line=new _Exsurge2.NeumeLineVisualizer(this.ctxt,this.lastNote,note,this.lineIsHanging);this.neume.addVisualizer(line),line.bounds.x=this.x-line.bounds.width,noteAlignsRight||(this.x-=line.bounds.width)}return noteAlignsRight&&this.lastNote?note.bounds.x=this.x-note.bounds.width:(note.bounds.x=this.x,this.x+=note.bounds.width),this.neume.addVisualizer(note),this.lastNote=note,this.lineIsHanging=!1,this}},{key:"virgaAt",value:function(note){arguments.length<=1||void 0===arguments[1]||arguments[1];this.noteAt(note,_Exsurge2.GlyphCode.PunctumQuadratum);var line=new _Exsurge2.VirgaLineVisualizer(this.ctxt,note);return this.x-=line.bounds.width,line.bounds.x=this.x,this.neume.addVisualizer(line),this.lastNote=note,this.lineIsHanging=!1,this}},{key:"advanceBy",value:function(x){return this.lastNote=null,this.lineIsHanging=!1,this.x+=x,this}},{key:"withLineEndingAt",value:function(note){if(null!==this.lastNote){var line=new _Exsurge2.NeumeLineVisualizer(this.ctxt,this.lastNote,note,(!0));return this.neume.addVisualizer(line),this.x-=line.bounds.width,line.bounds.x=this.x,this.neume.addVisualizer(line),this.lastNote=note,this}}},{key:"withPodatus",value:function(lowerNote,upperNote){var upperGlyph,lowerGlyph;return lowerNote.liquescent===_Exsurge3.LiquescentType.InitioDebilis?(upperGlyph=upperNote.liquescent===_Exsurge3.LiquescentType.None?_Exsurge2.GlyphCode.PunctumQuadratum:_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent,lowerGlyph=_Exsurge2.GlyphCode.TerminatingDesLiquescent):upperNote.liquescent&_Exsurge3.LiquescentType.Small?(lowerGlyph=_Exsurge2.GlyphCode.BeginningAscLiquescent,upperGlyph=_Exsurge2.GlyphCode.TerminatingAscLiquescent):upperNote.liquescent&_Exsurge3.LiquescentType.Ascending?(lowerGlyph=_Exsurge2.GlyphCode.PunctumQuadratum,upperGlyph=_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent):upperNote.liquescent&_Exsurge3.LiquescentType.Descending?(lowerGlyph=_Exsurge2.GlyphCode.PunctumQuadratum,upperGlyph=_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent):(lowerGlyph=_Exsurge2.GlyphCode.PodatusLower,upperGlyph=_Exsurge2.GlyphCode.PodatusUpper),lowerNote.shape===_Exsurge3.NoteShape.Quilisma&&(lowerGlyph=_Exsurge2.GlyphCode.Quilisma),this.noteAt(lowerNote,lowerGlyph).noteAt(upperNote,upperGlyph),this.lastNote=null,this}},{key:"withClivis",value:function(upper,lower){var lowerGlyph;return upper.shape===_Exsurge3.NoteShape.Oriscus?this.noteAt(upper,_Exsurge2.GlyphCode.OriscusDes,!1):this.lineFrom(lower).noteAt(upper,_Exsurge2.GlyphCode.PunctumQuadratum),lowerGlyph=lower.liquescent&_Exsurge3.LiquescentType.Small?_Exsurge2.GlyphCode.TerminatingDesLiquescent:lower.liquescent===_Exsurge3.LiquescentType.Ascending?_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent:lower.liquescent===_Exsurge3.LiquescentType.Descending?_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent:_Exsurge2.GlyphCode.PunctumQuadratum,this.noteAt(lower,lowerGlyph),this.lastNote=null,this}},{key:"withInclinati",value:function(notes){for(var staffPosition=notes[0].staffPosition,prevStaffPosition=notes[0].staffPosition,advanceWidth=_Exsurge4.Glyphs.PunctumInclinatum.bounds.width*this.ctxt.glyphScaling,i=0;i<notes.length;i++,prevStaffPosition=staffPosition){var note=notes[i];note.liquescent&_Exsurge3.LiquescentType.Small?note.setGlyph(this.ctxt,_Exsurge2.GlyphCode.PunctumInclinatumLiquescent):note.liquescent&_Exsurge3.LiquescentType.Large?note.setGlyph(this.ctxt,_Exsurge2.GlyphCode.Stropha):note.setGlyph(this.ctxt,_Exsurge2.GlyphCode.PunctumInclinatum),staffPosition=note.staffPosition;var multiple;switch(Math.abs(prevStaffPosition-staffPosition)){case 0:multiple=1.1;break;case 1:multiple=.8;break;default:multiple=1.2}i>0&&(this.x+=advanceWidth*multiple),note.bounds.x=this.x,this.neume.addVisualizer(note)}return this}},{key:"withPorrectusSwash",value:function(start,end){var needsLine=null!==this.lastNote&&(this.lineIsHanging||"right"===this.lastNote.glyphVisualizer.align||Math.abs(this.lastNote.staffPosition-start.staffPosition)>1);if(needsLine){var line=new _Exsurge2.NeumeLineVisualizer(this.ctxt,this.lastNote,start,this.lineIsHanging);this.x-=line.bounds.width,line.bounds.x=this.x,this.neume.addVisualizer(line)}var glyph;switch(start.staffPosition-end.staffPosition){case 1:glyph=_Exsurge2.GlyphCode.Porrectus1;break;case 2:glyph=_Exsurge2.GlyphCode.Porrectus2;break;case 3:glyph=_Exsurge2.GlyphCode.Porrectus3;break;case 4:glyph=_Exsurge2.GlyphCode.Porrectus4;break;default:glyph=_Exsurge2.GlyphCode.None}return start.setGlyph(this.ctxt,glyph),start.bounds.x=this.x,end.setGlyph(this.ctxt,_Exsurge2.GlyphCode.None),this.x=start.bounds.right(),end.bounds.x=this.x-end.bounds.width,this.neume.addVisualizer(start),this.neume.addVisualizer(end),this.lastNote=end,this.lineIsHanging=!1,this}}]),NeumeBuilder}(),Neume=exports.Neume=function(_ChantNotationElement){function Neume(){var notes=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];_classCallCheck(this,Neume);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(Neume).call(this));_this.isNeume=!0,_this.notes=notes;for(var i=0;i<notes.length;i++)notes[i].neume=_this;return _this}return _inherits(Neume,_ChantNotationElement),_createClass(Neume,[{key:"addNote",value:function(note){note.neume=this,this.notes.push(note)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Neume.prototype),"performLayout",this).call(this,ctxt)}},{key:"finishLayout",value:function(ctxt){this.positionMarkings();for(var i=0;i<this.notes.length;i++){var j,note=this.notes[i];for(j=0;j<note.epismata.length;j++)note.epismata[j].performLayout(ctxt),this.addVisualizer(note.epismata[j]);for(j=0;j<note.morae.length;j++)note.morae[j].performLayout(ctxt),this.addVisualizer(note.morae[j]);note.ictus&&(note.ictus.performLayout(ctxt),this.addVisualizer(note.ictus)),note.acuteAccent&&(note.acuteAccent.performLayout(ctxt),this.addVisualizer(note.acuteAccent))}this.origin.x=this.notes[0].origin.x,this.origin.y=this.notes[0].origin.y,_get(Object.getPrototypeOf(Neume.prototype),"finishLayout",this).call(this,ctxt)}},{key:"resetDependencies",value:function(){}},{key:"build",value:function(ctxt){return new NeumeBuilder(ctxt,this)}},{key:"positionMarkings",value:function(){}}]),Neume}(_Exsurge2.ChantNotationElement),Apostropha=exports.Apostropha=function(_Neume){function Apostropha(){return _classCallCheck(this,Apostropha),_possibleConstructorReturn(this,Object.getPrototypeOf(Apostropha).apply(this,arguments))}return _inherits(Apostropha,_Neume),_createClass(Apostropha,[{key:"positionMarkings",value:function(){for(var positionHint=_ExsurgeChant.MarkingPositionHint.Above,i=0;i<this.notes[0].epismata.length;i++)this.notes[0].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default?this.notes[0].epismata[i].positionHint=positionHint:positionHint=this.notes[0].epismata[i].positionHint,positionHint=positionHint===_ExsurgeChant.MarkingPositionHint.Above?_ExsurgeChant.MarkingPositionHint.Below:_ExsurgeChant.MarkingPositionHint.Above}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Apostropha.prototype),"performLayout",this).call(this,ctxt);ctxt.calculateHeightFromStaffPosition(4);this.build(ctxt).noteAt(this.notes[0],Apostropha.getNoteGlyphCode(this.notes[0])),this.finishLayout(ctxt)}}],[{key:"getNoteGlyphCode",value:function(note){return note.shape===_Exsurge3.NoteShape.Stropha?_Exsurge2.GlyphCode.Stropha:note.liquescent!==_Exsurge3.LiquescentType.None?_Exsurge2.GlyphCode.StrophaLiquescent:note.shapeModifiers&_Exsurge3.NoteShapeModifiers.Cavum?_Exsurge2.GlyphCode.PunctumCavum:_Exsurge2.GlyphCode.PunctumQuadratum}}]),Apostropha}(Neume);exports.Bivirga=function(_Neume2){function Bivirga(){return _classCallCheck(this,Bivirga),_possibleConstructorReturn(this,Object.getPrototypeOf(Bivirga).apply(this,arguments))}return _inherits(Bivirga,_Neume2),_createClass(Bivirga,[{key:"positionMarkings",value:function(){var i,j;for(i=0;i<this.notes.length;i++){var positionHint=_ExsurgeChant.MarkingPositionHint.Above;for(j=0;j<this.notes[i].epismata.length;j++)this.notes[i].epismata[j].positionHint===_ExsurgeChant.MarkingPositionHint.Default?this.notes[i].epismata[j].positionHint=positionHint:positionHint=this.notes[i].epismata[j].positionHint,positionHint=positionHint===_ExsurgeChant.MarkingPositionHint.Above?_ExsurgeChant.MarkingPositionHint.Below:_ExsurgeChant.MarkingPositionHint.Above}}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Bivirga.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).virgaAt(this.notes[0]).advanceBy(ctxt.intraNeumeSpacing).virgaAt(this.notes[1]),this.finishLayout(ctxt)}}]),Bivirga}(Neume),exports.Trivirga=function(_Neume3){function Trivirga(){return _classCallCheck(this,Trivirga),_possibleConstructorReturn(this,Object.getPrototypeOf(Trivirga).apply(this,arguments))}return _inherits(Trivirga,_Neume3),_createClass(Trivirga,[{key:"positionMarkings",value:function(){var i,j;for(i=0;i<this.notes.length;i++){var positionHint=_ExsurgeChant.MarkingPositionHint.Above;for(j=0;j<this.notes[i].epismata.length;j++)this.notes[i].epismata[j].positionHint===_ExsurgeChant.MarkingPositionHint.Default?this.notes[i].epismata[j].positionHint=positionHint:positionHint=this.notes[i].epismata[j].positionHint,positionHint=positionHint===_ExsurgeChant.MarkingPositionHint.Above?_ExsurgeChant.MarkingPositionHint.Below:_ExsurgeChant.MarkingPositionHint.Above}}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Trivirga.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).virgaAt(this.notes[0]).advanceBy(ctxt.intraNeumeSpacing).virgaAt(this.notes[1]).advanceBy(ctxt.intraNeumeSpacing).virgaAt(this.notes[2]),this.finishLayout(ctxt)}}]),Trivirga}(Neume),exports.Climacus=function(_Neume4){function Climacus(){return _classCallCheck(this,Climacus),_possibleConstructorReturn(this,Object.getPrototypeOf(Climacus).apply(this,arguments))}return _inherits(Climacus,_Neume4),_createClass(Climacus,[{key:"positionMarkings",value:function(){for(var i=0;i<this.notes.length;i++)for(var j=0;j<this.notes[i].epismata.length;j++){var mark=this.notes[i].epismata[j];mark.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(mark.positionHint=_ExsurgeChant.MarkingPositionHint.Above)}}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Climacus.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).virgaAt(this.notes[0]).advanceBy(ctxt.intraNeumeSpacing/2).withInclinati(this.notes.slice(1)),this.finishLayout(ctxt)}}]),Climacus}(Neume),exports.Clivis=function(_Neume5){function Clivis(){return _classCallCheck(this,Clivis),_possibleConstructorReturn(this,Object.getPrototypeOf(Clivis).apply(this,arguments))}return _inherits(Clivis,_Neume5),_createClass(Clivis,[{key:"positionMarkings",value:function(){var mark,i;if(this.notes[1].morae.length){var morae=this.notes[1].morae;morae[0].horizontalOffset+=this.notes[1].bounds.right()-this.notes[0].bounds.right(),this.notes[0].staffPosition-this.notes[1].staffPosition===1&&1===Math.abs(this.notes[1].staffPosition%2)&&(morae.slice(-1)[0].positionHint=_ExsurgeChant.MarkingPositionHint.Below)}for(i=0;i<this.notes[0].epismata.length;i++)mark=this.notes[0].epismata[i],mark.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(mark.positionHint=_ExsurgeChant.MarkingPositionHint.Above);for(i=0;i<this.notes[1].epismata.length;i++)mark=this.notes[1].epismata[i],mark.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(mark.positionHint=_ExsurgeChant.MarkingPositionHint.Above)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Clivis.prototype),"performLayout",this).call(this,ctxt);var upper=this.notes[0],lower=this.notes[1];this.build(ctxt).withClivis(upper,lower),this.finishLayout(ctxt)}}]),Clivis}(Neume),exports.Distropha=function(_Neume6){function Distropha(){return _classCallCheck(this,Distropha),_possibleConstructorReturn(this,Object.getPrototypeOf(Distropha).apply(this,arguments))}return _inherits(Distropha,_Neume6),_createClass(Distropha,[{key:"positionMarkings",value:function(){for(var i=0;i<this.notes.length;i++)for(var positionHint=_ExsurgeChant.MarkingPositionHint.Above,j=0;j<this.notes[i].epismata.length;j++)this.notes[i].epismata[j].positionHint===_ExsurgeChant.MarkingPositionHint.Default?this.notes[i].epismata[j].positionHint=positionHint:positionHint=this.notes[i].epismata[j].positionHint,positionHint=positionHint===_ExsurgeChant.MarkingPositionHint.Above?_ExsurgeChant.MarkingPositionHint.Below:_ExsurgeChant.MarkingPositionHint.Above}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Distropha.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).noteAt(this.notes[0],Apostropha.getNoteGlyphCode(this.notes[0])).advanceBy(ctxt.intraNeumeSpacing).noteAt(this.notes[1],Apostropha.getNoteGlyphCode(this.notes[1])),this.finishLayout(ctxt)}}]),Distropha}(Neume),exports.Oriscus=function(_Neume7){function Oriscus(){return _classCallCheck(this,Oriscus),_possibleConstructorReturn(this,Object.getPrototypeOf(Oriscus).apply(this,arguments))}return _inherits(Oriscus,_Neume7),_createClass(Oriscus,[{key:"positionMarkings",value:function(){for(var positionHint=_ExsurgeChant.MarkingPositionHint.Above,i=0;i<this.notes[0].epismata.length;i++)this.notes[0].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default?this.notes[0].epismata[i].positionHint=positionHint:positionHint=this.notes[0].epismata[i].positionHint,positionHint=positionHint===_ExsurgeChant.MarkingPositionHint.Above?_ExsurgeChant.MarkingPositionHint.Below:_ExsurgeChant.MarkingPositionHint.Above}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Oriscus.prototype),"performLayout",this).call(this,ctxt);var glyph,note=this.notes[0];if(note.liquescent!==_Exsurge3.LiquescentType.None)glyph=_Exsurge2.GlyphCode.OriscusLiquescent;else if(note.shapeModifiers&_Exsurge3.NoteShapeModifiers.Ascending)glyph=_Exsurge2.GlyphCode.OriscusAsc;else if(note.shapeModifiers&_Exsurge3.NoteShapeModifiers.Descending)glyph=_Exsurge2.GlyphCode.OriscusDes;else{glyph=_Exsurge2.GlyphCode.OriscusDes;var neume=ctxt.findNextNeume();if(neume){var nextNoteStaffPosition=ctxt.activeClef.pitchToStaffPosition(neume.notes[0].pitch);nextNoteStaffPosition>note.staffPosition&&(glyph=_Exsurge2.GlyphCode.OriscusAsc)}}this.build(ctxt).noteAt(note,glyph),this.finishLayout(ctxt)}},{key:"resetDependencies",value:function(){this.notes[0].shapeModifiers&_Exsurge3.NoteShapeModifiers.Ascending||this.notes[0].shapeModifiers&_Exsurge3.NoteShapeModifiers.Descending||(this.needsLayout=!0)}}]),Oriscus}(Neume),exports.PesQuassus=function(_Neume8){function PesQuassus(){return _classCallCheck(this,PesQuassus),_possibleConstructorReturn(this,Object.getPrototypeOf(PesQuassus).apply(this,arguments))}return _inherits(PesQuassus,_Neume8),_createClass(PesQuassus,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(PesQuassus.prototype),"performLayout",this).call(this,ctxt);var lowerGlyph,lower=this.notes[0],upper=this.notes[1],lowerStaffPos=lower.staffPosition,upperStaffPos=upper.staffPosition;lowerGlyph=lower.shape===_Exsurge3.NoteShape.Oriscus?_Exsurge2.GlyphCode.OriscusAsc:_Exsurge2.GlyphCode.PunctumQuadratum;var builder=this.build(ctxt).noteAt(lower,lowerGlyph);upperStaffPos-lowerStaffPos===1?builder.virgaAt(upper):upper.liquescent===_Exsurge3.LiquescentType.LargeDescending?builder.noteAt(upper,_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent).withLineEndingAt(lower):builder.noteAt(upper,_Exsurge2.GlyphCode.PunctumQuadratum).withLineEndingAt(lower),this.finishLayout(ctxt)}}]),PesQuassus}(Neume),exports.PesSubpunctis=function(_Neume9){function PesSubpunctis(){return _classCallCheck(this,PesSubpunctis),_possibleConstructorReturn(this,Object.getPrototypeOf(PesSubpunctis).apply(this,arguments))}return _inherits(PesSubpunctis,_Neume9),_createClass(PesSubpunctis,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(PesSubpunctis.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).withPodatus(this.notes[0],this.notes[1]).advanceBy(ctxt.intraNeumeSpacing/2).withInclinati(this.notes.slice(2)),this.finishLayout(ctxt)}}]),PesSubpunctis}(Neume),exports.Podatus=function(_Neume10){function Podatus(){return _classCallCheck(this,Podatus),_possibleConstructorReturn(this,Object.getPrototypeOf(Podatus).apply(this,arguments))}return _inherits(Podatus,_Neume10),_createClass(Podatus,[{key:"positionMarkings",value:function(){var marking,i;for(i=0;i<this.notes[0].epismata.length;i++)this.notes[0].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[0].epismata[i].positionHint=_ExsurgeChant.MarkingPositionHint.Below);for(this.notes[1].staffPosition-this.notes[0].staffPosition===1&&1===Math.abs(this.notes[0].staffPosition%2)&&(1===this.notes[0].morae.length?marking=this.notes[0].morae[0]:this.notes[1].morae.length>1&&(marking=this.notes[1].morae[0]),marking&&(marking.positionHint=_ExsurgeChant.MarkingPositionHint.Below)),i=0;i<this.notes[1].epismata.length;i++)this.notes[1].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[1].epismata[i].positionHint=_ExsurgeChant.MarkingPositionHint.Above)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Podatus.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).withPodatus(this.notes[0],this.notes[1]),this.finishLayout(ctxt)}}]),Podatus}(Neume),exports.Porrectus=function(_Neume11){function Porrectus(){return _classCallCheck(this,Porrectus),_possibleConstructorReturn(this,Object.getPrototypeOf(Porrectus).apply(this,arguments))}return _inherits(Porrectus,_Neume11),_createClass(Porrectus,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Porrectus.prototype),"performLayout",this).call(this,ctxt);var thirdGlyph,first=this.notes[0],second=this.notes[1],third=this.notes[2];thirdGlyph=third.liquescent&_Exsurge3.LiquescentType.Small?_Exsurge2.GlyphCode.TerminatingAscLiquescent:third.liquescent&_Exsurge3.LiquescentType.Descending?_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent:_Exsurge2.GlyphCode.PodatusUpper,this.build(ctxt).lineFrom(second).withPorrectusSwash(first,second).noteAt(third,thirdGlyph),this.finishLayout(ctxt)}}]),Porrectus}(Neume),exports.PorrectusFlexus=function(_Neume12){function PorrectusFlexus(){return _classCallCheck(this,PorrectusFlexus),_possibleConstructorReturn(this,Object.getPrototypeOf(PorrectusFlexus).apply(this,arguments))}return _inherits(PorrectusFlexus,_Neume12),_createClass(PorrectusFlexus,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(PorrectusFlexus.prototype),"performLayout",this).call(this,ctxt);var fourthGlyph,first=this.notes[0],second=this.notes[1],third=this.notes[2],fourth=this.notes[3],thirdGlyph=_Exsurge2.GlyphCode.PunctumQuadratum;fourth.liquescent&_Exsurge3.LiquescentType.Small?(thirdGlyph=_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent,fourthGlyph=_Exsurge2.GlyphCode.TerminatingDesLiquescent):fourthGlyph=fourth.liquescent&_Exsurge3.LiquescentType.Ascending?_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent:fourth.liquescent&_Exsurge3.LiquescentType.Descending?_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent:_Exsurge2.GlyphCode.PunctumQuadratum,this.build(ctxt).lineFrom(second).withPorrectusSwash(first,second).noteAt(third,thirdGlyph).noteAt(fourth,fourthGlyph),this.finishLayout(ctxt)}}]),PorrectusFlexus}(Neume),exports.PunctaInclinata=function(_Neume13){function PunctaInclinata(){return _classCallCheck(this,PunctaInclinata),_possibleConstructorReturn(this,Object.getPrototypeOf(PunctaInclinata).apply(this,arguments))}return _inherits(PunctaInclinata,_Neume13),_createClass(PunctaInclinata,[{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(PunctaInclinata.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).withInclinati(this.notes),this.finishLayout(ctxt)}}]),PunctaInclinata}(Neume),exports.Punctum=function(_Neume14){function Punctum(){return _classCallCheck(this,Punctum),_possibleConstructorReturn(this,Object.getPrototypeOf(Punctum).apply(this,arguments))}return _inherits(Punctum,_Neume14),_createClass(Punctum,[{key:"positionMarkings",value:function(){var i,positionHint=_ExsurgeChant.MarkingPositionHint.Above;
for(i=0;i<this.notes[0].epismata.length;i++)this.notes[0].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default?this.notes[0].epismata[i].positionHint=positionHint:positionHint=this.notes[0].epismata[i].positionHint,positionHint=positionHint===_ExsurgeChant.MarkingPositionHint.Above?_ExsurgeChant.MarkingPositionHint.Below:_ExsurgeChant.MarkingPositionHint.Above}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Punctum.prototype),"performLayout",this).call(this,ctxt);var note=this.notes[0],glyph=_Exsurge2.GlyphCode.PunctumQuadratum;note.liquescent!==_Exsurge3.LiquescentType.None?note.shape===_Exsurge3.NoteShape.Inclinatum?glyph=_Exsurge2.GlyphCode.PunctumInclinatumLiquescent:note.shape===_Exsurge3.NoteShape.Oriscus?glyph=_Exsurge2.GlyphCode.OriscusLiquescent:note.liquescent&_Exsurge3.LiquescentType.Ascending?glyph=_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent:note.liquescent&_Exsurge3.LiquescentType.Descending&&(glyph=_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent):glyph=note.shapeModifiers&_Exsurge3.NoteShapeModifiers.Cavum?_Exsurge2.GlyphCode.PunctumCavum:note.shape===_Exsurge3.NoteShape.Inclinatum?_Exsurge2.GlyphCode.PunctumInclinatum:note.shape===_Exsurge3.NoteShape.Quilisma?_Exsurge2.GlyphCode.Quilisma:_Exsurge2.GlyphCode.PunctumQuadratum,this.build(ctxt).noteAt(note,glyph),this.finishLayout(ctxt)}}]),Punctum}(Neume),exports.Salicus=function(_Neume15){function Salicus(){return _classCallCheck(this,Salicus),_possibleConstructorReturn(this,Object.getPrototypeOf(Salicus).apply(this,arguments))}return _inherits(Salicus,_Neume15),_createClass(Salicus,[{key:"positionMarkings",value:function(){var i,j;for(i=0;i<this.notes.length;i++)for(j=0;j<this.notes[i].epismata.length;j++)this.notes[i].epismata[j].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[i].epismata[j].positionHint=_ExsurgeChant.MarkingPositionHint.Below)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Salicus.prototype),"performLayout",this).call(this,ctxt);var first=this.notes[0],second=this.notes[1],third=this.notes[2],builder=this.build(ctxt).noteAt(first,_Exsurge2.GlyphCode.PunctumQuadratum);second.shapeModifiers&_Exsurge3.NoteShapeModifiers.Stemmed||builder.advanceBy(ctxt.intraNeumeSpacing),builder.noteAt(second,_Exsurge2.GlyphCode.OriscusAsc),third.liquescent&_Exsurge3.LiquescentType.Small?builder.noteAt(third,_Exsurge2.GlyphCode.TerminatingAscLiquescent):third.liquescent===_Exsurge3.LiquescentType.Ascending?builder.noteAt(third,_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent):third.liquescent===_Exsurge3.LiquescentType.Descending?builder.noteAt(third,_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent):builder.virgaAt(third),this.finishLayout(ctxt)}}]),Salicus}(Neume),exports.SalicusFlexus=function(_Neume16){function SalicusFlexus(){return _classCallCheck(this,SalicusFlexus),_possibleConstructorReturn(this,Object.getPrototypeOf(SalicusFlexus).apply(this,arguments))}return _inherits(SalicusFlexus,_Neume16),_createClass(SalicusFlexus,[{key:"positionMarkings",value:function(){var i,j;for(i=0;i<this.notes.length;i++)for(j=0;j<this.notes[i].epismata.length;j++)this.notes[i].epismata[j].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[i].epismata[j].positionHint=_ExsurgeChant.MarkingPositionHint.Below)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(SalicusFlexus.prototype),"performLayout",this).call(this,ctxt);var first=this.notes[0],second=this.notes[1],third=this.notes[2],fourth=this.notes[3],builder=this.build(ctxt).noteAt(first,_Exsurge2.GlyphCode.PunctumQuadratum);second.shapeModifiers&_Exsurge3.NoteShapeModifiers.Stemmed||builder.advanceBy(ctxt.intraNeumeSpacing),builder.noteAt(second,_Exsurge2.GlyphCode.OriscusAsc),fourth.liquescent&_Exsurge3.LiquescentType.Small?builder.noteAt(third,_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent):builder.noteAt(third,_Exsurge2.GlyphCode.PunctumQuadratum),fourth.liquescent&_Exsurge3.LiquescentType.Small?builder.noteAt(fourth,_Exsurge2.GlyphCode.TerminatingDesLiquescent):fourth.liquescent&_Exsurge3.LiquescentType.Ascending?builder.noteAt(fourth,_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent):fourth.liquescent&_Exsurge3.LiquescentType.Descending?builder.noteAt(fourth,_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent):builder.noteAt(fourth,_Exsurge2.GlyphCode.PunctumQuadratum),this.finishLayout(ctxt)}}]),SalicusFlexus}(Neume),exports.Scandicus=function(_Neume17){function Scandicus(){return _classCallCheck(this,Scandicus),_possibleConstructorReturn(this,Object.getPrototypeOf(Scandicus).apply(this,arguments))}return _inherits(Scandicus,_Neume17),_createClass(Scandicus,[{key:"positionMarkings",value:function(){var i;for(i=0;i<this.notes[0].epismata.length;i++)this.notes[0].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[0].epismata[i].positionHint=_ExsurgeChant.MarkingPositionHint.Below);var positionHint=this.notes[2].shape===_Exsurge3.NoteShape.Virga?_ExsurgeChant.MarkingPositionHint.Above:_ExsurgeChant.MarkingPositionHint.Below;for(i=0;i<this.notes[1].epismata.length;i++)this.notes[1].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[1].epismata[i].positionHint=positionHint);for(i=0;i<this.notes[2].epismata.length;i++)this.notes[2].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[2].epismata[i].positionHint=_ExsurgeChant.MarkingPositionHint.Above)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Scandicus.prototype),"performLayout",this).call(this,ctxt);var first=this.notes[0],second=this.notes[1],third=this.notes[2];third.shape===_Exsurge3.NoteShape.Virga?this.build(ctxt).withPodatus(first,second).virgaAt(third):this.build(ctxt).noteAt(first,_Exsurge2.GlyphCode.PunctumQuadratum).withPodatus(second,third),this.finishLayout(ctxt)}}]),Scandicus}(Neume),exports.ScandicusFlexus=function(_Neume18){function ScandicusFlexus(){return _classCallCheck(this,ScandicusFlexus),_possibleConstructorReturn(this,Object.getPrototypeOf(ScandicusFlexus).apply(this,arguments))}return _inherits(ScandicusFlexus,_Neume18),_createClass(ScandicusFlexus,[{key:"positionMarkings",value:function(){var i;for(i=0;i<this.notes[0].epismata.length;i++)this.notes[0].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[0].epismata[i].positionHint=_ExsurgeChant.MarkingPositionHint.Below);var positionHint=this.notes[2].shape===_Exsurge3.NoteShape.Virga?_ExsurgeChant.MarkingPositionHint.Above:_ExsurgeChant.MarkingPositionHint.Below;for(i=0;i<this.notes[1].epismata.length;i++)this.notes[1].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[1].epismata[i].positionHint=positionHint);for(i=0;i<this.notes[2].epismata.length;i++)this.notes[2].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[2].epismata[i].positionHint=_ExsurgeChant.MarkingPositionHint.Above);for(i=0;i<this.notes[3].epismata.length;i++)this.notes[3].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(this.notes[3].epismata[i].positionHint=_ExsurgeChant.MarkingPositionHint.Above)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(ScandicusFlexus.prototype),"performLayout",this).call(this,ctxt);var first=this.notes[0],second=this.notes[1],third=this.notes[2],fourth=this.notes[3];if(third.shape===_Exsurge3.NoteShape.Virga)this.build(ctxt).withPodatus(first,second).advanceBy(ctxt.intraNeumeSpacing).withClivis(third,fourth);else{var fourthGlyph=_Exsurge2.GlyphCode.PunctumQuadratum;fourth.liquescent&_Exsurge3.LiquescentType.Ascending?fourthGlyph=_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent:fourth.liquescent&_Exsurge3.LiquescentType.Descending&&(fourthGlyph=_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent),this.build(ctxt).noteAt(first,_Exsurge2.GlyphCode.PunctumQuadratum).withPodatus(second,third).advanceBy(ctxt.intraNeumeSpacing).noteAt(fourth,fourthGlyph)}this.finishLayout(ctxt)}}]),ScandicusFlexus}(Neume),exports.Torculus=function(_Neume19){function Torculus(){return _classCallCheck(this,Torculus),_possibleConstructorReturn(this,Object.getPrototypeOf(Torculus).apply(this,arguments))}return _inherits(Torculus,_Neume19),_createClass(Torculus,[{key:"positionMarkings",value:function(){var marking,i,hasMiddleEpisema=!1;for(i=0;i<this.notes[1].epismata.length;i++)marking=this.notes[1].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=_ExsurgeChant.MarkingPositionHint.Above,hasMiddleEpisema=!0);for(i=0;i<this.notes[0].epismata.length;i++)marking=this.notes[0].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=hasMiddleEpisema?_ExsurgeChant.MarkingPositionHint.Above:_ExsurgeChant.MarkingPositionHint.Below);for(i=0;i<this.notes[2].epismata.length;i++)marking=this.notes[2].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=hasMiddleEpisema?_ExsurgeChant.MarkingPositionHint.Above:_ExsurgeChant.MarkingPositionHint.Below)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Torculus.prototype),"performLayout",this).call(this,ctxt);var glyph1,glyph3,note1=this.notes[0],note2=this.notes[1],note3=this.notes[2];glyph1=note1.liquescent===_Exsurge3.LiquescentType.InitioDebilis?_Exsurge2.GlyphCode.TerminatingDesLiquescent:_Exsurge2.GlyphCode.PunctumQuadratum,glyph3=note3.liquescent&_Exsurge3.LiquescentType.Small?_Exsurge2.GlyphCode.TerminatingDesLiquescent:note3.liquescent&_Exsurge3.LiquescentType.Ascending?_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent:note3.liquescent&_Exsurge3.LiquescentType.Descending?_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent:_Exsurge2.GlyphCode.PunctumQuadratum,this.build(ctxt).noteAt(note1,glyph1).noteAt(note2,_Exsurge2.GlyphCode.PunctumQuadratum).noteAt(note3,glyph3),this.finishLayout(ctxt)}}]),Torculus}(Neume),exports.TorculusResupinus=function(_Neume20){function TorculusResupinus(){return _classCallCheck(this,TorculusResupinus),_possibleConstructorReturn(this,Object.getPrototypeOf(TorculusResupinus).apply(this,arguments))}return _inherits(TorculusResupinus,_Neume20),_createClass(TorculusResupinus,[{key:"positionMarkings",value:function(){var marking,i,hasMiddleEpisema=!1;for(i=0;i<this.notes[1].epismata.length;i++)marking=this.notes[1].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=_ExsurgeChant.MarkingPositionHint.Above,hasMiddleEpisema=!0);for(i=0;i<this.notes[0].epismata.length;i++)marking=this.notes[0].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=hasMiddleEpisema?_ExsurgeChant.MarkingPositionHint.Above:_ExsurgeChant.MarkingPositionHint.Below);for(i=0;i<this.notes[2].epismata.length;i++)marking=this.notes[2].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=hasMiddleEpisema?_ExsurgeChant.MarkingPositionHint.Above:_ExsurgeChant.MarkingPositionHint.Below);for(i=0;i<this.notes[3].epismata.length;i++)marking=this.notes[3].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=_ExsurgeChant.MarkingPositionHint.Above)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(TorculusResupinus.prototype),"performLayout",this).call(this,ctxt);var firstGlyph,fourthGlyph,first=this.notes[0],second=this.notes[1],third=this.notes[2],fourth=this.notes[3];firstGlyph=first.liquescent===_Exsurge3.LiquescentType.InitioDebilis?_Exsurge2.GlyphCode.TerminatingDesLiquescent:first.shape===_Exsurge3.NoteShape.Quilisma?_Exsurge2.GlyphCode.Quilisma:_Exsurge2.GlyphCode.PunctumQuadratum,fourthGlyph=fourth.liquescent&_Exsurge3.LiquescentType.Small?_Exsurge2.GlyphCode.TerminatingAscLiquescent:third.liquescent&_Exsurge3.LiquescentType.Descending?_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent:_Exsurge2.GlyphCode.PodatusUpper,this.build(ctxt).noteAt(first,firstGlyph).withPorrectusSwash(second,third).noteAt(fourth,fourthGlyph),this.finishLayout(ctxt)}}]),TorculusResupinus}(Neume),exports.TorculusResupinusFlexus=function(_Neume21){function TorculusResupinusFlexus(){return _classCallCheck(this,TorculusResupinusFlexus),_possibleConstructorReturn(this,Object.getPrototypeOf(TorculusResupinusFlexus).apply(this,arguments))}return _inherits(TorculusResupinusFlexus,_Neume21),_createClass(TorculusResupinusFlexus,[{key:"positionMarkings",value:function(){var marking,i,hasMiddleEpisema=!1;for(i=0;i<this.notes[1].epismata.length;i++)marking=this.notes[1].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=_ExsurgeChant.MarkingPositionHint.Above,hasMiddleEpisema=!0);for(i=0;i<this.notes[0].epismata.length;i++)marking=this.notes[0].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=hasMiddleEpisema?_ExsurgeChant.MarkingPositionHint.Above:_ExsurgeChant.MarkingPositionHint.Below);for(i=0;i<this.notes[2].epismata.length;i++)marking=this.notes[2].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=hasMiddleEpisema?_ExsurgeChant.MarkingPositionHint.Above:_ExsurgeChant.MarkingPositionHint.Below);for(i=0;i<this.notes[3].epismata.length;i++)marking=this.notes[3].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=_ExsurgeChant.MarkingPositionHint.Above);for(i=0;i<this.notes[4].epismata.length;i++)marking=this.notes[4].epismata[i],marking.positionHint===_ExsurgeChant.MarkingPositionHint.Default&&(marking.positionHint=_ExsurgeChant.MarkingPositionHint.Above)}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(TorculusResupinusFlexus.prototype),"performLayout",this).call(this,ctxt);var firstGlyph,fifthGlyph,first=this.notes[0],second=this.notes[1],third=this.notes[2],fourth=this.notes[3],fifth=this.notes[4],fourthGlyph=_Exsurge2.GlyphCode.PunctumQuadratum;firstGlyph=first.liquescent===_Exsurge3.LiquescentType.InitioDebilis?_Exsurge2.GlyphCode.TerminatingDesLiquescent:first.shape===_Exsurge3.NoteShape.Quilisma?_Exsurge2.GlyphCode.Quilisma:_Exsurge2.GlyphCode.PunctumQuadratum,fifth.liquescent&_Exsurge3.LiquescentType.Small?(fourthGlyph=_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent,fifthGlyph=_Exsurge2.GlyphCode.TerminatingDesLiquescent):fifthGlyph=fifth.liquescent&_Exsurge3.LiquescentType.Ascending?_Exsurge2.GlyphCode.PunctumQuadratumAscLiquescent:fifth.liquescent&_Exsurge3.LiquescentType.Descending?_Exsurge2.GlyphCode.PunctumQuadratumDesLiquescent:_Exsurge2.GlyphCode.PunctumQuadratum,this.build(ctxt).noteAt(first,firstGlyph).withPorrectusSwash(second,third).noteAt(fourth,fourthGlyph).noteAt(fifth,fifthGlyph),this.finishLayout(ctxt)}}]),TorculusResupinusFlexus}(Neume),exports.Tristropha=function(_Neume22){function Tristropha(){return _classCallCheck(this,Tristropha),_possibleConstructorReturn(this,Object.getPrototypeOf(Tristropha).apply(this,arguments))}return _inherits(Tristropha,_Neume22),_createClass(Tristropha,[{key:"positionMarkings",value:function(){var i,j;for(i=0;i<this.notes.length;i++){var positionHint=_ExsurgeChant.MarkingPositionHint.Above;for(j=0;j<this.notes[i].epismata.length;j++)this.notes[i].epismata[j].positionHint===_ExsurgeChant.MarkingPositionHint.Default?this.notes[i].epismata[j].positionHint=positionHint:positionHint=this.notes[i].epismata[j].positionHint,positionHint=positionHint===_ExsurgeChant.MarkingPositionHint.Above?_ExsurgeChant.MarkingPositionHint.Below:_ExsurgeChant.MarkingPositionHint.Above}}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Tristropha.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).noteAt(this.notes[0],Apostropha.getNoteGlyphCode(this.notes[0])).advanceBy(ctxt.intraNeumeSpacing).noteAt(this.notes[1],Apostropha.getNoteGlyphCode(this.notes[1])).advanceBy(ctxt.intraNeumeSpacing).noteAt(this.notes[2],Apostropha.getNoteGlyphCode(this.notes[2])),this.finishLayout(ctxt)}}]),Tristropha}(Neume),exports.Virga=function(_Neume23){function Virga(){return _classCallCheck(this,Virga),_possibleConstructorReturn(this,Object.getPrototypeOf(Virga).apply(this,arguments))}return _inherits(Virga,_Neume23),_createClass(Virga,[{key:"positionMarkings",value:function(){for(var positionHint=_ExsurgeChant.MarkingPositionHint.Above,i=0;i<this.notes[0].epismata.length;i++)this.notes[0].epismata[i].positionHint===_ExsurgeChant.MarkingPositionHint.Default?this.notes[0].epismata[i].positionHint=positionHint:positionHint=this.notes[0].epismata[i].positionHint,positionHint=positionHint===_ExsurgeChant.MarkingPositionHint.Above?_ExsurgeChant.MarkingPositionHint.Below:_ExsurgeChant.MarkingPositionHint.Above}},{key:"performLayout",value:function(ctxt){_get(Object.getPrototypeOf(Virga.prototype),"performLayout",this).call(this,ctxt),this.build(ctxt).virgaAt(this.notes[0]),this.finishLayout(ctxt)}}]),Virga}(Neume)}])});